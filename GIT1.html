        // ... (previous Firebase and user management code continues above)

        // Rest of your existing application functions - ALL PRESERVED EXACTLY AS THEY WERE:
        function initializeNavigation() {
            navItems.forEach((item, index) => {
                item.addEventListener('click', () => {
                    navItems.forEach(nav => nav.classList.remove('active'));
                    item.classList.add('active');
                    
                    // Update online tracker with current page
                    if (currentUser) {
                        currentPage = getPageName(index);
                        onlineTracker.updateUserActivity();
                    }
                    
                    switch(index) {
                        case 0: // Dashboard
                            currentPage = 'Dashboard';
                            showDashboard();
                            break;
                        case 1: // My Courses
                            currentPage = 'courses';
                            showCourses();
                            break;
                        case 2: // Progress Analytics
                            currentPage = 'analytics';
                            showAnalytics();
                            break;
                        case 3: // Bookmarked Questions
                            currentPage = 'bookmarks';
                            showBookmarks();
                            break;
                        case 4: // Online Users (Admin)
                            if (currentUser && currentUser.role === 'admin') {
                                currentPage = 'online-users';
                                showOnlineUsers();
                            }
                            break;
                        case 5: // Settings
                            currentPage = 'settings';
                            showSettings();
                            break;
                    }
                    
                    closeSidebar();
                });
            });
        }

        function getPageName(index) {
            const pages = ['Dashboard', 'My Courses', 'Progress Analytics', 'Bookmarked Questions', 'Online Users', 'Settings'];
            return pages[index] || 'Dashboard';
        }

        function showOnlineUsers() {
            hideAllSections();
            pageTitle.textContent = 'Online Users';
            
            quizContainer.innerHTML = `
                <div style="padding: 24px;">
                    <div class="admin-panel">
                        <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 16px; color: var(--text-primary);">
                            <i class="fas fa-users"></i> Currently Online Users
                        </h3>
                        <p style="color: var(--text-secondary); margin-bottom: 24px;">
                            Real-time tracking of users currently practicing on the platform
                        </p>
                        <div class="online-users-list" id="detailedOnlineUsersList">
                            <div style="text-align: center; padding: 40px; color: var(--text-tertiary);">
                                <i class="fas fa-sync fa-spin" style="font-size: 32px; margin-bottom: 16px;"></i>
                                <div>Loading online users...</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            quizContainer.classList.remove('hidden');
            
            // Load online users
            loadDetailedOnlineUsers();
        }

        function loadDetailedOnlineUsers() {
            if (!currentUser || currentUser.role !== 'admin') return;
            
            firebaseUserManager.getOnlineUsers()
                .then(onlineUsers => {
                    updateDetailedOnlineUsersList(onlineUsers);
                })
                .catch(error => {
                    console.error('Error loading online users:', error);
                    document.getElementById('detailedOnlineUsersList').innerHTML = `
                        <div style="text-align: center; padding: 40px; color: var(--error);">
                            <i class="fas fa-exclamation-triangle" style="font-size: 32px; margin-bottom: 16px;"></i>
                            <div>Error loading online users</div>
                        </div>
                    `;
                });
        }

        function updateDetailedOnlineUsersList(onlineUsers) {
            const container = document.getElementById('detailedOnlineUsersList');
            
            if (onlineUsers.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: var(--text-tertiary);">
                        <i class="fas fa-users-slash" style="font-size: 48px; margin-bottom: 16px; opacity: 0.5;"></i>
                        <h3 style="font-size: 20px; margin-bottom: 8px; color: var(--text-secondary);">No Users Online</h3>
                        <p>There are currently no users actively practicing.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = onlineUsers.map(user => `
                <div class="online-user-item" style="padding: 16px; margin-bottom: 12px;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div class="online-status"></div>
                        <div class="online-user-avatar" style="background: ${getUserColor(user.name)};">
                            ${user.name.charAt(0).toUpperCase()}
                        </div>
                        <div style="flex: 1;">
                            <div style="font-weight: 600; color: var(--text-primary);">${user.name}</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">
                                ${user.phone} ‚Ä¢ ${user.role || 'Student'}
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 12px; color: var(--text-secondary);">
                                ${formatLastActive(user.lastActive)}
                            </div>
                            <div style="font-size: 11px; color: var(--text-tertiary);">
                                ${user.currentPage || 'Dashboard'}
                            </div>
                        </div>
                    </div>
                    ${user.practiceStats ? `
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border);">
                        <div style="text-align: center;">
                            <div style="font-size: 14px; font-weight: 600; color: var(--primary);">${user.practiceStats.correctAnswers || 0}</div>
                            <div style="font-size: 11px; color: var(--text-secondary);">Correct</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 14px; font-weight: 600; color: #06b6d4;">${user.practiceStats.totalQuestions || 0}</div>
                            <div style="font-size: 11px; color: var(--text-secondary);">Total</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 14px; font-weight: 600; color: #10b981;">${user.practiceStats.masteryLevel || 0}%</div>
                            <div style="font-size: 11px; color: var(--text-secondary);">Mastery</div>
                        </div>
                    </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function getUserColor(name) {
            const colors = [
                '#6366f1', '#06b6d4', '#10b981', '#f59e0b', '#ef4444',
                '#8b5cf6', '#ec4899', '#84cc16', '#f97316', '#64748b'
            ];
            const index = name.charCodeAt(0) % colors.length;
            return colors[index];
        }

        function showDashboard() {
            console.log('showDashboard called');
            
            hideAllSections();
            document.querySelector('.stats-grid').style.display = 'grid';
            document.querySelector('.analytics-section').style.display = 'block';
            document.querySelector('.search-container').style.display = 'block';
            document.querySelector('.export-section').style.display = 'block';
            
            // Update online tracker
            if (currentUser) {
                currentPage = 'Dashboard';
                onlineTracker.updateUserActivity();
            }
            
            // Reset page title
            pageTitle.textContent = 'Dashboard';
            updateDashboardStats();
            
            // ALWAYS load questions and show quiz layout
            questions = [...quizData, ...customQuestions];
            selectedCategories = [...new Set(questions.map(q => q.category))];
            
            // Reset quiz state
            currentQuestionIndex = 0;
            userAnswers = new Array(questions.length);
            isAnswerChecked = false;
            examSubmitted = false;
            
            console.log('Questions loaded:', questions.length);
            console.log('Current mode:', currentMode);
            
            // Force show quiz container
            quizContainer.classList.remove('hidden');
            resultsScreen.classList.add('hidden');
            
            if (questions.length > 0) {
                console.log('Calling renderQuizLayout...');
                renderQuizLayout();
            } else {
                console.log('No questions, showing message');
                showNoQuestionsMessage();
            }
        }

        function showCourses() {
            hideAllSections();
            pageTitle.textContent = 'My Courses';
            
            // Update online tracker
            if (currentUser) {
                currentPage = 'My Courses';
                onlineTracker.updateUserActivity();
            }
            
            quizContainer.innerHTML = `
                <div style="text-align: center; padding: 40px 20px;">
                    <div style="font-size: 80px; color: var(--primary); margin-bottom: 20px; opacity: 0.8;">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <h2 style="font-size: 32px; margin-bottom: 16px; color: var(--text-primary); background: linear-gradient(135deg, var(--primary), var(--primary-dark)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 700;">Learning Pathways</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 40px; max-width: 500px; margin-left: auto; margin-right: auto; font-size: 16px; line-height: 1.6;">
                        Structured learning paths designed to build your medical knowledge systematically.
                    </p>
                   <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 24px; margin-top: 40px;">
                        <div onclick="startCourse('anatomy')" style="cursor: pointer;">
                           ${createCourseCard('Anatomy Mastery', 'fas fa-brain', '#6366f1', 75, 'Build foundational anatomy knowledge')}
                        </div>
                        <div onclick="startCourse('physiology')" style="cursor: pointer;">
                           ${createCourseCard('Physiology Deep Dive', 'fas fa-heartbeat', '#06b6d4', 45, 'Understand body systems and functions')}
                       </div>
                        <div onclick="startCourse('pathology')" style="cursor: pointer;">
                           ${createCourseCard('Clinical Pathology', 'fas fa-virus', '#10b981', 30, 'Study diseases and diagnostics')}
                        </div> 
                        <div onclick="startCourse('pharmacology')" style="cursor: pointer;">
                           ${createCourseCard('Pharmacology', 'fas fa-pills', '#f59e0b', 20, 'Master drug mechanisms and effects')}
                        </div>
                        <div onclick="startCourse('radiology')" style="cursor: pointer;">
                           ${createCourseCard('Medical Imaging', 'fas fa-x-ray', '#8b5cf6', 15, 'Learn radiology and imaging techniques')}
                        </div>
                        <div onclick="startCourse('emergency')" style="cursor: pointer;">
                           ${createCourseCard('Emergency Medicine', 'fas fa-ambulance', '#ef4444', 10, 'Critical care and emergency procedures')}
                        </div>
                    </div>
                </div>
            `;
            quizContainer.classList.remove('hidden');
        }

        function createCourseCard(title, icon, color, progress, description) {
            return `
                <div class="category-card" style="text-align: left; cursor: pointer; border-left: 4px solid ${color};" onclick="startCourse('${title.toLowerCase()}')">
                    <div class="category-header">
                        <div class="category-icon" style="background: ${color}20; color: ${color};">
                            <i class="${icon}"></i>
                        </div>
                        <div>
                            <div class="category-name" style="font-size: 16px; font-weight: 600;">${title}</div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">${description}</div>
                        </div>
                    </div>
                    <div class="category-stats">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progress}%; background: ${color}"></div>
                        </div>
                        <div class="progress-text">${progress}%</div>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 12px;">
                        <span style="font-size: 11px; color: var(--text-tertiary);">${Math.floor(progress/10)}/10 Modules</span>
                        <span style="font-size: 11px; color: ${color}; font-weight: 600;">Continue ‚Üí</span>
                    </div>
                </div>
            `;
        }

        function showAnalytics() {
            hideAllSections();
            document.querySelector('.stats-grid').style.display = 'grid';
            document.querySelector('.analytics-section').style.display = 'block';
            document.querySelector('.export-section').style.display = 'block';
            pageTitle.textContent = 'Progress Analytics';
            
            // Update online tracker
            if (currentUser) {
                currentPage = 'Progress Analytics';
                onlineTracker.updateUserActivity();
            }
            
            updateAnalytics();
            
            quizContainer.innerHTML = `
                <div style="padding: 24px;">
                    <div class="analytics-section glass-effect" style="border-radius: 24px; padding: 32px;">
                        <h3 class="analytics-title" style="font-size: 24px; margin-bottom: 8px;">Performance Insights</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 32px;">Detailed analytics to optimize your learning journey</p>
                        <div class="analytics-grid">
                            <div class="analytics-card glass-effect" style="border-radius: 20px; padding: 24px;">
                                <div class="analytics-value" style="font-size: 32px; color: var(--primary);">${weakAreasCountEl.textContent}</div>
                                <div class="analytics-label">Areas Needing Focus</div>
                            </div>
                            <div class="analytics-card glass-effect" style="border-radius: 20px; padding: 24px;">
                                <div class="analytics-value" style="font-size: 32px; color: #06b6d4;">${avgTimePerQuestionEl.textContent}</div>
                                <div class="analytics-label">Average Response Time</div>
                            </div>
                            <div class="analytics-card glass-effect" style="border-radius: 20px; padding: 24px;">
                                <div class="analytics-value" style="font-size: 32px; color: #10b981;">${improvementRateEl.textContent}</div>
                                <div class="analytics-label">Weekly Progress Rate</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="glass-effect" style="border-radius: 24px; padding: 32px; margin-top: 24px; border: 1px solid rgba(255, 255, 255, 0.2);">
                        <h3 style="font-size: 20px; font-weight: 600; margin-bottom: 24px; color: var(--text-primary);">üìä Learning Recommendations</h3>
                        <div style="display: grid; gap: 16px;">
                            ${createRecommendation('Focus on Weak Areas', 'fas fa-bullseye', 'var(--primary)', 'Spend 60% of study time on topics below 70% mastery')}
                            ${createRecommendation('Consistent Practice', 'fas fa-chart-line', '#10b981', `Maintain your ${userStats.streak}-day streak for optimal retention`)}
                            ${createRecommendation('Active Recall', 'fas fa-brain', '#8b5cf6', 'Use spaced repetition for better long-term memory')}
                            ${createRecommendation('Mixed Practice', 'fas fa-random', '#f59e0b', 'Combine different topics in single study sessions')}
                        </div>
                    </div>

                    <div class="glass-effect" style="border-radius: 24px; padding: 32px; margin-top: 24px; border: 1px solid rgba(255, 255, 255, 0.2);">
                        <h3 style="font-size: 20px; font-weight: 600; margin-bottom: 24px; color: var(--text-primary);">üéØ Study Plan</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                            ${createStudyPlanItem('Daily Goal', '50 questions', 'fas fa-calendar-day', '#6366f1')}
                            ${createStudyPlanItem('Weekly Target', '5 hours', 'fas fa-chart-bar', '#06b6d4')}
                            ${createStudyPlanItem('Mastery Goal', '85% overall', 'fas fa-trophy', '#f59e0b')}
                            ${createStudyPlanItem('Weak Topics', '2 sessions/week', 'fas fa-exclamation-triangle', '#ef4444')}
                        </div>
                    </div>
                </div>
            `;
            quizContainer.classList.remove('hidden');
        }

        function createRecommendation(title, icon, color, description) {
            return `
                <div style="display: flex; align-items: center; gap: 16px; padding: 20px; background: rgba(255, 255, 255, 0.05); border-radius: 16px; border-left: 4px solid ${color};">
                    <i class="${icon}" style="color: ${color}; font-size: 24px;"></i>
                    <div>
                        <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">${title}</div>
                        <div style="font-size: 14px; color: var(--text-secondary); line-height: 1.5;">${description}</div>
                    </div>
                </div>
            `;
        }

        function createStudyPlanItem(title, value, icon, color) {
            return `
                <div style="text-align: center; padding: 20px; background: rgba(255, 255, 255, 0.05); border-radius: 16px;">
                    <i class="${icon}" style="color: ${color}; font-size: 32px; margin-bottom: 12px;"></i>
                    <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 8px;">${title}</div>
                    <div style="font-size: 18px; color: ${color}; font-weight: 700;">${value}</div>
                </div>
            `;
        }

        function showBookmarks() {
            const bookmarkedQuestionsList = [...quizData, ...customQuestions].filter(q => bookmarkedQuestions.has(q.id));
            hideAllSections();
            pageTitle.textContent = 'Bookmarked Questions';
            
            // Update online tracker
            if (currentUser) {
                currentPage = 'Bookmarked Questions';
                onlineTracker.updateUserActivity();
            }
            
            if (bookmarkedQuestionsList.length === 0) {
                quizContainer.innerHTML = `
                    <div style="text-align: center; padding: 80px 20px;">
                        <div style="font-size: 96px; color: var(--text-tertiary); margin-bottom: 24px; opacity: 0.5;">
                            <i class="far fa-bookmark"></i>
                        </div>
                        <h2 style="font-size: 32px; margin-bottom: 16px; color: var(--text-primary);">No Bookmarked Questions Yet</h2>
                        <p style="color: var(--text-secondary); margin-bottom: 40px; max-width: 400px; margin-left: auto; margin-right: auto; font-size: 16px; line-height: 1.6;">
                            Click the bookmark icon on any question to save it here for quick review. This is perfect for difficult concepts or important topics you want to revisit.
                        </p>
                        <button class="quiz-btn" onclick="showDashboard(); navItems[0].click()" style="background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; padding: 16px 32px; border-radius: 16px;">
                            <i class="fas fa-arrow-left"></i>
                            Explore Questions
                        </button>
                    </div>
                `;
            } else {
                quizContainer.innerHTML = `
                    <div style="padding: 24px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px;">
                            <div>
                                <h2 style="font-size: 28px; font-weight: 700; color: var(--text-primary); margin-bottom: 8px;">
                                    ${bookmarkedQuestionsList.length} Saved Question${bookmarkedQuestionsList.length !== 1 ? 's' : ''}
                                </h2>
                                <p style="color: var(--text-secondary);">Your personal collection of important questions</p>
                            </div>
                            <button class="quiz-btn" onclick="startBookmarksQuiz()" style="background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; padding: 16px 24px; border-radius: 16px;">
                                <i class="fas fa-play"></i>
                                Practice Bookmarks
                            </button>
                        </div>
                        <div style="display: grid; gap: 20px;">
                            ${bookmarkedQuestionsList.map(question => `
                                <div class="question-card glass-effect" style="cursor: pointer; border-radius: 20px; padding: 24px;" onclick="jumpToBookmarkQuestion(${question.id})">
                                    <div class="question-header">
                                        <div class="question-meta">
                                            <div class="question-number" style="background: linear-gradient(135deg, var(--primary), var(--primary-dark));">Q${question.id}</div>
                                            <div class="question-category glass-effect">${question.category}</div>
                                            <div class="question-difficulty" style="background: ${getDifficultyColor(question.difficulty)};">
                                                ${question.difficulty}
                                            </div>
                                            ${question.custom ? '<div class="question-category glass-effect" style="background: #10b98120; color: #10b981;">Custom</div>' : ''}
                                        </div>
                                        <div class="question-actions">
                                            <button class="action-btn bookmark-btn" onclick="event.stopPropagation(); toggleBookmark(${question.id}); showBookmarks();" aria-label="Remove Bookmark" style="background: rgba(239, 68, 68, 0.1); color: var(--error);">
                                                <i class="fas fa-bookmark"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="question-text" style="font-size: 16px; line-height: 1.6;">${question.question}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            quizContainer.classList.remove('hidden');
        }

        // Add this function to handle clicking on individual bookmark questions
        function jumpToBookmarkQuestion(questionId) {
            const bookmarkedQuestionsList = [...quizData, ...customQuestions].filter(q => bookmarkedQuestions.has(q.id));
            
            // Start a quiz with just this one question
            questions = [bookmarkedQuestionsList.find(q => q.id === questionId)];
            currentQuestionIndex = 0;
            userAnswers = new Array(questions.length);
            isAnswerChecked = false;
            currentMode = 'quiz';
            
            // Update mode buttons
            modeButtons.forEach(b => b.classList.remove('active'));
            modeButtons[1].classList.add('active'); // Quiz mode
            
            pageTitle.textContent = 'Quiz Mode - Bookmarked Question';
            
            hideAllSections();
            quizContainer.classList.remove('hidden');
            renderQuizLayout();
        }

        function showSettings() {
            hideAllSections();
            pageTitle.textContent = 'Settings & Preferences';
            
            // Update online tracker
            if (currentUser) {
                currentPage = 'Settings';
                onlineTracker.updateUserActivity();
            }
            
            quizContainer.innerHTML = `
                <div style="padding: 24px; max-width: 800px; margin: 0 auto;">
                    <div class="settings-panel" style="padding: 32px; margin-bottom: 24px;">
                        <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 8px; color: var(--text-primary);">üé® Appearance</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 24px;">Customize the look and feel of your study environment</p>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div>
                                <label style="display: block; color: var(--text-secondary); margin-bottom: 12px; font-weight: 600;">Theme</label>
                                <div class="mode-selector glass-effect" style="padding: 8px; border-radius: 16px;">
                                    <button class="mode-btn ${document.body.classList.contains('dark-mode') ? '' : 'active'}" onclick="setTheme('light')" style="border-radius: 12px; padding: 12px 16px;">
                                        <i class="fas fa-sun"></i>
                                        Light Mode
                                    </button>
                                    <button class="mode-btn ${document.body.classList.contains('dark-mode') ? 'active' : ''}" onclick="setTheme('dark')" style="border-radius: 12px; padding: 12px 16px;">
                                        <i class="fas fa-moon"></i>
                                        Dark Mode
                                    </button>
                                </div>
                            </div>
                            <div>
                                <label style="display: block; color: var(--text-secondary); margin-bottom: 12px; font-weight: 600;">Animation</label>
                                <div class="mode-selector glass-effect" style="padding: 8px; border-radius: 16px;">
                                    <button class="mode-btn active" style="border-radius: 12px; padding: 12px 16px;">
                                        <i class="fas fa-bolt"></i>
                                        Smooth
                                    </button>
                                    <button class="mode-btn" style="border-radius: 12px; padding: 12px 16px;">
                                        <i class="fas fa-minus"></i>
                                        Minimal
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="settings-panel" style="padding: 32px; margin-bottom: 24px;">
                        <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 8px; color: var(--text-primary);">‚ö° Study Preferences</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 24px;">Optimize your learning experience</p>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div>
                                <label style="display: block; color: var(--text-secondary); margin-bottom: 12px; font-weight: 600;">Default Mode</label>
                                <div class="mode-selector glass-effect" style="padding: 8px; border-radius: 16px;">
                                    <button class="mode-btn ${currentMode === 'quiz' ? 'active' : ''}" onclick="setDefaultMode('quiz')" style="border-radius: 12px; padding: 12px 16px;">
                                        <i class="fas fa-tasks"></i>
                                        Quiz
                                    </button>
                                    <button class="mode-btn ${currentMode === 'exam' ? 'active' : ''}" onclick="setDefaultMode('exam')" style="border-radius: 12px; padding: 12px 16px;">
                                        <i class="fas fa-file-alt"></i>
                                        Exam
                                    </button>
                                </div>
                            </div>
                            <div>
                                <label style="display: block; color: var(--text-secondary); margin-bottom: 12px; font-weight: 600;">Questions Per Session</label>
                                <select class="modern-dropdown" style="width: 100%;" onchange="setQuestionsPerSession(this.value)">
                                    <option value="10">10 Questions</option>
                                    <option value="25" selected>25 Questions</option>
                                    <option value="50">50 Questions</option>
                                    <option value="100">100 Questions</option>
                                    <option value="0">All Questions</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="settings-panel" style="padding: 32px; margin-bottom: 24px;">
                        <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 8px; color: var(--text-primary);">üìä Data & Progress</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 24px;">Manage your learning data</p>
                        <div style="display: flex; flex-direction: column; gap: 16px;">
                            <button class="quiz-btn" onclick="exportProgress()" style="background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; padding: 16px 24px; border-radius: 16px; justify-content: start;">
                                <i class="fas fa-download" style="margin-right: 12px;"></i>
                                Export Progress
                            </button>
                            <button class="quiz-btn" onclick="showCustomQuestionCreator()" style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 16px 24px; border-radius: 16px; justify-content: start;">
                                <i class="fas fa-plus" style="margin-right: 12px;"></i>
                                Create Custom Question
                            </button>
                            <button class="quiz-btn" onclick="resetProgress()" style="background: linear-gradient(135deg, var(--error), #dc2626); color: white; padding: 16px 24px; border-radius: 16px; justify-content: start;">
                                <i class="fas fa-trash" style="margin-right: 12px;"></i>
                                Reset All Progress
                            </button>
                        </div>
                    </div>

                    <div class="settings-panel" style="padding: 32px;">
                        <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 8px; color: var(--text-primary);">‚ÑπÔ∏è About ALIF</h3>
                        <div style="color: var(--text-secondary); line-height: 1.7;">
                            <p>ALIF is an advanced medical education platform designed to help medical students and professionals enhance their knowledge through interactive quizzes and detailed analytics.</p>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-top: 20px;">
                                <div>
                                    <strong style="color: var(--text-primary);">Version</strong>
                                    <div>2.1.0</div>
                                </div>
                                <div>
                                    <strong style="color: var(--text-primary);">Questions</strong>
                                    <div>${quizData.length + customQuestions.length} total</div>
                                </div>
                                <div>
                                    <strong style="color: var(--text-primary);">Last Updated</strong>
                                    <div>${new Date().toLocaleDateString()}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            quizContainer.classList.remove('hidden');
        }

        function setTheme(theme) {
            if (theme === 'dark') {
                document.body.classList.add('dark-mode');
                themeToggle.querySelector('i').className = 'fas fa-sun';
            } else {
                document.body.classList.remove('dark-mode');
                themeToggle.querySelector('i').className = 'fas fa-moon';
            }
            showNotification(`Theme set to ${theme} mode`, 'success');
        }

        function setDefaultMode(mode) {
            currentMode = mode;
            modeButtons.forEach(b => b.classList.remove('active'));
            modeButtons[mode === 'quiz' ? 1 : 0].classList.add('active');
            showNotification(`Default mode set to ${mode}`, 'success');
        }

        function setQuestionsPerSession(count) {
            showNotification(`Questions per session set to ${count === '0' ? 'all' : count}`, 'info');
        }

        // ... (ALL OTHER EXISTING FUNCTIONS CONTINUE EXACTLY AS THEY WERE)
        // This includes: createFAB, showCustomQuestionCreator, closeCustomQuestionModal, saveCustomQuestion,
        // hideAllSections, startCourse, startBookmarksQuiz, resetProgress, initializeEnhancedFeatures,
        // toggleSidebar, closeSidebar, toggleTheme, loadUserData, saveUserData, updateDashboardStats,
        // updateAnalytics, exportProgress, createCustomQuiz, shuffleArray, showNotification,
        // initializeCategories, toggleCategory, startQuiz, showNoQuestionsMessage, startTimer,
        // formatTime, updateTimerDisplay, stopTimer, renderQuizLayout, renderExamLayout,
        // renderSingleQuestionLayout, initializeQuizEvents, initializeExamModeEvents,
        // updateExamProgress, updateExamSubmitButton, checkAnswer, submitExam, calculateMasteryLevel,
        // showResults, toggleBookmark, getDifficultyColor, jumpToQuestion, initializeSearch,
        // performSearch, showSearchNoResults, clearSearch, highlightSearchTerms,
        // initializeKeyboardNavigation, navigateOptions, enhanceAccessibility, generateStudyReport

        // Initialize the application
        init();

        // Handle page unload to set user offline
        window.addEventListener('beforeunload', () => {
            if (currentUser) {
                onlineTracker.setOffline();
            }
        });

        // Force status check every minute
        setInterval(() => {
            if (currentUser) {
                verifyUserStatus();
            }
        }, 60000);
    </script>
</body>
</html>
