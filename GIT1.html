<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedQUIZ | Advanced Medical Quiz Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <style>
        :root {
            --primary: #5A54E8;
            --primary-light: #7A74FF;
            --primary-dark: #3E38B8;
            --secondary: #FF6584;
            --success: #4ADE80;
            --warning: #FBBF24;
            --danger: #EF4444;
            --light: #F9FAFB;
            --dark: #111827;
            --gray: #6B7280;
            --gray-light: #E5E7EB;
            --border-radius: 16px;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --gradient-primary: linear-gradient(135deg, var(--primary-light), var(--primary));
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.15);
            --background-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --card-gradient: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
        }

        .dark-theme {
            --primary: #7A74FF;
            --primary-light: #9D98FF;
            --primary-dark: #5A54E8;
            --light: #1F2937;
            --dark: #F3F4F6;
            --gray: #9CA3AF;
            --gray-light: #374151;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.25);
            --glass-bg: rgba(31, 41, 55, 0.4);
            --glass-border: rgba(255, 255, 255, 0.1);
            --background-gradient: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            --card-gradient: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            background: var(--background-gradient);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            padding: 1rem;
            transition: var(--transition);
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Registration Modal */
        .registration-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            transition: opacity 0.3s ease;
        }

        .registration-form {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            padding: 2.5rem;
            width: 90%;
            max-width: 450px;
            box-shadow: var(--shadow-lg);
            position: relative;
            animation: slideUp 0.5s ease;
            border: 1px solid var(--glass-border);
        }

        .registration-form h2 {
            color: var(--primary);
            margin-bottom: 1.5rem;
            text-align: center;
            font-weight: 700;
            font-size: 1.8rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            background: rgba(255, 255, 255, 0.1);
            color: var(--dark);
            font-size: 1rem;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(90, 84, 232, 0.2);
            background: rgba(255, 255, 255, 0.2);
        }

        .btn-submit {
            width: 100%;
            padding: 0.75rem;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 1rem;
            box-shadow: var(--shadow);
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .blurred-content {
            filter: blur(3px);
            pointer-events: none;
            transition: filter 0.5s ease;
        }

        /* Header Styles */
        header {
            text-align: center;
            padding: 2rem;
            background: var(--card-gradient);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            position: relative;
            margin-bottom: 1.5rem;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--gradient-primary);
            border-radius: var(--border-radius) var(--border-radius) 0 0;
        }

        h1 {
            color: var(--primary);
            font-size: 2.5rem;
            font-weight: 800;
            letter-spacing: -0.025em;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .subtitle {
            color: var(--gray);
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
            font-weight: 400;
            line-height: 1.5;
        }

        .mode-selector {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1.5rem;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            padding: 0.5rem;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
            border: 1px solid var(--glass-border);
        }

        .mode-btn {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 50px;
            background: transparent;
            color: var(--gray);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .mode-btn.active {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow);
        }

        .mode-btn:hover {
            background: rgba(90, 84, 232, 0.15);
            transform: translateY(-2px);
        }

        .quiz-info {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .info-card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            padding: 0.6rem 1rem;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
            font-size: 0.9rem;
            border: 1px solid var(--glass-border);
            transition: var(--transition);
        }

        .info-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }

        .info-card i {
            color: var(--primary);
            font-size: 1rem;
        }

        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        .questions-container {
            background: var(--card-gradient);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .questions-container:hover {
            box-shadow: var(--shadow-lg);
        }

        .question-section {
            margin-bottom: 2.5rem;
            display: flex;
            flex-direction: column;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            background: var(--light);
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .question-section:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .question-section.current {
            border-left: 4px solid var(--primary);
            padding-left: 1.5rem;
        }

        .question-header {
            display: flex;
            align-items: flex-start;
            margin-bottom: 1.5rem;
            gap: 1rem;
        }

        .question-number {
            background: var(--gradient-primary);
            color: white;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.1rem;
            flex-shrink: 0;
            box-shadow: var(--shadow);
        }

        .question-text {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--dark);
            line-height: 1.5;
            flex: 1;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        @media (min-width: 768px) {
            .options-container {
                grid-template-columns: 1fr 1fr;
            }
        }

        .option {
            padding: 1rem 1.25rem;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 500;
            font-size: 1rem;
            background: var(--light);
            box-shadow: var(--shadow);
        }

        .option:hover {
            border-color: var(--primary);
            background: rgba(90, 84, 232, 0.05);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .option.selected {
            border-color: var(--primary);
            background: rgba(90, 84, 232, 0.1);
        }

        .option.correct {
            border-color: var(--success);
            background: rgba(74, 222, 128, 0.1);
        }

        .option.incorrect {
            border-color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
        }

        .option-letter {
            width: 2rem;
            height: 2rem;
            border-radius: 8px;
            background: var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            flex-shrink: 0;
            transition: var(--transition);
        }

        .option.selected .option-letter {
            background: var(--primary);
            color: white;
        }

        .option.correct .option-letter {
            background: var(--success);
            color: white;
        }

        .option.incorrect .option-letter {
            background: var(--danger);
            color: white;
        }

        .explanation-toggle {
            color: var(--primary);
            background: none;
            border: none;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 0;
            font-size: 0.9rem;
            align-self: flex-start;
            transition: var(--transition);
        }

        .explanation-toggle:hover {
            color: var(--primary-dark);
            transform: translateX(5px);
        }

        .explanation {
            margin-top: 1rem;
            padding: 1.5rem;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            border: 1px solid var(--glass-border);
            display: none;
            animation: slideDown 0.4s ease;
        }

        .explanation.show {
            display: block;
        }

        .explanation.loading::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, var(--gray-light) 25%, rgba(255,255,255,0.3) 50%, var(--gray-light) 75%);
            background-size: 200% 100%;
            animation: skeleton-loading 1.5s infinite;
            border-radius: var(--border-radius);
        }

        .explanation-section {
            margin-bottom: 1rem;
        }

        .explanation-section h4 {
            margin-bottom: 0.5rem;
            color: var(--primary);
            font-size: 1rem;
            font-weight: 600;
        }

        .why-not-item {
            margin-bottom: 0.75rem;
            font-size: 0.9rem;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .why-not-letter {
            font-weight: 700;
            color: var(--primary);
            min-width: 1.5rem;
        }

        /* Sidebar Styles */
        .sidebar {
            background: var(--card-gradient);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            height: fit-content;
            transition: var(--transition);
            order: -1;
            max-height: calc(100vh - 5rem);
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) var(--glass-bg);
            position: fixed;
            top: 0;
            right: -100%;
            height: 100%;
            width: 100%;
            max-width: 320px;
            z-index: 1000;
            transition: right 0.3s ease;
            box-shadow: var(--shadow-lg);
            padding-top: 4rem;
        }

        .sidebar.active {
            right: 0;
        }

        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: var(--glass-bg);
            border-radius: 3px;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* Menu Toggle */
        .menu-toggle {
            position: fixed;
            top: 1rem;
            right: 1rem;
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            border: none;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            z-index: 1001;
            transition: var(--transition);
            align-items: center;
            justify-content: center;
            display: flex;
        }

        .menu-toggle:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(90, 84, 232, 0.3);
        }

        .menu-toggle.active {
            background: var(--danger);
        }

        /* Hamburger Icon */
        .hamburger {
            width: 20px;
            height: 16px;
            position: relative;
            transform: rotate(0deg);
            transition: .5s ease-in-out;
            cursor: pointer;
        }

        .hamburger span {
            display: block;
            position: absolute;
            height: 2px;
            width: 100%;
            background: white;
            border-radius: 2px;
            opacity: 1;
            left: 0;
            transform: rotate(0deg);
            transition: .25s ease-in-out;
        }

        .hamburger span:nth-child(1) {
            top: 0px;
        }

        .hamburger span:nth-child(2) {
            top: 7px;
        }

        .hamburger span:nth-child(3) {
            top: 14px;
        }

        .hamburger.active span:nth-child(1) {
            top: 7px;
            transform: rotate(135deg);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
            left: -60px;
        }

        .hamburger.active span:nth-child(3) {
            top: 7px;
            transform: rotate(-135deg);
        }

        .progress-container {
            margin-bottom: 1.5rem;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--glass-border);
            transition: var(--transition);
        }

        .progress-container:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .progress-bar {
            height: 8px;
            background: var(--gray-light);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            border-radius: 4px;
            width: 0%;
            transition: width 0.5s ease;
        }

        .navigation-buttons {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .btn {
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            flex: 1;
            font-size: 0.95rem;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary-light));
            box-shadow: var(--shadow-lg);
            transform: translateY(-3px);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-outline:hover {
            background: rgba(90, 84, 232, 0.15);
            transform: translateY(-3px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .question-jump, .category-jump {
            margin-bottom: 1.5rem;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--glass-border);
            transition: var(--transition);
        }

        .question-jump:hover, .category-jump:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .question-jump-header, .category-jump-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            padding: 0.5rem 0;
        }

        .question-jump-header h3, .category-jump-header h3 {
            margin-bottom: 0;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .question-jump-header i, .category-jump-header i {
            transition: var(--transition);
            color: var(--gray);
        }

        .question-jump-header:hover i, .category-jump-header:hover i {
            color: var(--primary);
        }

        .question-jump-content, .category-jump-content {
            margin-top: 0.75rem;
            transition: var(--transition);
            overflow: hidden;
        }

        .question-jump-content.collapsed, .category-jump-content.collapsed {
            display: none;
        }

        .question-jump-content.expanded, .category-jump-content.expanded {
            display: block;
            animation: slideDown 0.3s ease;
        }

        .question-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(2.5rem, 1fr));
            gap: 0.75rem;
        }

        .question-indicator {
            width: 100%;
            aspect-ratio: 1;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            font-size: 0.9rem;
        }

        .question-indicator:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.1);
        }

        .question-indicator.answered {
            background: var(--gradient-primary);
            color: white;
        }

        .question-indicator.current {
            box-shadow: 0 0 0 2px var(--primary);
        }

        .category-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .category-item {
            padding: 0.75rem;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            font-size: 0.95rem;
        }

        .category-item:hover {
            background: var(--primary);
            color: white;
            transform: translateX(5px);
        }

        .timer {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            border-radius: var(--border-radius);
            font-weight: 600;
            font-size: 0.95rem;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            margin-bottom: 1rem;
        }

        .timer i {
            color: var(--warning);
        }

        .results-container {
            text-align: center;
            padding: 2.5rem;
            background: var(--card-gradient);
            border-radius: var(--border-radius);
            margin-top: 2rem;
            display: none;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .results-container.show {
            display: block;
            animation: fadeInUp 0.6s ease;
        }

        .score-circle {
            width: 160px;
            height: 160px;
            border-radius: 50%;
            margin: 0 auto 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: conic-gradient(var(--gradient-primary) 0% var(--p, 0%), var(--gray-light) var(--p, 0%) 100%);
            position: relative;
            box-shadow: var(--shadow);
        }

        .score-circle::before {
            content: '';
            position: absolute;
            width: 140px;
            height: 140px;
            border-radius: 50%;
            background: var(--light);
        }

        .score-text {
            position: relative;
            z-index: 1;
            text-align: center;
        }

        .score-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            line-height: 1;
        }

        .score-label {
            font-size: 1rem;
            color: var(--gray);
        }

        .results-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
        }

        @media (max-width: 600px) {
            .results-details {
                grid-template-columns: 1fr;
            }
        }

        .result-card {
            padding: 1rem;
            border-radius: var(--border-radius);
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            transition: var(--transition);
        }

        .result-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .result-card i {
            font-size: 1.75rem;
            margin-bottom: 0.75rem;
            color: var(--primary);
        }

        .result-value {
            font-size: 1.75rem;
            font-weight: 700;
        }

        .learn-progress {
            margin-bottom: 1.5rem;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--glass-border);
            display: none;
        }

        .learn-progress.show {
            display: block;
        }

        .learn-progress-text {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .quality-rate {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-top: 0.75rem;
            font-size: 0.9rem;
            color: var(--gray);
        }

        .quality-stars {
            display: flex;
            gap: 0.25rem;
        }

        .quality-stars i {
            color: var(--warning);
        }

        .learn-mode-container {
            display: none;
            text-align: center;
            padding: 2rem;
            background: var(--card-gradient);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 1.5rem;
            transition: var(--transition);
        }

        .learn-mode-container.show {
            display: block;
        }

        .learn-question {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: var(--dark);
            line-height: 1.4;
        }

        .learn-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        @media (min-width: 768px) {
            .learn-options {
                grid-template-columns: 1fr 1fr;
            }
        }

        .learn-option {
            padding: 1.25rem;
            border: 1px solid var(--gray-light);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 1rem;
            font-weight: 500;
            font-size: 1rem;
            background: var(--light);
            box-shadow: var(--shadow);
        }

        .learn-option:hover {
            border-color: var(--primary);
            background: rgba(90, 84, 232, 0.05);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .learn-option.selected {
            border-color: var(--primary);
            background: rgba(90, 84, 232, 0.1);
        }

        .learn-option.correct {
            border-color: var(--success);
            background: rgba(74, 222, 128, 0.1);
        }

        .learn-option.incorrect {
            border-color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
        }

        .learn-option-letter {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 8px;
            background: var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1rem;
            flex-shrink: 0;
            transition: var(--transition);
        }

        .learn-option.selected .learn-option-letter {
            background: var(--primary);
            color: white;
        }

        .learn-option.correct .learn-option-letter {
            background: var(--success);
            color: white;
        }

        .learn-option.incorrect .learn-option-letter {
            background: var(--danger);
            color: white;
        }

        .learn-next-btn {
            margin-top: 1.5rem;
            padding: 0.9rem 1.75rem;
            font-size: 1rem;
            font-weight: 600;
        }

        .learn-completion {
            text-align: center;
            padding: 2.5rem;
            display: none;
        }

        .learn-completion.show {
            display: block;
            animation: fadeInUp 0.6s ease;
        }

        .completion-icon {
            font-size: 3.5rem;
            color: var(--success);
            margin-bottom: 1rem;
        }

        .floating-controls {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            display: flex;
            flex-direction: row;
            gap: 0.75rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .floating-controls.visible {
            opacity: 1;
        }

        @media (min-width: 769px) {
            .floating-controls {
                opacity: 0;
            }
            .container:hover .floating-controls {
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            .floating-controls {
                opacity: 0;
            }
            .floating-controls.visible {
                opacity: 1;
            }
        }

        .floating-btn {
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            background: var(--gradient-primary);
            color: white;
            border: none;
            font-size: 1.1rem;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .floating-btn:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-lg);
        }

        .mode-indicator {
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: 1rem;
        }

        .quiz-mode {
            background: rgba(90, 84, 232, 0.15);
            color: var(--primary);
        }

        .exam-mode {
            background: rgba(255, 101, 132, 0.15);
            color: var(--secondary);
        }

        .learn-mode {
            background: rgba(74, 222, 128, 0.15);
            color: var(--success);
        }

        .flashcard-mode {
            background: rgba(251, 191, 36, 0.15);
            color: var(--warning);
        }

        .flashcard-mode-container {
            display: none;
            flex-direction: column;
            align-items: center;
            padding: 2rem;
            background: var(--card-gradient);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            margin-bottom: 1.5rem;
            position: relative;
            transition: var(--transition);
        }

        .flashcard-mode-container.show {
            display: flex;
        }

        .flashcard-categories {
            display: flex;
            overflow-x: auto;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            width: 100%;
            max-width: 100%;
            padding: 0.75rem 0;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) var(--gray-light);
        }

        .flashcard-categories::-webkit-scrollbar {
            height: 6px;
        }

        .flashcard-categories::-webkit-scrollbar-track {
            background: var(--gray-light);
            border-radius: 3px;
        }

        .flashcard-categories::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }

        .flashcard-category {
            padding: 0.5rem 1rem;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            cursor: pointer;
            white-space: nowrap;
            transition: var(--transition);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .flashcard-category.active {
            background: var(--gradient-primary);
            color: white;
        }

        .flashcard-category:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .flashcard-wrapper {
            perspective: 1000px;
            width: 100%;
            max-width: 600px;
            height: 350px;
            margin-bottom: 1.5rem;
        }

        .flashcard {
            width: 100%;
            height: 100%;
            position: relative;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            border-radius: var(--border-radius);
        }

        .flashcard.flipped {
            transform: rotateY(180deg);
        }

        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            background: linear-gradient(135deg, var(--light), var(--gray-light));
            border-radius: var(--border-radius);
            overflow-y: auto;
        }

        .flashcard-back {
            transform: rotateY(180deg);
            background: linear-gradient(135deg, var(--primary-light), var(--primary));
            color: white;
        }

        .flashcard-question {
            font-size: 1.5rem;
            font-weight: 600;
            text-align: center;
            margin-bottom: 1rem;
            line-height: 1.4;
        }

        .flashcard-answer {
            font-size: 1.25rem;
            font-weight: 600;
            text-align: center;
            margin-bottom: 1rem;
        }

        .flashcard-explanation {
            font-size: 1rem;
            text-align: center;
            line-height: 1.5;
        }

        .flashcard-controls {
            display: flex;
            flex-direction: row;
            justify-content: center;
            gap: 0.5rem;
            flex-wrap: nowrap;
            width: 100%;
            max-width: 600px;
        }

        .flashcard-controls .btn {
            padding: 0.5rem;
            font-size: 0.9rem;
            min-width: 60px;
        }

        .flashcard-controls .btn i {
            font-size: 1rem;
        }

        .flashcard-stats {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 600px;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: var(--gray);
        }

        .flashcard-progress {
            margin-bottom: 1.5rem;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            padding: 1rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--glass-border);
            display: none;
            width: 100%;
            max-width: 600px;
        }

        .flashcard-progress.show {
            display: block;
        }

        .flashcard-progress-text {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .flashcard-completion {
            text-align: center;
            padding: 2.5rem;
            display: none;
        }

        .flashcard-completion.show {
            display: block;
            animation: fadeInUp 0.6s ease;
        }

        /* Toast notifications */
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            padding: 1rem 1.5rem;
            background: var(--card-gradient);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            z-index: 2000;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast i {
            font-size: 1.25rem;
        }

        .toast.success i {
            color: var(--success);
        }

        .toast.error i {
            color: var(--danger);
        }

        .toast.info i {
            color: var(--primary);
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; max-height: 0; }
            to { opacity: 1; max-height: 1000px; }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes skeleton-loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        @media (max-width: 768px) {
            body {
                padding: 0.75rem;
            }
            header {
                padding: 1.5rem;
                margin-bottom: 1rem;
            }
            h1 {
                font-size: 2rem;
            }
            .questions-container {
                padding: 1.5rem;
            }
            .question-text {
                font-size: 1.1rem;
            }
            .option {
                padding: 0.75rem;
                font-size: 0.9rem;
            }
            .question-header {
                gap: 0.75rem;
            }
            .question-number {
                width: 2rem;
                height: 2rem;
                font-size: 0.9rem;
            }
            .learn-question {
                font-size: 1.25rem;
            }
            .learn-option {
                padding: 1rem;
                font-size: 0.9rem;
            }
            .flashcard-wrapper {
                height: 300px;
            }
            .flashcard-question {
                font-size: 1.25rem;
            }
            .flashcard-answer {
                font-size: 1.1rem;
            }
            .flashcard-explanation {
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.75rem;
            }
            .subtitle {
                font-size: 0.9rem;
            }
            .info-card {
                font-size: 0.8rem;
                padding: 0.5rem 0.8rem;
            }
            .question-text {
                font-size: 1rem;
            }
            .option {
                font-size: 0.85rem;
            }
            .learn-question {
                font-size: 1.1rem;
            }
            .learn-option {
                font-size: 0.85rem;
            }
            .flashcard-wrapper {
                height: 250px;
            }
            .flashcard-question {
                font-size: 1.1rem;
            }
            .flashcard-answer {
                font-size: 1rem;
            }
            .flashcard-explanation {
                font-size: 0.85rem;
            }
            .flashcard-controls .btn {
                min-width: 50px;
                padding: 0.4rem;
                font-size: 0.8rem;
            }
            .flashcard-controls .btn i {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <!-- Registration Modal -->
    <div class="registration-modal" id="registrationModal">
        <div class="registration-form">
            <h2>Welcome to MedQUIZ</h2>
            <p style="text-align: center; margin-bottom: 1.5rem; color: var(--gray);">Please register to start your medical quiz</p>
            <form id="registrationForm">
                <div class="form-group">
                    <label for="fullName">Full Name</label>
                    <input type="text" id="fullName" class="form-control" required placeholder="Enter your full name">
                </div>
                <div class="form-group">
                    <label for="telegramUsername">Telegram Username</label>
                    <input type="text" id="telegramUsername" class="form-control" required placeholder="@username">
                </div>
                <button type="submit" class="btn-submit">Start Quiz</button>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">Notification sent successfully</span>
    </div>

    <div class="container blurred-content" id="mainContainer">
        <header>
            <h1>MedQUIZ <span class="mode-indicator quiz-mode" id="modeIndicator">Quiz Mode</span></h1>
            <p class="subtitle">Test your medical knowledge with interactive, adaptive quizzes powered by advanced physiology insights.</p>
            <div class="mode-selector">
                <div class="mode-btn active" data-mode="quiz">Quiz Mode</div>
                <div class="mode-btn" data-mode="exam">Exam Mode</div>
                <div class="mode-btn" data-mode="learn">Learn Mode</div>
                <div class="mode-btn" data-mode="flashcard">Flashcard Mode</div>
            </div>
            <div class="quiz-info">
                <div class="info-card">
                    <i class="fas fa-book-medical"></i>
                    <span id="questionCount">3 Questions</span>
                </div>
                <div class="info-card">
                    <i class="fas fa-clock"></i>
                    <span id="timeInfo">10 Minutes</span>
                </div>
                <div class="info-card">
                    <i class="fas fa-brain"></i>
                    <span>Advanced Level</span>
                </div>
            </div>
        </header>
       
        <button class="menu-toggle" id="menuToggleBtn">
            <div class="hamburger" id="hamburgerIcon">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>
       
        <div class="content-wrapper">
            <div class="learn-mode-container" id="learnModeContainer">
                <div class="learn-question" id="learnQuestionText"></div>
                <div class="learn-options" id="learnOptionsContainer"></div>
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="learnPrevBtn">
                        <i class="fas fa-arrow-left"></i> Prev
                    </button>
                    <button class="btn btn-primary" id="learnNextBtn" disabled>
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
                <div class="learn-completion" id="learnCompletion">
                    <div class="completion-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h2>Learning Complete!</h2>
                    <p>You've successfully answered all questions correctly.</p>
                    <button class="btn btn-outline" id="learnRestartBtn" style="margin-top: 1rem;">
                        <i class="fas fa-redo"></i> Practice Again
                    </button>
                </div>
            </div>
           
            <div class="questions-container" id="questionsContainer"></div>
            <div class="flashcard-mode-container" id="flashcardModeContainer">
                <div class="flashcard-progress" id="flashcardProgress">
                    <div class="flashcard-progress-text">
                        <span>Flashcard Progress</span>
                        <span id="flashcardProgressPercent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="flashcardProgressFill"></div>
                    </div>
                </div>
                <div class="flashcard-categories" id="flashcardCategories"></div>
                <div class="flashcard-stats">
                    <span id="flashcardRemaining">Remaining: 0</span>
                    <span id="flashcardKnown">Known: 0</span>
                    <span id="flashcardTotal">Total: 0</span>
                </div>
                <div class="flashcard-wrapper">
                    <div class="flashcard" id="flashcard">
                        <div class="flashcard-front">
                            <div class="flashcard-question" id="flashcardQuestion"></div>
                            <i class="fas fa-sync-alt" style="position: absolute; bottom: 0.75rem; font-size: 0.9rem; color: var(--gray);">Tap to flip</i>
                        </div>
                        <div class="flashcard-back">
                            <div class="flashcard-answer" id="flashcardAnswer"></div>
                            <div class="flashcard-explanation" id="flashcardExplanation"></div>
                        </div>
                    </div>
                </div>
                <div class="flashcard-controls">
                    <button class="btn btn-outline" id="flashcardPrevBtn" title="Previous">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <button class="btn btn-primary" id="flashcardNextBtn" title="Next">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                    <button class="btn btn-outline" id="flashcardShuffleBtn" title="Shuffle">
                        <i class="fas fa-random"></i>
                    </button>
                    <button class="btn btn-success" id="flashcardKnownBtn" title="I Know This">
                        <i class="fas fa-check"></i>
                    </button>
                    <button class="btn btn-danger" id="flashcardUnknownBtn" title="Review Later">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="flashcard-completion" id="flashcardCompletion">
                    <div class="completion-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <h2>Deck Mastered!</h2>
                    <p>You've reviewed all flashcards.</p>
                    <button class="btn btn-outline" id="flashcardRestartBtn" style="margin-top: 1rem;">
                        <i class="fas fa-redo"></i> Restart Deck
                    </button>
                </div>
            </div>
           
            <div class="sidebar" id="sidebar">
                <div class="learn-progress" id="learnProgress">
                    <div class="learn-progress-text">
                        <span>Learning Progress</span>
                        <span id="learnProgressPercent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="learnProgressFill"></div>
                    </div>
                    <div class="quality-rate">
                        <span>Quality:</span>
                        <div class="quality-stars" id="qualityStars">
                            <i class="far fa-star"></i>
                            <i class="far fa-star"></i>
                            <i class="far fa-star"></i>
                            <i class="far fa-star"></i>
                            <i class="far fa-star"></i>
                        </div>
                    </div>
                </div>
               
                <div class="progress-container" id="progressContainer">
                    <div class="progress-text">
                        <span>Progress</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>
               
                <div class="navigation-buttons">
                    <button class="btn btn-outline" id="prevBtn">
                        <i class="fas fa-arrow-left"></i> Prev
                    </button>
                    <button class="btn btn-primary" id="nextBtn">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
               
                <div class="category-jump">
                    <div class="category-jump-header" id="categoryJumpToggle">
                        <h3>Jump to Category</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-jump-content expanded" id="categoryJumpContent">
                        <div class="category-list" id="categoryList"></div>
                    </div>
                </div>
               
                <div class="question-jump">
                    <div class="question-jump-header" id="jumpToggle">
                        <h3>Jump to Question</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="question-jump-content expanded" id="jumpContent">
                        <div class="question-grid" id="questionIndicators"></div>
                    </div>
                </div>
               
                <div class="timer">
                    <i class="fas fa-clock"></i>
                    <span id="timeDisplay">10:00</span>
                </div>
               
                <button class="btn btn-primary" id="submitBtn" style="width: 100%;">
                    <i class="fas fa-check"></i> Submit
                </button>
            </div>
        </div>
       
        <div class="results-container" id="resultsContainer">
            <h2>Results</h2>
            <p>Your performance summary</p>
            <div class="score-circle" id="scoreCircle">
                <div class="score-text">
                    <div class="score-value" id="scoreValue">0%</div>
                    <div class="score-label">Correct</div>
                </div>
            </div>
            <div class="results-details">
                <div class="result-card">
                    <i class="fas fa-check-circle"></i>
                    <div class="result-value" id="correctCount">0</div>
                    <div>Correct</div>
                </div>
                <div class="result-card">
                    <i class="fas fa-times-circle"></i>
                    <div class="result-value" id="incorrectCount">0</div>
                    <div>Incorrect</div>
                </div>
                <div class="result-card">
                    <i class="fas fa-clock"></i>
                    <div class="result-value" id="timeTaken">0:00</div>
                    <div>Time Taken</div>
                </div>
            </div>
            <button class="btn btn-outline" id="restartBtn" style="margin-top: 1rem;">
                <i class="fas fa-redo"></i> Retake
            </button>
        </div>
    </div>
   
    <div class="floating-controls" id="floatingControls">
        <button class="floating-btn" id="scrollTopBtn" title="Scroll to top">
            <i class="fas fa-arrow-up"></i>
        </button>
        <button class="floating-btn" id="themeToggleBtn" title="Toggle theme">
            <i class="fas fa-moon"></i>
        </button>
        <button class="floating-btn" id="submitFloatingBtn" title="Submit">
            <i class="fas fa-check"></i>
        </button>
    </div>

    <script>
        // Telegram Bot Configuration
        const TELEGRAM_BOT_TOKEN = '8099057930:AAFXRiaWc2CV-zr-I22fSV2wQOFVww6zBHI';
        const TELEGRAM_CHAT_ID = '7897840965';
        
        // User data
        let userData = {
            fullName: '',
            telegramUsername: '',
            registrationTime: null
        };
        
        // Mode tracking
        let modeUsage = {
            quiz: { startTime: null, duration: 0 },
            exam: { startTime: null, duration: 0 },
            learn: { startTime: null, duration: 0 },
            flashcard: { startTime: null, duration: 0 }
        };
        
        // Quiz data
        const quizData = [
    {
        "id": 1,
        "question": "The splanchnic circulation is defined as the blood flow through the GIT, spleen, pancreas, and liver. What is a key functional advantage of this specific arrangement?",
        "options": [
            "It allows for independent regulation of blood flow to each organ.",
            "Blood from the gut, spleen, and pancreas passes through the liver sinusoids before returning to systemic circulation.",
            "It ensures the highest blood pressure is maintained in the hepatic arteries.",
            "It prevents the release of GI hormones into the general circulation."
        ],
        "answer": 1,
        "correctAnswer": "Blood from the gut, spleen, and pancreas passes through the liver sinusoids before returning to systemic circulation.",
        "explanation": "The splanchnic circulation directs blood from the gut, spleen, and pancreas through the hepatic portal vein to the liver sinusoids for processing before entering systemic circulation, allowing detoxification and nutrient metabolism. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 255.",
        "whyNotOtherOptions": {
            "a": "Blood flow is not independently regulated for each organ; it is coordinated.",
            "c": "Hepatic arteries do not maintain the highest pressure; portal vein flow is lower pressure.",
            "d": "GI hormones enter systemic circulation after liver processing."
        },
        "relatedQuestions": ["4 (blood flow pathway)"],
        "category": "Gastrointestinal Blood Supply",
        "difficulty": "Hard"
    },
    {
        "id": 2,
        "question": "All of the following are listed as major suppliers of arterial blood to the GIT EXCEPT the:",
        "options": [
            "Celiac artery",
            "Superior mesenteric artery",
            "Inferior mesenteric artery",
            "Hepatic portal vein"
        ],
        "answer": 3,
        "correctAnswer": "Hepatic portal vein",
        "explanation": "The hepatic portal vein carries venous blood from the GIT to the liver, not arterial blood. The celiac, superior mesenteric, and inferior mesenteric arteries supply arterial blood to the GIT. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 255.",
        "whyNotOtherOptions": {
            "a": "Celiac artery supplies the stomach, liver, and spleen.",
            "b": "Superior mesenteric artery supplies the small intestine and proximal colon.",
            "c": "Inferior mesenteric artery supplies the distal colon."
        },
        "relatedQuestions": ["1 (splanchnic circulation)"],
        "category": "Gastrointestinal Blood Supply",
        "difficulty": "Medium"
    },
    {
        "id": 3,
        "question": "During a meal, blood flow to the gastrointestinal tract can increase by 100%. Which of the following is a primary mediator of this vasodilation?",
        "options": [
            "Catecholamines released from sympathetic nerves",
            "Vasoconstrictor GI hormones like somatostatin",
            "Vasodilator GI hormones like CCK and VIP",
            "A significant drop in systemic oxygen concentration"
        ],
        "answer": 2,
        "correctAnswer": "Vasodilator GI hormones like CCK and VIP",
        "explanation": "Vasodilator GI hormones like CCK and VIP promote increased blood flow to the GIT during digestion by causing vasodilation. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 260.",
        "whyNotOtherOptions": {
            "a": "Catecholamines cause vasoconstriction, reducing GIT blood flow.",
            "b": "Somatostatin is a vasoconstrictor, not a vasodilator.",
            "d": "Systemic oxygen drop is not a primary mediator of GIT blood flow."
        },
        "relatedQuestions": ["25 (parasympathetic blood flow)"],
        "category": "Gastrointestinal Blood Supply",
        "difficulty": "Hard"
    },
    {
        "id": 4,
        "question": "Which of the following best describes the pathway of blood from the small intestine to the inferior vena cava?",
        "options": [
            "Intestinal capillaries  Hepatic artery  Liver sinusoids  Hepatic vein  IVC",
            "Intestinal capillaries  Superior Mesenteric Vein  Hepatic Portal Vein  Liver sinusoids  Hepatic Vein  IVC",
            "Intestinal capillaries  Inferior Mesenteric Artery  Hepatic Vein  IVC",
            "Intestinal capillaries  Splenic Vein  Aorta  IVC"
        ],
        "answer": 1,
        "correctAnswer": "Intestinal capillaries  Superior Mesenteric Vein  Hepatic Portal Vein  Liver sinusoids  Hepatic Vein  IVC",
        "explanation": "Blood from the small intestine flows through capillaries to the superior mesenteric vein, then to the hepatic portal vein, liver sinusoids, hepatic vein, and finally the inferior vena cava. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 255.",
        "whyNotOtherOptions": {
            "a": "Hepatic artery supplies arterial blood, not from intestinal capillaries.",
            "c": "Inferior mesenteric artery is arterial, not venous.",
            "d": "Splenic vein and aorta are not part of this pathway."
        },
        "relatedQuestions": ["1 (splanchnic circulation)"],
        "category": "Gastrointestinal Blood Supply",
        "difficulty": "Hard"
    },
    {
        "id": 5,
        "question": "The macropahagic cells (Kupffer cells) in the liver sinusoids serve a crucial protective function by:",
        "options": [
            "Producing bile for fat digestion.",
            "Secreting insulin and glucagon for metabolic control.",
            "Removing bacteria and other particles that enter the blood from the GIT.",
            "Storing glycogen for blood glucose regulation."
        ],
        "answer": 2,
        "correctAnswer": "Removing bacteria and other particles that enter the blood from the GIT.",
        "explanation": "Kupffer cells in liver sinusoids phagocytose bacteria and particles from GIT blood, protecting the systemic circulation. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 18, p. 610.",
        "whyNotOtherOptions": {
            "a": "Bile is produced by hepatocytes, not Kupffer cells.",
            "b": "Insulin/glucagon are secreted by pancreatic islets.",
            "d": "Glycogen storage is by hepatocytes."
        },
        "relatedQuestions": [],
        "category": "Gastrointestinal Blood Supply",
        "difficulty": "Medium"
    },
    {
        "id": 6,
        "question": "The hard palate is slightly keratinized and corrugated. What is the primary functional significance of this structure?",
        "options": [
            "To initiate the gag reflex",
            "To assist the tongue in chewing by providing a rough, abrasive surface",
            "To house the circumvallate papillae and taste buds",
            "To secrete saliva for moistening food"
        ],
        "answer": 1,
        "correctAnswer": "To assist the tongue in chewing by providing a rough, abrasive surface",
        "explanation": "The hard palates keratinized, corrugated surface aids the tongue in manipulating and chewing food by providing friction. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 7, p. 890.",
        "whyNotOtherOptions": {
            "a": "Gag reflex is triggered by the soft palate/pharynx.",
            "c": "Circumvallate papillae are on the tongue, not palate.",
            "d": "Saliva is secreted by salivary glands."
        },
        "relatedQuestions": ["27 (soft palate)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 7,
        "question": "A patient suffers damage to the hypoglossal nerve (CN XII), which controls the tongue muscles. Which function of the tongue would be most directly impaired?",
        "options": [
            "Perception of taste",
            "Gripping and repositioning food during chewing",
            "Secretion of lingual lipase",
            "Sensation of temperature"
        ],
        "answer": 1,
        "correctAnswer": "Gripping and repositioning food during chewing",
        "explanation": "The hypoglossal nerve (CN XII) controls tongue muscles, directly affecting movement for gripping and repositioning food during chewing. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 7, p. 900.",
        "whyNotOtherOptions": {
            "a": "Taste is mediated by CN VII and IX.",
            "c": "Lingual lipase is secreted by glands, not nerve-dependent.",
            "d": "Temperature sensation is via CN V."
        },
        "relatedQuestions": [],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 8,
        "question": "The filiform papillae on the tongue are unique because they:",
        "options": [
            "Contain the majority of taste buds.",
            "Give the tongue roughness and provide friction for manipulating food.",
            "Are located only in the 'V-shaped' row at the back of the tongue.",
            "Appear as red dots scattered across the tongue surface."
        ],
        "answer": 1,
        "correctAnswer": "Give the tongue roughness and provide friction for manipulating food.",
        "explanation": "Filiform papillae are non-taste bud bearing and provide roughness for food manipulation. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 540.",
        "whyNotOtherOptions": {
            "a": "Taste buds are in fungiform and circumvallate papillae.",
            "c": "V-shaped row contains circumvallate papillae.",
            "d": "Red dots are fungiform papillae."
        },
        "relatedQuestions": ["10 (sulcus terminalis)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 9,
        "question": "The parotid glands secrete saliva into the oral cavity through ducts that pierce which muscle?",
        "options": [
            "Masseter",
            "Buccinator",
            "Orbicularis oris",
            "Temporalis"
        ],
        "answer": 1,
        "correctAnswer": "Buccinator",
        "explanation": "The parotid glands Stensens duct pierces the buccinator muscle to open opposite the second maxillary molar. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 7, p. 895.",
        "whyNotOtherOptions": {
            "a": "Masseter is a chewing muscle, not pierced by ducts.",
            "c": "Orbicularis oris forms the lips, not pierced.",
            "d": "Temporalis is a chewing muscle, not involved."
        },
        "relatedQuestions": ["11 (salivary ducts)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 10,
        "question": "The sulcus terminalis is a landmark on the tongue that:",
        "options": [
            "Separates the anterior two-thirds (oral part) from the posterior third (pharyngeal part).",
            "Marks the location of the submandibular duct openings.",
            "Is covered with filiform papillae for friction.",
            "Is the site of the labial frenulum attachment."
        ],
        "answer": 0,
        "correctAnswer": "Separates the anterior two-thirds (oral part) from the posterior third (pharyngeal part).",
        "explanation": "The sulcus terminalis divides the tongue into anterior (oral) and posterior (pharyngeal) parts, marked by circumvallate papillae. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 7, p. 900.",
        "whyNotOtherOptions": {
            "b": "Submandibular duct opens at the lingual frenulum base.",
            "c": "Filiform papillae are widespread, not specific to sulcus.",
            "d": "Labial frenulum connects lips to gums."
        },
        "relatedQuestions": ["8 (filiform papillae)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 11,
        "question": "Which of the following pairs a salivary gland with its correct primary duct and opening?",
        "options": [
            "Parotid Gland / Wharton's Duct / Base of lingual frenulum",
            "Submandibular Gland / Rivinus's Ducts / Floor of the mouth",
            "Sublingual Gland / Stensen's Duct / Opposite the second maxillary molars",
            "Submandibular Gland / Wharton's Duct / Base of lingual frenulum"
        ],
        "answer": 3,
        "correctAnswer": "Submandibular Gland / Wharton's Duct / Base of lingual frenulum",
        "explanation": "The submandibular gland drains via Whartons duct, opening at the base of the lingual frenulum. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 7, p. 895.",
        "whyNotOtherOptions": {
            "a": "Parotid gland uses Stensens duct, not Whartons.",
            "b": "Submandibular gland uses Whartons duct, not Rivinuss.",
            "c": "Sublingual gland uses Rivinuss ducts, not Stensens."
        },
        "relatedQuestions": ["9 (parotid ducts)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 12,
        "question": "Saliva is characterized as a hypo-osmotic fluid with a slightly acidic pH. Which of its components is responsible for initiating the chemical digestion of carbohydrates?",
        "options": [
            "Mucin",
            "Lysozyme",
            "Salivary amylase",
            "Defensins"
        ],
        "answer": 2,
        "correctAnswer": "Salivary amylase",
        "explanation": "Salivary amylase (ptyalin) initiates carbohydrate digestion by breaking down starches into simpler sugars. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 545.",
        "whyNotOtherOptions": {
            "a": "Mucin lubricates food, not digests carbohydrates.",
            "b": "Lysozyme has antibacterial properties.",
            "d": "Defensins are antimicrobial peptides."
        },
        "relatedQuestions": ["29 (saliva components)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 13,
        "question": "The daily secretion of saliva is primarily controlled by:",
        "options": [
            "The hormonal effects of gastrin and secretin.",
            "Parasympathetic nervous stimulation.",
            "Sympathetic nervous stimulation, which increases output.",
            "The concentration of electrolytes in the blood."
        ],
        "answer": 1,
        "correctAnswer": "Parasympathetic nervous stimulation.",
        "explanation": "Parasympathetic stimulation (via CN VII and IX) primarily controls saliva secretion, increasing output for digestion. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 7, p. 895.",
        "whyNotOtherOptions": {
            "a": "Gastrin and secretin regulate GI digestion, not saliva.",
            "c": "Sympathetic stimulation reduces saliva output.",
            "d": "Electrolyte concentration is not a primary regulator."
        },
        "relatedQuestions": [],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 14,
        "question": "The orbicularis oris and buccinator muscles form the core of the lips and cheeks, respectively. Their coordinated action during eating is essential for:",
        "options": [
            "Secreting saliva.",
            "Perceiving the taste of food.",
            "Forming a bolus and keeping food between the teeth.",
            "Initiating the swallowing reflex."
        ],
        "answer": 2,
        "correctAnswer": "Forming a bolus and keeping food between the teeth.",
        "explanation": "The orbicularis oris and buccinator muscles work together to form a bolus and keep food between the teeth during mastication. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 7, p. 885.",
        "whyNotOtherOptions": {
            "a": "Saliva is secreted by glands, not muscles.",
            "b": "Taste is mediated by taste buds and cranial nerves.",
            "d": "Swallowing reflex involves pharyngeal muscles."
        },
        "relatedQuestions": ["9 (buccinator)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 15,
        "question": "The labial frenulum is defined as the:",
        "options": [
            "Fold that connects the tongue to the floor of the mouth.",
            "Median fold that joins the internal aspect of each lip to the gum.",
            "Groove that separates the hard and soft palates.",
            "Opening of the parotid duct."
        ],
        "answer": 1,
        "correctAnswer": "Median fold that joins the internal aspect of each lip to the gum.",
        "explanation": "The labial frenulum is a midline fold connecting the internal lip to the gum. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 7, p. 890.",
        "whyNotOtherOptions": {
            "a": "The tongue is connected by the lingual frenulum.",
            "c": "Hard and soft palates are separated by a junction, not a groove.",
            "d": "Parotid duct opens opposite the second maxillary molar."
        },
        "relatedQuestions": ["10 (sulcus terminalis)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 16,
        "question": "A child has 20 primary (deciduous) teeth. The dental formula for this set lacks which type of tooth found in the permanent set?",
        "options": [
            "Incisors and Canines",
            "Canines and Molars",
            "Premolars",
            "Molars"
        ],
        "answer": 2,
        "correctAnswer": "Premolars",
        "explanation": "The primary dentition lacks premolars, which are present in the permanent dentition. The primary formula is 2I, 1C, 2M per quadrant. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 7, p. 910.",
        "whyNotOtherOptions": {
            "a": "Incisors and canines are present in primary teeth.",
            "b": "Canines and molars are present in primary teeth.",
            "d": "Molars are present in primary teeth."
        },
        "relatedQuestions": ["17 (permanent dentition)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 17,
        "question": "The permanent dentition consists of 32 teeth. The dental formula 2I, 1C, 2PM, 3M per quadrant indicates the presence of:",
        "options": [
            "8 incisors, 4 canines, 12 premolars, and 8 molars in the full mouth.",
            "4 incisors, 2 canines, 4 premolars, and 6 molars in the full mouth.",
            "8 incisors, 4 canines, 8 premolars, and 12 molars in the full mouth.",
            "4 incisors, 4 canines, 8 premolars, and 8 molars in the full mouth."
        ],
        "answer": 2,
        "correctAnswer": "8 incisors, 4 canines, 8 premolars, and 12 molars in the full mouth.",
        "explanation": "The dental formula 2I, 1C, 2PM, 3M per quadrant means 2 incisors, 1 canine, 2 premolars, 3 molars per quadrant. Across four quadrants: 8 incisors, 4 canines, 8 premolars, 12 molars. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 7, p. 910.",
        "whyNotOtherOptions": {
            "a": "Incorrect; premolars are 8, not 12; molars are 12, not 8.",
            "b": "Incorrect; underestimates all tooth types.",
            "d": "Incorrect; underestimates incisors and molars."
        },
        "relatedQuestions": ["16 (primary dentition)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 18,
        "question": "The hardest substance in the human body, which encapsulates the crown of the tooth, is:",
        "options": [
            "Dentin",
            "Cementum",
            "Enamel",
            "Pulp"
        ],
        "answer": 2,
        "correctAnswer": "Enamel",
        "explanation": "Enamel, a highly mineralized substance, covers the tooth crown and is the hardest substance in the body. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 530.",
        "whyNotOtherOptions": {
            "a": "Dentin is hard but less than enamel.",
            "b": "Cementum covers the root, not the crown.",
            "d": "Pulp is soft connective tissue."
        },
        "relatedQuestions": ["20 (tooth structure)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 19,
        "question": "The periodontal ligament has a crucial function in:",
        "options": [
            "Secreting the brittle enamel material.",
            "Forming a gomphosis joint to anchor the tooth in the jawbone alveolus.",
            "Containing the blood vessels and nerves of the tooth.",
            "Producing dentin throughout life."
        ],
        "answer": 1,
        "correctAnswer": "Forming a gomphosis joint to anchor the tooth in the jawbone alveolus.",
        "explanation": "The periodontal ligament forms a gomphosis joint, anchoring the tooth to the jawbone alveolus. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 7, p. 910.",
        "whyNotOtherOptions": {
            "a": "Enamel is secreted by ameloblasts, not the ligament.",
            "c": "Blood vessels and nerves are in the pulp.",
            "d": "Dentin is produced by odontoblasts."
        },
        "relatedQuestions": ["30 (gomphosis joint)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 20,
        "question": "Which structure of the tooth contains connective tissue, blood vessels, and nerves?",
        "options": [
            "Dentin",
            "Cementum",
            "Enamel",
            "Pulp"
        ],
        "answer": 3,
        "correctAnswer": "Pulp",
        "explanation": "The pulp contains connective tissue, blood vessels, and nerves, providing nourishment and sensation to the tooth. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 530.",
        "whyNotOtherOptions": {
            "a": "Dentin is a calcified tissue.",
            "b": "Cementum is a hard root covering.",
            "c": "Enamel is a mineralized crown covering."
        },
        "relatedQuestions": ["18 (enamel)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 21,
        "question": "Odontoblasts are cells responsible for:",
        "options": [
            "Secreting and maintaining the enamel layer.",
            "Secreting and maintaining the dentin throughout life.",
            "Anchoring the tooth via the periodontal ligament.",
            "Resorbing the roots of deciduous teeth."
        ],
        "answer": 1,
        "correctAnswer": "Secreting and maintaining the dentin throughout life.",
        "explanation": "Odontoblasts secrete and maintain dentin, the calcified tissue beneath enamel, throughout life. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 530.",
        "whyNotOtherOptions": {
            "a": "Enamel is secreted by ameloblasts.",
            "c": "Periodontal ligament anchors teeth, not odontoblasts.",
            "d": "Root resorption is by odontoclasts."
        },
        "relatedQuestions": ["18 (enamel)", "19 (periodontal ligament)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 22,
        "question": "The root canal is an extension of the pulp cavity that ends at the:",
        "options": [
            "Cementum",
            "Gingival sulcus",
            "Apical foramen",
            "Crown"
        ],
        "answer": 2,
        "correctAnswer": "Apical foramen",
        "explanation": "The root canal extends from the pulp cavity to the apical foramen, where nerves and vessels enter/exit the tooth. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 530.",
        "whyNotOtherOptions": {
            "a": "Cementum covers the root, not the canal end.",
            "b": "Gingival sulcus is the space between tooth and gum.",
            "d": "Crown is above the pulp cavity."
        },
        "relatedQuestions": ["20 (pulp)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 23,
        "question": "The initial stage of tooth decay, dental caries, is primarily caused by:",
        "options": [
            "Mechanical abrasion from hard foods.",
            "Bacterial production of acid that demineralizes enamel and dentin.",
            "An autoimmune response attacking the periodontal ligament.",
            "A deficiency of fluoride in the drinking water."
        ],
        "answer": 1,
        "correctAnswer": "Bacterial production of acid that demineralizes enamel and dentin.",
        "explanation": "Dental caries result from bacterial acid production (e.g., Streptococcus mutans) demineralizing enamel and dentin. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 535.",
        "whyNotOtherOptions": {
            "a": "Mechanical abrasion is not the primary cause.",
            "c": "Autoimmune responses do not cause caries.",
            "d": "Fluoride deficiency increases risk but is not the primary cause."
        },
        "relatedQuestions": [],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 24,
        "question": "Gingivitis, an inflammation of the gums, is often initiated by:",
        "options": [
            "The exposure of dentin due to enamel wear.",
            "The accumulation of calculus (tartar) that disrupts the seal between the gingivae and teeth.",
            "A viral infection of the pulp cavity.",
            "Excessive secretion of saliva."
        ],
        "answer": 1,
        "correctAnswer": "The accumulation of calculus (tartar) that disrupts the seal between the gingivae and teeth.",
        "explanation": "Gingivitis is often caused by calculus accumulation, which disrupts the gingival seal and promotes inflammation. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 7, p. 915.",
        "whyNotOtherOptions": {
            "a": "Dentin exposure is related to caries, not gingivitis.",
            "c": "Viral infections are not a primary cause of gingivitis.",
            "d": "Excessive saliva does not cause gingivitis."
        },
        "relatedQuestions": [],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 25,
        "question": "Which of the following is a direct effect of parasympathetic nervous system activation on gastrointestinal blood flow?",
        "options": [
            "Decreased blood flow via vasoconstriction",
            "Increased blood flow via vasodilation",
            "No change in blood flow, as it is only hormonally regulated",
            "Shunting of blood away from the mucosa to the muscularis"
        ],
        "answer": 1,
        "correctAnswer": "Increased blood flow via vasodilation",
        "explanation": "Parasympathetic activation promotes vasodilation, increasing GI blood flow to support digestion. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 260.",
        "whyNotOtherOptions": {
            "a": "Vasoconstriction is sympathetic, not parasympathetic.",
            "c": "Blood flow is neurally and hormonally regulated.",
            "d": "Parasympathetic does not shunt blood away from mucosa."
        },
        "relatedQuestions": ["3 (vasodilation mediators)"],
        "category": "Gastrointestinal Blood Supply",
        "difficulty": "Hard"
    },
    {
        "id": 26,
        "question": "Local metabolic control of gut blood flow would cause an increase in perfusion in response to:",
        "options": [
            "An increase in local O2 concentration.",
            "A decrease in metabolic demand.",
            "A decrease in local O2 concentration.",
            "Sympathetic nervous stimulation."
        ],
        "answer": 2,
        "correctAnswer": "A decrease in local O2 concentration.",
        "explanation": "Decreased local O2 concentration signals increased metabolic demand, triggering vasodilation to increase gut perfusion. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 260.",
        "whyNotOtherOptions": {
            "a": "High O2 reduces perfusion need.",
            "b": "Decreased demand reduces perfusion.",
            "d": "Sympathetic stimulation causes vasoconstriction."
        },
        "relatedQuestions": ["3 (vasodilation mediators)"],
        "category": "Gastrointestinal Blood Supply",
        "difficulty": "Hard"
    },
    {
        "id": 27,
        "question": "The soft palate, a mobile fold of skeletal muscle, is critically important during which process?",
        "options": [
            "Mastication",
            "Taste perception",
            "Speech",
            "Swallowing (by closing off the nasopharynx)"
        ],
        "answer": 3,
        "correctAnswer": "Swallowing (by closing off the nasopharynx)",
        "explanation": "The soft palate elevates during swallowing to close off the nasopharynx, preventing food from entering the nasal cavity. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 7, p. 890.",
        "whyNotOtherOptions": {
            "a": "Mastication involves teeth and tongue.",
            "b": "Taste perception is by tongue papillae.",
            "c": "Speech is aided but not critically dependent on soft palate."
        },
        "relatedQuestions": ["6 (hard palate)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 28,
        "question": "The sublingual glands drain directly into the floor of the mouth via multiple small ducts. These are known as:",
        "options": [
            "Stensen's ducts",
            "Wharton's ducts",
            "Rivinus's ducts",
            "The common bile duct"
        ],
        "answer": 2,
        "correctAnswer": "Rivinus's ducts",
        "explanation": "Sublingual glands drain via multiple small Rivinuss ducts into the floor of the mouth. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 7, p. 895.",
        "whyNotOtherOptions": {
            "a": "Stensens ducts are for the parotid gland.",
            "b": "Whartons ducts are for the submandibular gland.",
            "d": "Common bile duct is unrelated to saliva."
        },
        "relatedQuestions": ["11 (salivary ducts)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 29,
        "question": "The component of saliva that plays a role in immune defense by lysing bacteria is:",
        "options": [
            "Mucin",
            "Salivary amylase",
            "Lysozyme",
            "IgA"
        ],
        "answer": 2,
        "correctAnswer": "Lysozyme",
        "explanation": "Lysozyme in saliva lyses bacteria, contributing to immune defense. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 545.",
        "whyNotOtherOptions": {
            "a": "Mucin lubricates and protects, not lyses bacteria.",
            "b": "Salivary amylase digests carbohydrates.",
            "d": "IgA provides immune defense but does not lyse bacteria."
        },
        "relatedQuestions": ["12 (salivary amylase)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 30,
        "question": "A tooth is held firmly in its bony socket by the periodontal ligament, which forms a specific type of joint classified as a:",
        "options": [
            "Suture",
            "Syndesmosis",
            "Gomphosis",
            "Synchondrosis"
        ],
        "answer": 2,
        "correctAnswer": "Gomphosis",
        "explanation": "The periodontal ligament forms a gomphosis joint, anchoring the tooth in its bony socket. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 7, p. 910.",
        "whyNotOtherOptions": {
            "a": "Sutures are cranial joints.",
            "b": "Syndesmosis joints connect bones via ligaments (e.g., tibia-fibula).",
            "d": "Synchondrosis joints are cartilaginous."
        },
        "relatedQuestions": ["19 (periodontal ligament)"],
        "category": "Oral Structures",
        "difficulty": "Medium"
    },
    {
        "id": 1,
        "question": "A patient presents with a condition that results in the complete degeneration of the myenteric plexus. Which GI function is most directly and severely affected?",
        "options": [
            "Secretion of enzymes from gastric glands",
            "Motility and peristaltic movements of the gut",
            "Hormonal release from enteroendocrine cells",
            "Absorption of nutrients in the small intestine"
        ],
        "answer": 1,
        "correctAnswer": "Motility and peristaltic movements of the gut",
        "explanation": "The myenteric plexus is explicitly stated to control motility of the gut. Its degeneration would severely impair peristalsis and gut movement. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Enzyme secretion is controlled by the submucosal plexus and hormones.",
            "c": "Hormonal release is by enteroendocrine cells, not the myenteric plexus.",
            "d": "Nutrient absorption is primarily an epithelial function."
        },
        "relatedQuestions": ["16 (myenteric plexus function)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 2,
        "question": "During a stressful event involving strong sympathetic nervous system activation, which of the following GI outcomes would be expected?",
        "options": [
            "Increased gastric emptying and enhanced pancreatic secretion",
            "A total blockade of gut motility and inhibited secretions",
            "Initiation of the defecation reflex via the sacral parasympathetic nerves",
            "Potent contraction of the gallbladder via the vagus nerve"
        ],
        "answer": 1,
        "correctAnswer": "A total blockade of gut motility and inhibited secretions",
        "explanation": "The notes state that strong sympathetic stimulation can 'totally block GIT motility' and inhibit secretions. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Sympathetic activation inhibits, not enhances, motility and secretion.",
            "c": "Defecation reflex is parasympathetic, not sympathetic.",
            "d": "Gallbladder contraction is mediated by CCK, not vagus nerve."
        },
        "relatedQuestions": ["10 (norepinephrine effect)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 3,
        "question": "The entero-gastric reflex is an example of a reflex that:",
        "options": [
            "Occurs entirely within the enteric nervous system.",
            "Arises from the gut, goes to the sympathetic ganglia, and then back to the GI tract.",
            "Travels from the gut to the spinal cord and then back to the gut.",
            "Is primarily mediated by the hormone cholecystokinin (CCK)."
        ],
        "answer": 1,
        "correctAnswer": "Arises from the gut, goes to the sympathetic ganglia, and then back to the GI tract.",
        "explanation": "The notes classify the entero-gastric reflex under 'Reflexes that arise from the gut go to the sympathetic ganglia and then back to the GI-tract.' Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Entero-gastric reflex involves extrinsic sympathetic ganglia.",
            "c": "Spinal cord reflexes are long reflexes, not entero-gastric.",
            "d": "CCK is a hormone, not a reflex mediator."
        },
        "relatedQuestions": ["12 (colono-ileal reflex)"],
        "category": "Gastrointestinal System",
        "difficulty": "Hard"
    },
    {
        "id": 4,
        "question": "A meal rich in fatty acids enters the duodenum. Which of the following coordinated responses is most likely to occur?",
        "options": [
            "Secretin release inhibits pancreatic bicarbonate secretion.",
            "CCK release stimulates gallbladder contraction and inhibits stomach motility.",
            "GIP release increases gastric motor activity and acid secretion.",
            "Sympathetic nerve activity increases to enhance digestion and absorption."
        ],
        "answer": 1,
        "correctAnswer": "CCK release stimulates gallbladder contraction and inhibits stomach motility.",
        "explanation": "CCK is secreted in response to fat, contracts the gallbladder, and inhibits stomach motility to regulate digestion. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 580.",
        "whyNotOtherOptions": {
            "a": "Secretin stimulates, not inhibits, bicarbonate secretion.",
            "c": "GIP inhibits gastric motility, not increases it.",
            "d": "Sympathetic activity inhibits digestion."
        },
        "relatedQuestions": ["8 (GIP)", "13 (secretin)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 5,
        "question": "The sacral parasympathetic nerves (S2-S4) are most critical for which specific GI function?",
        "options": [
            "Voluntary control of mastication",
            "The defecation reflexes of the distal large intestine",
            "The peristaltic waves of the entire small intestine",
            "Secretory activities of the stomach and pancreas"
        ],
        "answer": 1,
        "correctAnswer": "The defecation reflexes of the distal large intestine",
        "explanation": "The sacral parasympathetic fibers 'function in the defecation reflexes' for the distal colon. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 275.",
        "whyNotOtherOptions": {
            "a": "Mastication is controlled by somatic nerves (e.g., trigeminal).",
            "c": "Small intestine peristalsis is vagal and ENS-driven.",
            "d": "Stomach/pancreas secretions are vagal."
        },
        "relatedQuestions": ["11 (vagus nerve)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 6,
        "question": "Which of the following best describes the anatomical pathway of sympathetic innervation to the GIT?",
        "options": [
            "Preganglionic fibers from T5-L2  Enteric Nervous System  Postganglionic fibers release ACh",
            "Preganglionic fibers from the brainstem  Vagus nerve  Synapse in the gut wall",
            "Preganglionic fibers from T5-L2  Sympathetic chains  Outlying ganglia (e.g., celiac)  Postganglionic fibers to ENS",
            "Preganglionic fibers from S2-S4  Pelvic nerves  Directly innervate smooth muscle"
        ],
        "answer": 2,
        "correctAnswer": "Preganglionic fibers from T5-L2  Sympathetic chains  Outlying ganglia (e.g., celiac)  Postganglionic fibers to ENS",
        "explanation": "This is the precise pathway described for sympathetic innervation to the GI tract. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Sympathetic postganglionic fibers release norepinephrine, not ACh.",
            "b": "Vagus nerve is parasympathetic, not sympathetic.",
            "d": "S2-S4 is parasympathetic, not sympathetic."
        },
        "relatedQuestions": ["2 (sympathetic effects)"],
        "category": "Gastrointestinal System",
        "difficulty": "Hard"
    },
    {
        "id": 7,
        "question": "An afferent nerve fiber that detects excessive distension of the stomach and has its cell body located in the dorsal root ganglion of the spinal cord is classified as:",
        "options": [
            "An intrinsic sensory neuron of the ENS.",
            "A parasympathetic efferent fiber.",
            "A somatic motor fiber.",
            "An extrinsic spinal afferent fiber."
        ],
        "answer": 3,
        "correctAnswer": "An extrinsic spinal afferent fiber.",
        "explanation": "Afferent fibers with cell bodies in the dorsal root ganglia are extrinsic spinal afferents, detecting stimuli like stomach distension. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Intrinsic ENS neurons have cell bodies in the gut wall.",
            "b": "Parasympathetic fibers are efferent, not afferent.",
            "c": "Somatic motor fibers control skeletal muscle."
        },
        "relatedQuestions": [],
        "category": "Gastrointestinal System",
        "difficulty": "Hard"
    },
    {
        "id": 8,
        "question": "The primary physiological role of Gastric Inhibitory Peptide (GIP), as described in the notes, is to:",
        "options": [
            "Stimulate the secretion of acidic gastric juice.",
            "Inhibit the motor activity of the stomach in response to intestinal fat/carbs.",
            "Contract the gallbladder to expel bile.",
            "Increase pancreatic bicarbonate secretion in response to acid."
        ],
        "answer": 1,
        "correctAnswer": "Inhibit the motor activity of the stomach in response to intestinal fat/carbs.",
        "explanation": "GIP is defined as being secreted in response to fat/carbs and inhibiting stomach motor activity. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 580.",
        "whyNotOtherOptions": {
            "a": "GIP inhibits, not stimulates, gastric acid.",
            "c": "Gallbladder contraction is by CCK.",
            "d": "Bicarbonate secretion is by secretin."
        },
        "relatedQuestions": ["4 (CCK)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 9,
        "question": "Which receptor type in the GI tract would be primarily responsible for initiating a reflex to dilute a hypertonic meal?",
        "options": [
            "Mechanoreceptors",
            "Chemoreceptors (specifically for osmolarity)",
            "Thermoreceptors",
            "Nociceptors"
        ],
        "answer": 1,
        "correctAnswer": "Chemoreceptors (specifically for osmolarity)",
        "explanation": "Chemoreceptors are explicitly stated to respond to osmolarity, initiating reflexes to dilute hypertonic meals. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Mechanoreceptors detect stretch/distension.",
            "c": "Thermoreceptors detect temperature, not osmolarity.",
            "d": "Nociceptors detect pain, not osmolarity."
        },
        "relatedQuestions": [],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 10,
        "question": "The neurotransmitter Nor-epinephrine, when released by sympathetic postganglionic fibers in the GIT, typically has what effect?",
        "options": [
            "Excitatory, enhancing peristalsis",
            "Inhibitory, decreasing GI motility and secretions",
            "Excitatory, stimulating hormone release",
            "No direct effect, as it is only a circulating hormone"
        ],
        "answer": 1,
        "correctAnswer": "Inhibitory, decreasing GI motility and secretions",
        "explanation": "NE is listed as an inhibitory neurotransmitter, and sympathetic stimulation generally inhibits GI function. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Norepinephrine inhibits, not enhances, peristalsis.",
            "c": "Norepinephrine does not stimulate hormone release.",
            "d": "Norepinephrine is a neurotransmitter, not just a hormone."
        },
        "relatedQuestions": ["2 (sympathetic effects)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 11,
        "question": "The vagus nerve (cranial parasympathetic) provides extensive innervation to all of the following structures EXCEPT the:",
        "options": [
            "Stomach",
            "Pancreas",
            "First half of the large intestine",
            "Distal half of the large intestine (sigmoidal, rectal regions)"
        ],
        "answer": 3,
        "correctAnswer": "Distal half of the large intestine (sigmoidal, rectal regions)",
        "explanation": "The distal half of the large intestine is innervated by the sacral parasympathetic, not the cranial (vagus). Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "The stomach is vagally innervated.",
            "b": "The pancreas receives vagal innervation.",
            "c": "The first half of the large intestine is vagally innervated."
        },
        "relatedQuestions": ["5 (sacral parasympathetic)"],
        "category": "Gastrointestinal System",
        "difficulty": "Hard"
    },
    {
        "id": 12,
        "question": "The colono-ileal reflex, which inhibits the emptying of ileal contents into the colon, is an example of which category of GI reflex?",
        "options": [
            "Reflexes entirely within the ENS",
            "Reflexes from the gut to the prevertebral ganglia and back",
            "Reflexes from the gut to the spinal cord/brainstem and back",
            "A reflex mediated solely by the hormone secretin"
        ],
        "answer": 1,
        "correctAnswer": "Reflexes from the gut to the prevertebral ganglia and back",
        "explanation": "It is listed as an example of a reflex from the gut to the prevertebral ganglia and back. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "ENS reflexes are short reflexes, not involving ganglia.",
            "c": "Spinal cord/brainstem reflexes are long reflexes.",
            "d": "Secretin is a hormone, not a reflex mediator."
        },
        "relatedQuestions": ["3 (entero-gastric reflex)"],
        "category": "Gastrointestinal System",
        "difficulty": "Hard"
    },
    {
        "id": 13,
        "question": "Which of the following is a direct effect of the hormone Secretin?",
        "options": [
            "Stimulation of gallbladder contraction",
            "Inhibition of gastric motility",
            "Increase in pancreatic bicarbonate secretion",
            "Facilitation of fat absorption"
        ],
        "answer": 2,
        "correctAnswer": "Increase in pancreatic bicarbonate secretion",
        "explanation": "Secretin's primary role is to increase pancreatic bicarbonate secretion in response to acid. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 580.",
        "whyNotOtherOptions": {
            "a": "Gallbladder contraction is by CCK.",
            "b": "Gastric motility inhibition is a secondary effect.",
            "d": "Fat absorption is facilitated by bile."
        },
        "relatedQuestions": ["4 (CCK)", "19 (secretin stimulus)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 14,
        "question": "The postganglionic neurons of the parasympathetic nervous system for the GIT are located in the:",
        "options": [
            "Sympathetic chain ganglia",
            "Dorsal root ganglia",
            "Enteric Nervous System (ENS)",
            "Spinal cord between T5 and L2"
        ],
        "answer": 2,
        "correctAnswer": "Enteric Nervous System (ENS)",
        "explanation": "The notes state, 'The post ganglionic neurons of the PNS are located in the ENS.' Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Sympathetic chain ganglia are for sympathetic neurons.",
            "b": "Dorsal root ganglia contain sensory neurons.",
            "d": "Spinal cord T5-L2 is for sympathetic preganglionic neurons."
        },
        "relatedQuestions": ["11 (vagus nerve)"],
        "category": "Gastrointestinal System",
        "difficulty": "Hard"
    },
    {
        "id": 15,
        "question": "A drug that acts as a cholinergic agonist (mimics Acetylcholine) would be expected to:",
        "options": [
            "Decrease GI motility and secretions.",
            "Have no effect on the GI tract.",
            "Increase GI motility and secretions.",
            "Selectively inhibit pain signals from the gut."
        ],
        "answer": 2,
        "correctAnswer": "Increase GI motility and secretions.",
        "explanation": "Acetylcholine is listed as an excitatory neurotransmitter in the ENS, increasing motility and secretions. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Acetylcholine is excitatory, not inhibitory.",
            "b": "Acetylcholine has significant GI effects.",
            "d": "Cholinergic agonists do not selectively inhibit pain."
        },
        "relatedQuestions": [],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 16,
        "question": "Which of the following is a key functional difference between the submucosal plexus and the myenteric plexus?",
        "options": [
            "The submucosal plexus controls motility, while the myenteric plexus controls secretions.",
            "The submucosal plexus contains sympathetic fibers, while the myenteric plexus contains parasympathetic fibers.",
            "The submucosal plexus controls secretory activities, while the myenteric plexus controls motility.",
            "The submucosal plexus is extrinsic, while the myenteric plexus is intrinsic."
        ],
        "answer": 2,
        "correctAnswer": "The submucosal plexus controls secretory activities, while the myenteric plexus controls motility.",
        "explanation": "The submucosal plexus controls secretory activities, and the myenteric plexus controls motility. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "The roles are reversed; submucosal controls secretions, myenteric controls motility.",
            "b": "Both plexuses contain sympathetic and parasympathetic fibers.",
            "d": "Both plexuses are intrinsic to the ENS."
        },
        "relatedQuestions": ["1 (myenteric plexus)", "12 (colono-ileal reflex)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 17,
        "question": "The physiological purpose of having sympathetic innervation be 'more extensive in the oral and anal areas' is most likely related to:",
        "options": [
            "Enhancing digestion and absorption in the small intestine.",
            "Greater conscious control over the entry and exit points of the GIT.",
            "Stimulating hormone release from the stomach and duodenum.",
            "Increasing blood flow to the salivary glands."
        ],
        "answer": 1,
        "correctAnswer": "Greater conscious control over the entry and exit points of the GIT.",
        "explanation": "This allows for greater autonomic control over swallowing (oral) and defecation (anal), which have voluntary components. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 240, 275.",
        "whyNotOtherOptions": {
            "a": "Sympathetic innervation inhibits digestion/absorption.",
            "c": "Hormone release is not a sympathetic function.",
            "d": "Salivary gland blood flow is parasympathetically regulated."
        },
        "relatedQuestions": ["5 (sacral parasympathetic)"],
        "category": "Gastrointestinal System",
        "difficulty": "Hard"
    },
    {
        "id": 18,
        "question": "A reflex that is initiated by irritation of the gut mucosa and is processed entirely within the gut wall itself is classified as a(n):",
        "options": [
            "Long reflex involving the spinal cord.",
            "Short reflex within the ENS.",
            "Reflex to the prevertebral ganglia.",
            "Hormonally-mediated reflex."
        ],
        "answer": 1,
        "correctAnswer": "Short reflex within the ENS.",
        "explanation": "Reflexes entirely within the ENS are short reflexes, processing stimuli like mucosal irritation locally. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Long reflexes involve the CNS.",
            "c": "Prevertebral ganglia reflexes are extrinsic.",
            "d": "Hormonal reflexes involve endocrine signals."
        },
        "relatedQuestions": ["3 (entero-gastric reflex)", "12 (colono-ileal reflex)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 19,
        "question": "The primary stimulus for the release of secretin from the duodenum is:",
        "options": [
            "The presence of fatty food.",
            "Carbohydrates in the meal.",
            "Acidic gastric juice from the stomach.",
            "Distension of the intestinal wall."
        ],
        "answer": 2,
        "correctAnswer": "Acidic gastric juice from the stomach.",
        "explanation": "Secretin is secreted 'in response to acidic gastric juice' to stimulate pancreatic bicarbonate secretion. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 580.",
        "whyNotOtherOptions": {
            "a": "Fatty food stimulates CCK.",
            "b": "Carbohydrates primarily stimulate GIP.",
            "d": "Distension triggers mechanoreceptors, not secretin."
        },
        "relatedQuestions": ["4 (CCK)", "13 (secretin)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 20,
        "question": "Which of the following lists contains neurotransmitters that are generally considered inhibitory in the enteric nervous system, based on the notes?",
        "options": [
            "Acetylcholine and Substance-P",
            "Nitric Oxide and Nor-epinephrine",
            "CCK and Dopamine",
            "Serotonin and Bombesin"
        ],
        "answer": 1,
        "correctAnswer": "Nitric Oxide and Nor-epinephrine",
        "explanation": "Nor-epinephrine is explicitly inhibitory. Nitric Oxide is also a common inhibitory neurotransmitter in the ENS, relaxing smooth muscle. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Acetylcholine and Substance-P are excitatory.",
            "c": "CCK is a hormone, not a neurotransmitter.",
            "d": "Serotonin and Bombesin are excitatory in the ENS."
        },
        "relatedQuestions": ["10 (norepinephrine)"],
        "category": "Gastrointestinal System",
        "difficulty": "Hard"
    },
    {
        "id": 31,
        "question": "Which of the following structures is primarily responsible for the secretion of intrinsic factor in the stomach?",
        "options": [
            "Chief cells",
            "Parietal cells",
            "Enteroendocrine cells",
            "Goblet cells"
        ],
        "answer": 1,
        "correctAnswer": "Parietal cells",
        "explanation": "Parietal cells in the gastric mucosa secrete intrinsic factor, essential for vitamin B12 absorption in the ileum. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 565.",
        "whyNotOtherOptions": {
            "a": "Chief cells secrete pepsinogen.",
            "c": "Enteroendocrine cells secrete hormones like gastrin.",
            "d": "Goblet cells secrete mucus, mainly in the intestines."
        },
        "relatedQuestions": ["8 (GIP)", "13 (secretin)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 32,
        "question": "A lesion in the celiac ganglion would most likely affect which gastrointestinal function?",
        "options": [
            "Voluntary swallowing in the esophagus",
            "Peristalsis in the distal colon",
            "Inhibition of gastric motility",
            "Defecation reflex in the rectum"
        ],
        "answer": 2,
        "correctAnswer": "Inhibition of gastric motility",
        "explanation": "The celiac ganglion provides sympathetic innervation to the stomach and upper GI tract, primarily inhibiting motility. A lesion would disrupt this inhibitory control. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Swallowing is controlled by somatic and vagal nerves.",
            "b": "Distal colon peristalsis is primarily sacral parasympathetic.",
            "d": "Defecation reflex is sacral parasympathetic."
        },
        "relatedQuestions": ["6 (sympathetic innervation)", "10 (norepinephrine)"],
        "category": "Gastrointestinal System",
        "difficulty": "Hard"
    },
    {
        "id": 33,
        "question": "Which of the following is a primary function of motilin in the gastrointestinal tract?",
        "options": [
            "Stimulating pancreatic enzyme secretion",
            "Initiating migrating motor complexes (MMCs) during fasting",
            "Inhibiting bicarbonate secretion in the duodenum",
            "Promoting fat absorption in the ileum"
        ],
        "answer": 1,
        "correctAnswer": "Initiating migrating motor complexes (MMCs) during fasting",
        "explanation": "Motilin, released by enteroendocrine cells, initiates migrating motor complexes (MMCs) to clear residual material from the GI tract during fasting. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 580.",
        "whyNotOtherOptions": {
            "a": "Pancreatic enzyme secretion is stimulated by CCK.",
            "c": "Bicarbonate secretion is promoted by secretin.",
            "d": "Fat absorption is facilitated by bile, not motilin."
        },
        "relatedQuestions": ["4 (CCK)", "13 (secretin)"],
        "category": "Gastrointestinal System",
        "difficulty": "Hard"
    },
    {
        "id": 34,
        "question": "The presence of Peyers patches in the submucosa is a distinguishing feature of which GI segment?",
        "options": [
            "Duodenum",
            "Jejunum",
            "Ileum",
            "Colon"
        ],
        "answer": 2,
        "correctAnswer": "Ileum",
        "explanation": "Peyers patches, lymphoid nodules in the submucosa, are characteristic of the ileum and support immune function. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 575.",
        "whyNotOtherOptions": {
            "a": "Duodenum has Brunners glands, not Peyers patches.",
            "b": "Jejunum lacks prominent lymphoid nodules.",
            "d": "Colon has no Peyers patches."
        },
        "relatedQuestions": [],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 35,
        "question": "A drug that blocks muscarinic receptors in the GI tract would most likely result in:",
        "options": [
            "Increased peristalsis and secretions",
            "Decreased motility and reduced secretions",
            "Enhanced gallbladder contraction",
            "Increased gastric acid production"
        ],
        "answer": 1,
        "correctAnswer": "Decreased motility and reduced secretions",
        "explanation": "Muscarinic receptors mediate parasympathetic (acetylcholine) effects in the GI tract, promoting motility and secretions. Blocking them reduces these functions. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Blocking muscarinic receptors inhibits, not increases, motility/secretions.",
            "c": "Gallbladder contraction is primarily CCK-driven.",
            "d": "Gastric acid is regulated by parietal cells, not primarily muscarinic."
        },
        "relatedQuestions": ["15 (cholinergic agonist)"],
        "category": "Gastrointestinal System",
        "difficulty": "Hard"
    },
    {
        "id": 36,
        "question": "Which of the following best describes the role of the interstitial cells of Cajal in the GI tract?",
        "options": [
            "Secreting digestive enzymes",
            "Acting as pacemaker cells for peristaltic contractions",
            "Producing mucus for mucosal protection",
            "Regulating blood flow to the mucosa"
        ],
        "answer": 1,
        "correctAnswer": "Acting as pacemaker cells for peristaltic contractions",
        "explanation": "Interstitial cells of Cajal generate electrical slow waves, acting as pacemaker cells to coordinate peristaltic contractions in the GI tract. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Enzymes are secreted by exocrine cells (e.g., pancreas).",
            "c": "Mucus is produced by goblet cells.",
            "d": "Blood flow is regulated by the submucosal plexus."
        },
        "relatedQuestions": ["1 (myenteric plexus)"],
        "category": "Gastrointestinal System",
        "difficulty": "Hard"
    },
    {
        "id": 37,
        "question": "The gastrocolic reflex, which increases colon motility after a meal, is primarily mediated by:",
        "options": [
            "Sympathetic innervation via the celiac ganglion",
            "Hormones like gastrin and CCK",
            "Short reflexes within the ENS",
            "Somatic motor neurons"
        ],
        "answer": 1,
        "correctAnswer": "Hormones like gastrin and CCK",
        "explanation": "The gastrocolic reflex is triggered by gastric distension and mediated by hormones like gastrin and CCK, increasing colon motility. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 270.",
        "whyNotOtherOptions": {
            "a": "Sympathetic innervation inhibits motility.",
            "c": "Short reflexes are local, not gastrocolic.",
            "d": "Somatic motor neurons control voluntary muscles."
        },
        "relatedQuestions": ["4 (CCK)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 38,
        "question": "Which of the following GI structures is most directly affected by a deficiency in VIP (vasoactive intestinal peptide)?",
        "options": [
            "Gastric acid secretion",
            "Smooth muscle relaxation in the GI tract",
            "Bile production in the liver",
            "Mucus secretion in the colon"
        ],
        "answer": 1,
        "correctAnswer": "Smooth muscle relaxation in the GI tract",
        "explanation": "VIP is an inhibitory neurotransmitter in the ENS, promoting smooth muscle relaxation to regulate motility. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 550.",
        "whyNotOtherOptions": {
            "a": "Gastric acid is regulated by parietal cells/histamine.",
            "c": "Bile production is a liver function.",
            "d": "Mucus secretion is by goblet cells, not VIP."
        },
        "relatedQuestions": ["20 (inhibitory neurotransmitters)"],
        "category": "Gastrointestinal System",
        "difficulty": "Hard"
    },
    {
        "id": 39,
        "question": "The primary role of the ileocecal valve is to:",
        "options": [
            "Prevent reflux of colonic contents into the ileum",
            "Regulate gastric emptying into the duodenum",
            "Stimulate pancreatic secretions",
            "Increase surface area for absorption"
        ],
        "answer": 0,
        "correctAnswer": "Prevent reflux of colonic contents into the ileum",
        "explanation": "The ileocecal valve controls the flow from the ileum to the colon and prevents reflux of colonic contents. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 270.",
        "whyNotOtherOptions": {
            "b": "Gastric emptying is regulated by the pyloric sphincter.",
            "c": "Pancreatic secretions are hormone-driven (e.g., CCK).",
            "d": "Surface area is increased by villi, not the valve."
        },
        "relatedQuestions": ["12 (colono-ileal reflex)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 40,
        "question": "A patient with a vagotomy (surgical cutting of the vagus nerve) would most likely experience:",
        "options": [
            "Increased gastric motility",
            "Impaired gastric acid secretion and motility",
            "Enhanced defecation reflexes",
            "Increased bile production"
        ],
        "answer": 1,
        "correctAnswer": "Impaired gastric acid secretion and motility",
        "explanation": "The vagus nerve regulates gastric acid secretion (via parietal cells) and motility. A vagotomy impairs these functions. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 260.",
        "whyNotOtherOptions": {
            "a": "Vagotomy decreases, not increases, motility.",
            "c": "Defecation reflexes are sacral, not vagal.",
            "d": "Bile production is a liver function, not vagal."
        },
        "relatedQuestions": ["11 (vagus nerve)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 1,
        "question": "A patient has a condition that severely damages the mucosal layer of the esophagus. Which primary function is most directly compromised?",
        "options": [
            "Absorption of nutrients",
            "Secretion of digestive enzymes",
            "Protection against mechanical abrasion",
            "Hormone secretion"
        ],
        "answer": 2,
        "correctAnswer": "Protection against mechanical abrasion",
        "explanation": "The esophagus is lined with non-keratinized stratified squamous epithelium in its mucosa, which protects against mechanical abrasion from food. Damage to this layer compromises this protective function. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 560.",
        "whyNotOtherOptions": {
            "a": "The esophagus does not absorb nutrients.",
            "b": "The esophagus does not secrete digestive enzymes.",
            "d": "Hormone secretion is not a primary esophageal function."
        },
        "relatedQuestions": ["14 (esophagus function)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 2,
        "question": "Which structure is correctly paired with its primary type of epithelial lining?",
        "options": [
            "Stomach - Non-keratinized stratified squamous",
            "Esophagus - Simple columnar",
            "Small Intestine - Simple columnar",
            "Anal Canal - Simple columnar"
        ],
        "answer": 2,
        "correctAnswer": "Small Intestine - Simple columnar",
        "explanation": "The small intestine is lined with simple columnar epithelium, specialized for absorption and secretion. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 570.",
        "whyNotOtherOptions": {
            "a": "Stomach has simple columnar, not stratified squamous.",
            "b": "Esophagus has non-keratinized stratified squamous.",
            "d": "Anal canal has stratified squamous near the anus."
        },
        "relatedQuestions": ["10 (simple columnar epithelium)", "11 (epithelium function)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 3,
        "question": "The enteric nerve plexus located in the submucosal layer is primarily responsible for:",
        "options": [
            "Coordinating peristaltic movements of the muscularis externa",
            "Controlling glandular secretions and local blood flow within the GIT wall",
            "Producing serous fluid that reduces friction during digestion",
            "Initiating the swallowing reflex in the pharynx"
        ],
        "answer": 1,
        "correctAnswer": "Controlling glandular secretions and local blood flow within the GIT wall",
        "explanation": "The submucosal (Meissners) plexus regulates glandular secretions and local blood flow in the gastrointestinal tract. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Peristalsis is controlled by the myenteric plexus.",
            "c": "Serous fluid is produced by the serosa, not the submucosal plexus.",
            "d": "Swallowing reflex is controlled by the medulla, not the enteric plexus."
        },
        "relatedQuestions": ["18 (submucosal layer)"],
        "category": "Gastrointestinal System",
        "difficulty": "Hard"
    },
    {
        "id": 4,
        "question": "All of the following are activities of the stomach EXCEPT:",
        "options": [
            "Chemical digestion of food",
            "Absorption of the majority of water and electrolytes",
            "Temporary storage of food",
            "Secretion of hormones"
        ],
        "answer": 1,
        "correctAnswer": "Absorption of the majority of water and electrolytes",
        "explanation": "The stomach performs chemical digestion (via pepsin and HCl), temporary storage, and hormone secretion (e.g., gastrin), but most water and electrolyte absorption occurs in the small intestine and large intestine. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 260.",
        "whyNotOtherOptions": {
            "a": "Stomach digests proteins chemically.",
            "c": "Stomach stores food as chyme.",
            "d": "Stomach secretes hormones like gastrin."
        },
        "relatedQuestions": ["10 (hormone secretion)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 5,
        "question": "The muscularis mucosae is a layer of smooth muscle found within the mucosa. Its contraction would most directly affect:",
        "options": [
            "Propulsion of a food bolus from the esophagus to the stomach",
            "Mixing of chyme in the stomach lumen",
            "Local movements and folding of the mucosal surface",
            "Release of secretions from the pancreas and liver"
        ],
        "answer": 2,
        "correctAnswer": "Local movements and folding of the mucosal surface",
        "explanation": "The muscularis mucosae, a thin smooth muscle layer in the mucosa, causes local folding and movement of the mucosal surface to enhance secretion and absorption. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 550.",
        "whyNotOtherOptions": {
            "a": "Propulsion is by muscularis externa.",
            "b": "Chyme mixing is by muscularis externa.",
            "d": "Pancreatic/liver secretions are hormonally regulated."
        },
        "relatedQuestions": ["18 (submucosal layer)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 6,
        "question": "Which sequence correctly lists the layers of the alimentary canal from the lumen outward?",
        "options": [
            "Serosa  Muscularis externa  Submucosa  Mucosa",
            "Mucosa  Submucosa  Serosa  Muscularis externa",
            "Mucosa  Submucosa  Muscularis externa  Serosa",
            "Submucosa  Mucosa  Muscularis externa  Serosa"
        ],
        "answer": 2,
        "correctAnswer": "Mucosa  Submucosa  Muscularis externa  Serosa",
        "explanation": "The alimentary canal layers, from lumen outward, are mucosa, submucosa, muscularis externa, and serosa (or adventitia in some regions). Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 550.",
        "whyNotOtherOptions": {
            "a": "Serosa is outermost, not innermost.",
            "b": "Serosa is after muscularis externa.",
            "d": "Submucosa is not innermost."
        },
        "relatedQuestions": ["13 (serosa)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 7,
        "question": "The lamina propria, a component of the mucosa, contains blood vessels and lymph nodes. What is its primary role?",
        "options": [
            "To provide a protective epithelial barrier",
            "To produce waves of segmentation and peristalsis",
            "To nourish the epithelial cells and absorb digested nutrients",
            "To secrete mucus and enzymes into the lumen"
        ],
        "answer": 2,
        "correctAnswer": "To nourish the epithelial cells and absorb digested nutrients",
        "explanation": "The lamina propria, a connective tissue layer in the mucosa, contains blood and lymph vessels that nourish epithelial cells and absorb nutrients. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 555.",
        "whyNotOtherOptions": {
            "a": "Epithelium, not lamina propria, provides the barrier.",
            "b": "Peristalsis/segmentation is by muscularis externa.",
            "d": "Mucus/enzymes are secreted by epithelial cells."
        },
        "relatedQuestions": [],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 8,
        "question": "Control of food intake (ingestion) is directly governed by centers located in the:",
        "options": [
            "Cerebral Cortex",
            "Hypothalamus (HT)",
            "Medulla Oblongata",
            "Enteric Nervous System"
        ],
        "answer": 1,
        "correctAnswer": "Hypothalamus (HT)",
        "explanation": "The hypothalamus contains feeding and satiety centers that regulate food intake. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 110.",
        "whyNotOtherOptions": {
            "a": "Cerebral cortex influences but does not directly control ingestion.",
            "c": "Medulla controls swallowing, not intake.",
            "d": "Enteric nervous system regulates local gut function."
        },
        "relatedQuestions": [],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 9,
        "question": "Which accessory structures primary function is not to produce a secretion that facilitates chemical digestion?",
        "options": [
            "Salivary glands",
            "Gallbladder",
            "Tongue",
            "Pancreas"
        ],
        "answer": 2,
        "correctAnswer": "Tongue",
        "explanation": "The tongue assists in mechanical chewing and swallowing but does not produce secretions for chemical digestion. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 240.",
        "whyNotOtherOptions": {
            "a": "Salivary glands secrete amylase for digestion.",
            "b": "Gallbladder stores bile for fat digestion.",
            "d": "Pancreas secretes digestive enzymes."
        },
        "relatedQuestions": ["17 (teeth and tongue)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 10,
        "question": "The simple columnar epithelium in the stomach and small intestine contains hormone-secreting cells called:",
        "options": [
            "Chief cells",
            "Enteroendocrine cells",
            "Parietal cells",
            "Goblet cells"
        ],
        "answer": 1,
        "correctAnswer": "Enteroendocrine cells",
        "explanation": "Enteroendocrine cells in the stomach and small intestine secrete hormones like gastrin and CCK. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 565.",
        "whyNotOtherOptions": {
            "a": "Chief cells secrete pepsinogen.",
            "c": "Parietal cells secrete HCl.",
            "d": "Goblet cells secrete mucus."
        },
        "relatedQuestions": ["2 (epithelium)", "4 (stomach hormones)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 11,
        "question": "A key difference in function between non-keratinized stratified squamous epithelium and simple columnar epithelium in the GIT is that simple columnar epithelium is also involved in:",
        "options": [
            "Protection from abrasion",
            "Mastication of food",
            "Absorption of nutrients",
            "Initiation of deglutition"
        ],
        "answer": 2,
        "correctAnswer": "Absorption of nutrients",
        "explanation": "Simple columnar epithelium (e.g., small intestine) is specialized for nutrient absorption, unlike stratified squamous epithelium (e.g., esophagus), which protects against abrasion. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 570.",
        "whyNotOtherOptions": {
            "a": "Protection is the role of stratified squamous.",
            "b": "Mastication occurs in the mouth, not epithelium-specific.",
            "d": "Deglutition is initiated by muscles, not epithelium."
        },
        "relatedQuestions": ["2 (epithelium)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 12,
        "question": "What is the primary digestive role of the large intestine?",
        "options": [
            "Chemical digestion and nutrient absorption",
            "Mechanical grinding and enzyme secretion",
            "Absorption of water and storage of fecal matter",
            "Temporary storage and mixing of food"
        ],
        "answer": 2,
        "correctAnswer": "Absorption of water and storage of fecal matter",
        "explanation": "The large intestine primarily absorbs water and stores fecal matter before elimination. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 270.",
        "whyNotOtherOptions": {
            "a": "Chemical digestion/absorption is primarily in the small intestine.",
            "b": "Grinding and enzyme secretion are not large intestine functions.",
            "d": "Storage and mixing occur in the stomach/small intestine."
        },
        "relatedQuestions": [],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 13,
        "question": "The serosa is the outermost layer of the digestive tract. What is its primary tissue composition and function?",
        "options": [
            "Epithelial tissue for absorption",
            "Connective tissue for protection and reducing friction",
            "Nervous tissue for local control",
            "Muscle tissue for propulsion"
        ],
        "answer": 1,
        "correctAnswer": "Connective tissue for protection and reducing friction",
        "explanation": "The serosa, a connective tissue layer with mesothelium, protects the digestive tract and reduces friction in the peritoneal cavity. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 550.",
        "whyNotOtherOptions": {
            "a": "Epithelium is in the mucosa, not serosa.",
            "c": "Nervous tissue is in the enteric plexus, not serosa.",
            "d": "Muscle tissue is in the muscularis externa."
        },
        "relatedQuestions": ["6 (alimentary canal layers)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 14,
        "question": "Which statement regarding the esophagus is accurate?",
        "options": [
            "Primary site for chemical digestion of carbohydrates",
            "Mucosal layer contains enzyme-secreting cells",
            "Main function is the simple passage of food",
            "Responsible for elimination of fecal matter"
        ],
        "answer": 2,
        "correctAnswer": "Main function is the simple passage of food",
        "explanation": "The esophagus transports food from the pharynx to the stomach via peristalsis, with no significant digestion or elimination role. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 245.",
        "whyNotOtherOptions": {
            "a": "Carbohydrate digestion begins in the mouth.",
            "b": "Esophageal mucosa lacks enzyme-secreting cells.",
            "d": "Fecal elimination is by the large intestine."
        },
        "relatedQuestions": ["1 (esophageal mucosa)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 15,
        "question": "The mucus secreted throughout the gastrointestinal tract serves two major purposes:",
        "options": [
            "Hormonal control and nutrient absorption",
            "Enzymatic digestion and peristalsis",
            "Protection from self-digestion and easing food movement",
            "Mechanical grinding and elimination"
        ],
        "answer": 2,
        "correctAnswer": "Protection from self-digestion and easing food movement",
        "explanation": "Mucus protects the gastrointestinal tract from enzymatic self-digestion and lubricates food passage. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 555.",
        "whyNotOtherOptions": {
            "a": "Mucus does not control hormones or absorb nutrients.",
            "b": "Mucus does not perform enzymatic digestion.",
            "d": "Grinding/elimination are not mucus functions."
        },
        "relatedQuestions": [],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 16,
        "question": "Which organ is correctly paired with its primary function?",
        "options": [
            "Mouth: Absorption of water",
            "Stomach: Elimination of fecal matter",
            "Small Intestine: Digestion and absorption",
            "Large Intestine: Temporary storage of food"
        ],
        "answer": 2,
        "correctAnswer": "Small Intestine: Digestion and absorption",
        "explanation": "The small intestine is the primary site for chemical digestion and nutrient absorption. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 265.",
        "whyNotOtherOptions": {
            "a": "Mouth performs mechanical digestion, not water absorption.",
            "b": "Stomach stores/digests food, not eliminates feces.",
            "d": "Large intestine absorbs water and stores feces."
        },
        "relatedQuestions": ["12 (large intestine)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 17,
        "question": "The teeth and tongue are classified as accessory structures. Their respective primary functions are:",
        "options": [
            "Secretion of enzymes; secretion of hormones",
            "Mechanical grinding of food; assistance in chewing and swallowing",
            "Absorption of nutrients; chemical digestion",
            "Production of bile; storage of bile"
        ],
        "answer": 1,
        "correctAnswer": "Mechanical grinding of food; assistance in chewing and swallowing",
        "explanation": "Teeth mechanically break down food, and the tongue assists in chewing and swallowing. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 240.",
        "whyNotOtherOptions": {
            "a": "Neither secretes enzymes or hormones.",
            "c": "Neither absorbs nutrients or digests chemically.",
            "d": "Bile is produced/stored by liver/gallbladder."
        },
        "relatedQuestions": ["9 (tongue)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 18,
        "question": "The submucosal layer contains all of the following EXCEPT:",
        "options": [
            "Enteric nerve plexus",
            "Blood vessels",
            "Muscularis mucosae",
            "Secretory glands"
        ],
        "answer": 2,
        "correctAnswer": "Muscularis mucosae",
        "explanation": "The muscularis mucosae is part of the mucosa, not the submucosa, which contains the enteric nerve plexus, blood vessels, and glands. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 550.",
        "whyNotOtherOptions": {
            "a": "Submucosa contains Meissners plexus.",
            "b": "Submucosa has blood vessels.",
            "d": "Submucosa contains glands (e.g., Brunners glands)."
        },
        "relatedQuestions": ["3 (submucosal plexus)", "5 (muscularis mucosae)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 19,
        "question": "The layer responsible for producing powerful, propulsive contractions of peristalsis is the:",
        "options": [
            "Mucosa",
            "Submucosa",
            "Muscularis Externa",
            "Serosa"
        ],
        "answer": 2,
        "correctAnswer": "Muscularis Externa",
        "explanation": "The muscularis externa, with its longitudinal and circular smooth muscle layers, produces peristaltic contractions. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Mucosa is for secretion/absorption.",
            "b": "Submucosa supports, does not contract.",
            "d": "Serosa reduces friction, not motility."
        },
        "relatedQuestions": ["6 (alimentary canal layers)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 20,
        "question": "Which lists the structures in the correct order that food passes through them?",
        "options": [
            "Pharynx  Mouth  Esophagus  Stomach",
            "Mouth  Pharynx  Esophagus  Stomach",
            "Mouth  Esophagus  Pharynx  Stomach",
            "Esophagus  Mouth  Stomach  Pharynx"
        ],
        "answer": 1,
        "correctAnswer": "Mouth  Pharynx  Esophagus  Stomach",
        "explanation": "Food passes from the mouth to the pharynx, then through the esophagus to the stomach. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 240-245.",
        "whyNotOtherOptions": {
            "a": "Pharynx follows mouth.",
            "c": "Esophagus follows pharynx.",
            "d": "Esophagus is not first."
        },
        "relatedQuestions": ["14 (esophagus)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
{
        "id": 1,
        "question": "A biopsy from a segment of the alimentary canal shows a mucosa with simple columnar epithelium, a well-developed muscularis mucosae, and the muscularis externa is composed of smooth muscle in two layers. This biopsy is LEAST likely to be from the:",
        "options": [
            "Jejunum",
            "Stomach",
            "Esophagus",
            "Ileum"
        ],
        "answer": 2,
        "correctAnswer": "Esophagus",
        "explanation": "The esophagus is lined with non-keratinized stratified squamous epithelium, not simple columnar epithelium. The other organs listed (jejunum, stomach, ileum) are in the rest of the tract that uses simple columnar epithelium. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 560.",
        "whyNotOtherOptions": {
            "a": "Jejunum has simple columnar epithelium.",
            "b": "Stomach has simple columnar epithelium.",
            "d": "Ileum has simple columnar epithelium."
        },
        "relatedQuestions": [],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 2,
        "question": "The myenteric plexus (plexus of Auerbach) is located within the muscularis externa and is primarily responsible for controlling GI motility. Which nerve fibers contribute to this plexus?",
        "options": [
            "Somatic motor fibers only",
            "Fibers from both the sympathetic and parasympathetic divisions",
            "Sensory (afferent) fibers only",
            "Fibers from the central nervous system exclusively"
        ],
        "answer": 1,
        "correctAnswer": "Fibers from both the sympathetic and parasympathetic divisions",
        "explanation": "The myenteric plexus consists of fibers from both autonomic divisions (sympathetic and parasympathetic), controlling GI motility. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Somatic motor fibers innervate skeletal muscle, not the GI tract.",
            "c": "Sensory fibers are present but not primary for motility.",
            "d": "CNS fibers do not exclusively form the plexus."
        },
        "relatedQuestions": ["8 (submucosal plexus)"],
        "category": "Gastrointestinal System",
        "difficulty": "Hard"
    },
    {
        "id": 3,
        "question": "Damage to the lamina propria would most directly impair which of the following processes?",
        "options": [
            "The propulsive force of peristalsis",
            "The local mixing movements of the mucosal folds",
            "The nourishment of the epithelial lining and the initial uptake of absorbed nutrients",
            "The voluntary control of defecation"
        ],
        "answer": 2,
        "correctAnswer": "The nourishment of the epithelial lining and the initial uptake of absorbed nutrients",
        "explanation": "The lamina proprias specific functions are to nourish the epithelium and absorb nutrients via its blood and lymph vessels. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 555.",
        "whyNotOtherOptions": {
            "a": "Peristalsis is controlled by the muscularis externa.",
            "b": "Local mixing is by muscularis mucosae, not lamina propria.",
            "d": "Voluntary defecation is controlled by somatic nerves."
        },
        "relatedQuestions": [],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 4,
        "question": "Which of the following statements accurately describes a key structural difference between the serosa and the mucosa?",
        "options": [
            "The serosa contains an epithelial lining, while the mucosa does not.",
            "The mucosa contains connective tissue and blood vessels, while the serosa does not.",
            "The mucosa has a nerve plexus controlling motility, while the serosa has a plexus controlling secretions.",
            "The serosa is the outermost layer formed of connective and epithelial tissue, while the mucosa is the innermost layer with similar components but different functions."
        ],
        "answer": 3,
        "correctAnswer": "The serosa is the outermost layer formed of connective and epithelial tissue, while the mucosa is the innermost layer with similar components but different functions.",
        "explanation": "Both the serosa and mucosa have an epithelial component and connective tissue. Their key difference is their location and primary function (protection/absorption/secretion for mucosa vs. outer covering/friction reduction for serosa). Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 550.",
        "whyNotOtherOptions": {
            "a": "Mucosa has an epithelial lining.",
            "b": "Serosa contains connective tissue and some vessels.",
            "c": "Mucosa has no motility-controlling plexus; submucosa has secretion control."
        },
        "relatedQuestions": ["9 (serosa)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 5,
        "question": "A pathology that selectively destroys the enteroendocrine cells in the mucosa would primarily disrupt:",
        "options": [
            "The physical breakdown of food particles.",
            "The hormonal regulation of digestive processes.",
            "The secretion of protective mucus into the lumen.",
            "The absorption of water and electrolytes."
        ],
        "answer": 1,
        "correctAnswer": "The hormonal regulation of digestive processes.",
        "explanation": "Enteroendocrine cells are defined as hormone-secreting cells, so their destruction disrupts hormonal regulation of digestion (e.g., gastrin, CCK). Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 565.",
        "whyNotOtherOptions": {
            "a": "Physical breakdown is by teeth and muscles.",
            "c": "Mucus is secreted by goblet cells.",
            "d": "Water/electrolyte absorption is by enterocytes."
        },
        "relatedQuestions": [],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 6,
        "question": "The presence of skeletal muscle in the muscularis externa is a feature limited to specific regions of the GI tract. Based on the notes, which pair of functions is directly enabled by this skeletal muscle?",
        "options": [
            "Chemical digestion and absorption",
            "Voluntary swallowing and voluntary control of defecation",
            "Rhythmic segmentation and peristalsis",
            "Secretion of enzymes and hormones"
        ],
        "answer": 1,
        "correctAnswer": "Voluntary swallowing and voluntary control of defecation",
        "explanation": "Skeletal muscle in the muscularis externa of the upper esophagus and external anal sphincter enables voluntary swallowing and voluntary control of defecation. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 245, 275.",
        "whyNotOtherOptions": {
            "a": "Chemical digestion/absorption are epithelial functions.",
            "c": "Segmentation/peristalsis are by smooth muscle.",
            "d": "Enzyme/hormone secretion is by glands/epithelium."
        },
        "relatedQuestions": [],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 7,
        "question": "The inner circular and outer longitudinal layers of smooth muscle in the muscularis externa work together to achieve all of the following EXCEPT:",
        "options": [
            "Propelling food along the tract (peristalsis)",
            "Physically breaking down food particles",
            "Controlling glandular secretions from the submucosa",
            "Mixing food with digestive secretions"
        ],
        "answer": 2,
        "correctAnswer": "Controlling glandular secretions from the submucosa",
        "explanation": "The muscularis externas smooth muscle layers handle peristalsis and mixing; glandular secretions are controlled by the submucosal plexus. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Peristalsis is a muscularis externa function.",
            "b": "Physical breakdown (mixing) occurs via muscle contractions.",
            "d": "Mixing is a muscularis externa function."
        },
        "relatedQuestions": ["2 (myenteric plexus)", "8 (submucosal plexus)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 8,
        "question": "The submucosal plexus and the myenteric plexus are both part of the enteric nervous system. What is the primary, distinct function of the submucosal plexus as stated in the notes?",
        "options": [
            "To control the contractions of the muscularis externa for motility.",
            "To control secretions by the gastrointestinal tract.",
            "To provide voluntary control over the initial phase of swallowing.",
            "To form the visceral peritoneum below the diaphragm."
        ],
        "answer": 1,
        "correctAnswer": "To control secretions by the gastrointestinal tract.",
        "explanation": "The submucosal plexus (Meissners) controls secretions by the GI tract, as per the notes. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 250.",
        "whyNotOtherOptions": {
            "a": "Contractions are controlled by the myenteric plexus.",
            "c": "Swallowing is controlled by the medulla oblongata.",
            "d": "Visceral peritoneum is the serosa, not a nervous structure."
        },
        "relatedQuestions": ["2 (myenteric plexus)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 9,
        "question": "The serosa is also known as the visceral peritoneum. This implies that the serosa:",
        "options": [
            "Is found in all segments of the alimentary canal from mouth to anus.",
            "Lines the walls of the abdominal cavity.",
            "Is the layer that forms the outer covering of abdominal digestive organs.",
            "Is composed primarily of skeletal muscle."
        ],
        "answer": 2,
        "correctAnswer": "Is the layer that forms the outer covering of abdominal digestive organs.",
        "explanation": "The serosa (visceral peritoneum) covers abdominal digestive organs, reducing friction, as opposed to the parietal peritoneum lining the abdominal wall. Reference: Moore, K. L., Clinically Oriented Anatomy, 7th ed., Chapter 2, p. 200.",
        "whyNotOtherOptions": {
            "a": "Serosa is only in intraperitoneal segments, not mouth to anus.",
            "b": "Parietal peritoneum lines the abdominal wall.",
            "d": "Serosa is connective tissue and epithelium, not muscle."
        },
        "relatedQuestions": ["4 (serosa vs. mucosa)"],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    },
    {
        "id": 10,
        "question": "The muscularis mucosae and the muscularis externa are both layers of muscle. Their functions differ in that the muscularis mucosae is responsible for _______, while the muscularis externa is responsible for _______.",
        "options": [
            "controlling secretions / producing mucus",
            "local movements of the mucosa / propelling food along the tract",
            "voluntary swallowing / involuntary mixing",
            "absorbing nutrients / protecting against infection"
        ],
        "answer": 1,
        "correctAnswer": "local movements of the mucosa / propelling food along the tract",
        "explanation": "The muscularis mucosae produces local movements of the mucosa, while the muscularis externa is responsible for propulsion and mixing along the tract. Reference: Ross, M. H., Histology: A Text and Atlas, 7th ed., Chapter 17, p. 550.",
        "whyNotOtherOptions": {
            "a": "Neither layer directly controls mucus production.",
            "c": "Voluntary swallowing is by skeletal muscle in specific regions.",
            "d": "Nutrient absorption and infection protection are not muscle functions."
        },
        "relatedQuestions": [],
        "category": "Gastrointestinal System",
        "difficulty": "Medium"
    }
];

        // DOM Elements
        const registrationModal = document.getElementById('registrationModal');
        const registrationForm = document.getElementById('registrationForm');
        const mainContainer = document.getElementById('mainContainer');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toastMessage');
        const questionsContainer = document.getElementById('questionsContainer');
        const questionIndicators = document.getElementById('questionIndicators');
        const progressFill = document.getElementById('progressFill');
        const progressPercent = document.getElementById('progressPercent');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const submitBtn = document.getElementById('submitBtn');
        const resultsContainer = document.getElementById('resultsContainer');
        const scoreValue = document.getElementById('scoreValue');
        const correctCount = document.getElementById('correctCount');
        const incorrectCount = document.getElementById('incorrectCount');
        const timeTaken = document.getElementById('timeTaken');
        const scoreCircle = document.getElementById('scoreCircle');
        const restartBtn = document.getElementById('restartBtn');
        const scrollTopBtn = document.getElementById('scrollTopBtn');
        const themeToggleBtn = document.getElementById('themeToggleBtn');
        const timeDisplay = document.getElementById('timeDisplay');
        const modeIndicator = document.getElementById('modeIndicator');
        const modeButtons = document.querySelectorAll('.mode-btn');
        const jumpToggle = document.getElementById('jumpToggle');
        const jumpContent = document.getElementById('jumpContent');
        const categoryJumpToggle = document.getElementById('categoryJumpToggle');
        const categoryJumpContent = document.getElementById('categoryJumpContent');
        const categoryList = document.getElementById('categoryList');
        const menuToggleBtn = document.getElementById('menuToggleBtn');
        const hamburgerIcon = document.getElementById('hamburgerIcon');
        const sidebar = document.getElementById('sidebar');
        const questionCount = document.getElementById('questionCount');
        const timeInfo = document.getElementById('timeInfo');
        const progressContainer = document.getElementById('progressContainer');
        const floatingControls = document.getElementById('floatingControls');
        const submitFloatingBtn = document.getElementById('submitFloatingBtn');
        const learnModeContainer = document.getElementById('learnModeContainer');
        const learnQuestionText = document.getElementById('learnQuestionText');
        const learnOptionsContainer = document.getElementById('learnOptionsContainer');
        const learnNextBtn = document.getElementById('learnNextBtn');
        const learnPrevBtn = document.getElementById('learnPrevBtn');
        const learnProgress = document.getElementById('learnProgress');
        const learnProgressFill = document.getElementById('learnProgressFill');
        const learnProgressPercent = document.getElementById('learnProgressPercent');
        const qualityStars = document.getElementById('qualityStars');
        const learnCompletion = document.getElementById('learnCompletion');
        const learnRestartBtn = document.getElementById('learnRestartBtn');
        const flashcardModeContainer = document.getElementById('flashcardModeContainer');
        const flashcardCategories = document.getElementById('flashcardCategories');
        const flashcard = document.getElementById('flashcard');
        const flashcardQuestion = document.getElementById('flashcardQuestion');
        const flashcardAnswer = document.getElementById('flashcardAnswer');
        const flashcardExplanation = document.getElementById('flashcardExplanation');
        const flashcardPrevBtn = document.getElementById('flashcardPrevBtn');
        const flashcardNextBtn = document.getElementById('flashcardNextBtn');
        const flashcardShuffleBtn = document.getElementById('flashcardShuffleBtn');
        const flashcardKnownBtn = document.getElementById('flashcardKnownBtn');
        const flashcardUnknownBtn = document.getElementById('flashcardUnknownBtn');
        const flashcardRemaining = document.getElementById('flashcardRemaining');
        const flashcardKnown = document.getElementById('flashcardKnown');
        const flashcardTotal = document.getElementById('flashcardTotal');
        const flashcardProgress = document.getElementById('flashcardProgress');
        const flashcardProgressFill = document.getElementById('flashcardProgressFill');
        const flashcardProgressPercent = document.getElementById('flashcardProgressPercent');
        const flashcardCompletion = document.getElementById('flashcardCompletion');
        const flashcardRestartBtn = document.getElementById('flashcardRestartBtn');

        // Quiz state variables
        let currentQuestion = 0;
        let userAnswers = new Array(quizData.length).fill(null);
        let quizSubmitted = false;
        let startTime = new Date();
        let timerInterval;
        let currentMode = 'quiz';
        let learnQuestions = [...quizData];
        let currentLearnQuestion = 0;
        let learnAnsweredQuestions = [];
        let learnCorrectAnswers = 0;
        let learnTotalAttempts = 0;
        let learnQualityScore = 0;
        let flashcardDeck = [...quizData];
        let originalFlashcardDeck = [...quizData];
        let currentFlashcardIndex = 0;
        let knownCards = 0;
        let spacedRepetitionQueue = [];
        let isFlipped = false;
        let currentCategory = 'All';

        // Initialize the application
        function initApp() {
            // Check if user is already registered
            const savedUserData = localStorage.getItem('medquiz_user');
            if (savedUserData) {
                userData = JSON.parse(savedUserData);
                showMainContent();
            } else {
                showRegistrationModal();
            }

            // Set up event listeners for registration form
            registrationForm.addEventListener('submit', handleRegistration);
        }

        // Show registration modal
        function showRegistrationModal() {
            registrationModal.style.display = 'flex';
            mainContainer.classList.add('blurred-content');
        }

        // Show main content after registration
        function showMainContent() {
            registrationModal.style.display = 'none';
            mainContainer.classList.remove('blurred-content');
            initQuiz();
            
            // Send registration notification to Telegram
            sendTelegramNotification(
                ` New Registration\n` +
                ` Name: ${userData.fullName}\n` +
                ` Telegram: ${userData.telegramUsername}\n` +
                ` Registered at: ${new Date(userData.registrationTime).toLocaleString()}`
            );
        }

        // Handle registration form submission
        function handleRegistration(e) {
            e.preventDefault();
            
            // Get form data
            userData = {
                fullName: document.getElementById('fullName').value,
                telegramUsername: document.getElementById('telegramUsername').value,
                registrationTime: new Date().toISOString()
            };
            
            // Save to localStorage
            localStorage.setItem('medquiz_user', JSON.stringify(userData));
            
            // Show main content
            showMainContent();
            
            // Show success toast
            showToast('Registration successful! Welcome to MedQUIZ.', 'success');
        }

        // Show toast notification
        function showToast(message, type = 'info') {
            toastMessage.textContent = message;
            toast.className = 'toast';
            toast.classList.add(type);
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Send notification to Telegram
        async function sendTelegramNotification(message) {
            try {
                const response = await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: TELEGRAM_CHAT_ID,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Failed to send notification');
                }
                
                console.log('Notification sent successfully');
            } catch (error) {
                console.error('Error sending notification:', error);
            }
        }

        // Track mode usage
        function trackModeUsage(mode, action) {
            if (action === 'start') {
                modeUsage[mode].startTime = new Date();
            } else if (action === 'end' && modeUsage[mode].startTime) {
                const duration = Math.round((new Date() - modeUsage[mode].startTime) / 1000);
                modeUsage[mode].duration += duration;
                modeUsage[mode].startTime = null;
                
                // Send mode usage to Telegram
                sendTelegramNotification(
                    ` Mode Usage - ${userData.fullName}\n` +
                    ` Mode: ${mode}\n` +
                    ` Duration: ${formatTime(duration)}\n` +
                    ` Total time in ${mode} mode: ${formatTime(modeUsage[mode].duration)}`
                );
            }
        }

        // Format time in seconds to MM:SS
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
        }

        // Initialize quiz functionality
        function initQuiz() {
            updateQuizInfo();
            renderQuestions();
            renderQuestionIndicators();
            renderCategoryList();
            updateProgress();
            startTimer();
           
            jumpToggle.addEventListener('click', () => {
                toggleCollapsible(jumpContent, jumpToggle);
            });
           
            categoryJumpToggle.addEventListener('click', () => {
                toggleCollapsible(categoryJumpContent, categoryJumpToggle);
            });
           
            menuToggleBtn.addEventListener('click', () => {
                sidebar.classList.toggle('active');
                hamburgerIcon.classList.toggle('active');
                menuToggleBtn.classList.toggle('active');
            });
           
            document.addEventListener('click', (e) => {
                if (sidebar.classList.contains('active')) {
                    if (!sidebar.contains(e.target) && !menuToggleBtn.contains(e.target)) {
                        sidebar.classList.remove('active');
                        hamburgerIcon.classList.remove('active');
                        menuToggleBtn.classList.remove('active');
                    }
                }
            });
           
            let touchTimeout;
            document.addEventListener('touchstart', (e) => {
                if (!floatingControls.contains(e.target) && !menuToggleBtn.contains(e.target) && !sidebar.contains(e.target)) {
                    floatingControls.classList.add('visible');
                    clearTimeout(touchTimeout);
                    touchTimeout = setTimeout(() => {
                        floatingControls.classList.remove('visible');
                    }, 3000);
                }
            });
            prevBtn.addEventListener('click', goToPreviousQuestion);
            nextBtn.addEventListener('click', goToNextQuestion);
            submitBtn.addEventListener('click', submitQuiz);
            restartBtn.addEventListener('click', restartQuiz);
            scrollTopBtn.addEventListener('click', scrollToTop);
            themeToggleBtn.addEventListener('click', toggleTheme);
            learnNextBtn.addEventListener('click', goToNextLearnQuestion);
            learnPrevBtn.addEventListener('click', goToPrevLearnQuestion);
            learnRestartBtn.addEventListener('click', restartLearnMode);
            submitFloatingBtn.addEventListener('click', submitQuiz);
           
            modeButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    // Track mode change
                    if (currentMode !== btn.dataset.mode) {
                        trackModeUsage(currentMode, 'end');
                        trackModeUsage(btn.dataset.mode, 'start');
                    }
                    
                    modeButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentMode = btn.dataset.mode;
                    updateModeIndicator();
                    if (currentMode === 'learn') {
                        startLearnMode();
                    } else if (currentMode === 'flashcard') {
                        startFlashcardMode();
                    } else {
                        restartQuiz();
                    }
                });
            });
           
            document.addEventListener('keydown', handleKeyNavigation);
        }

        function toggleCollapsible(content, toggle) {
            const isExpanded = content.classList.contains('expanded');
            if (isExpanded) {
                content.classList.remove('expanded');
                content.classList.add('collapsed');
                toggle.querySelector('i').classList.remove('fa-chevron-up');
                toggle.querySelector('i').classList.add('fa-chevron-down');
            } else {
                content.classList.remove('collapsed');
                content.classList.add('expanded');
                toggle.querySelector('i').classList.remove('fa-chevron-down');
                toggle.querySelector('i').classList.add('fa-chevron-up');
            }
        }

        function updateQuizInfo() {
            questionCount.textContent = `${quizData.length} Questions`;
            timeInfo.textContent = currentMode === 'exam' ? `${quizData.length * 2} Minutes` : 'Unlimited';
        }

        function updateModeIndicator() {
            modeIndicator.textContent = currentMode === 'quiz' ? 'Quiz Mode' :
                                       currentMode === 'exam' ? 'Exam Mode' :
                                       currentMode === 'learn' ? 'Learn Mode' : 'Flashcard Mode';
            modeIndicator.className = 'mode-indicator ' +
                                     (currentMode === 'quiz' ? 'quiz-mode' :
                                      currentMode === 'exam' ? 'exam-mode' :
                                      currentMode === 'learn' ? 'learn-mode' : 'flashcard-mode');
        }

        function renderQuestions() {
            questionsContainer.innerHTML = '';
            quizData.forEach((questionData, index) => {
                const questionElement = document.createElement('div');
                questionElement.className = 'question-section';
                questionElement.id = `question-${index}`;
                questionElement.innerHTML = `
                    <div class="question-header">
                        <div class="question-number">${index + 1}</div>
                        <div class="question-text">${questionData.question}</div>
                    </div>
                    <div class="options-container">
                        ${questionData.options.map((option, optionIndex) =>
                            `<div class="option" data-question="${index}" data-option="${optionIndex}">
                                <div class="option-letter">${String.fromCharCode(65 + optionIndex)}</div>
                                <div class="option-text">${option}</div>
                            </div>`
                        ).join('')}
                    </div>
                    <button class="explanation-toggle" disabled>
                        <i class="fas fa-lightbulb"></i> Show Explanation
                    </button>
                    <div class="explanation">
                        <div class="explanation-section">
                            <h4>Correct Answer</h4>
                            <p>${questionData.correctAnswer}</p>
                        </div>
                        <div class="explanation-section">
                            <h4>Detailed Explanation</h4>
                            <p>${questionData.explanation}</p>
                        </div>
                        <div class="explanation-section">
                            <h4>Why Others Are Incorrect</h4>
                            ${Object.entries(questionData.whyNotOtherOptions).map(([letter, reason]) =>
                                `<div class="why-not-item">
                                    <span class="why-not-letter">${letter.toUpperCase()}:</span>
                                    <span>${reason}</span>
                                </div>`
                            ).join('')}
                        </div>
                    </div>
                `;
                questionsContainer.appendChild(questionElement);
                const options = questionElement.querySelectorAll('.option');
                options.forEach(option => {
                    option.addEventListener('click', () => selectOption(option));
                });
                const explanationToggle = questionElement.querySelector('.explanation-toggle');
                const explanation = questionElement.querySelector('.explanation');
                explanationToggle.addEventListener('click', () => {
                    if (explanation.classList.contains('show')) {
                        explanation.classList.remove('show');
                        explanationToggle.innerHTML = '<i class="fas fa-lightbulb"></i> Show Explanation';
                    } else {
                        explanation.classList.add('loading');
                        explanation.classList.add('show');
                        explanationToggle.innerHTML = '<i class="fas fa-lightbulb"></i> Hide Explanation';
                        setTimeout(() => {
                            explanation.classList.remove('loading');
                        }, 800);
                    }
                });
            });
            highlightCurrentQuestion();
        }

        function renderQuestionIndicators() {
            questionIndicators.innerHTML = '';
            quizData.forEach((_, index) => {
                const indicator = document.createElement('div');
                indicator.className = 'question-indicator';
                if (index === 0) indicator.classList.add('current');
                indicator.innerHTML = `<span>${index + 1}</span>`;
                indicator.addEventListener('click', () => jumpToQuestion(index));
                questionIndicators.appendChild(indicator);
            });
        }

        function renderCategoryList() {
            const categories = [...new Set(quizData.map(q => q.category))];
            categoryList.innerHTML = '';
            categories.forEach(category => {
                const categoryItem = document.createElement('div');
                categoryItem.className = 'category-item';
                categoryItem.textContent = category;
                categoryItem.addEventListener('click', () => jumpToCategory(category));
                categoryList.appendChild(categoryItem);
            });
        }

        function jumpToCategory(category) {
            const questionIndex = quizData.findIndex(q => q.category === category);
            if (questionIndex !== -1) {
                jumpToQuestion(questionIndex);
            }
        }

        function selectOption(optionElement) {
            if (quizSubmitted) return;
            const questionIndex = parseInt(optionElement.dataset.question);
            const optionIndex = parseInt(optionElement.dataset.option);
            const questionData = quizData[questionIndex];
            const options = document.querySelectorAll(`.option[data-question="${questionIndex}"]`);
            const explanationToggle = document.querySelector(`#question-${questionIndex} .explanation-toggle`);
            if (currentMode === 'quiz' && userAnswers[questionIndex] !== null) {
                return;
            }
            options.forEach(opt => opt.classList.remove('selected'));
            optionElement.classList.add('selected');
            userAnswers[questionIndex] = optionIndex;
            updateQuestionIndicator(questionIndex, true);
            updateProgress();
            if (currentMode === 'quiz') {
                options.forEach((opt, idx) => {
                    if (idx === questionData.answer) {
                        opt.classList.add('correct');
                    } else if (idx === optionIndex && optionIndex !== questionData.answer) {
                        opt.classList.add('incorrect');
                    }
                    opt.style.pointerEvents = 'none';
                });
                explanationToggle.disabled = false;
            }
        }

        function updateQuestionIndicator(index, answered) {
            const indicators = document.querySelectorAll('.question-indicator');
            if (indicators[index]) {
                if (answered) {
                    indicators[index].classList.add('answered');
                } else {
                    indicators[index].classList.remove('answered');
                }
                indicators.forEach(ind => ind.classList.remove('current'));
                indicators[currentQuestion].classList.add('current');
            }
        }

        function updateProgress() {
            const answeredCount = userAnswers.filter(answer => answer !== null).length;
            const progress = (answeredCount / quizData.length) * 100;
            progressFill.style.width = `${progress}%`;
            progressPercent.textContent = `${Math.round(progress)}%`;
        }

        function goToPreviousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                highlightCurrentQuestion();
            }
        }

        function goToNextQuestion() {
            if (currentQuestion < quizData.length - 1) {
                currentQuestion++;
                highlightCurrentQuestion();
            }
        }

        function jumpToQuestion(index) {
            currentQuestion = index;
            highlightCurrentQuestion();
            sidebar.classList.remove('active');
            hamburgerIcon.classList.remove('active');
            menuToggleBtn.classList.remove('active');
        }

        function highlightCurrentQuestion() {
            document.querySelectorAll('.question-section').forEach(card => {
                card.classList.remove('current');
            });
            const currentQuestionElement = document.getElementById(`question-${currentQuestion}`);
            if (currentQuestionElement) {
                currentQuestionElement.classList.add('current');
                currentQuestionElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
            document.querySelectorAll('.question-indicator').forEach((indicator, index) => {
                indicator.classList.remove('current');
                if (index === currentQuestion) {
                    indicator.classList.add('current');
                }
            });
            prevBtn.disabled = currentQuestion === 0;
            nextBtn.disabled = currentQuestion === quizData.length - 1;
        }

        function submitQuiz() {
            quizSubmitted = true;
            clearInterval(timerInterval);
            const correctAnswers = userAnswers.filter((answer, index) =>
                answer === quizData[index].answer
            ).length;
            const score = (correctAnswers / quizData.length) * 100;
            showResults(score, correctAnswers);
            
            // Send results to Telegram
            const endTime = new Date();
            const timeDiff = (endTime - startTime) / 1000;
            const minutes = Math.floor(timeDiff / 60);
            const seconds = Math.floor(timeDiff % 60);
            
            sendTelegramNotification(
                ` Quiz Results - ${userData.fullName}\n` +
                ` Mode: ${currentMode}\n` +
                ` Correct: ${correctAnswers}/${quizData.length}\n` +
                ` Score: ${Math.round(score)}%\n` +
                ` Time: ${minutes}:${seconds.toString().padStart(2, '0')}`
            );
        }

        function showResults(score, correctAnswers) {
            scoreValue.textContent = `${Math.round(score)}%`;
            correctCount.textContent = correctAnswers;
            incorrectCount.textContent = quizData.length - correctAnswers;
            const endTime = new Date();
            const timeDiff = (endTime - startTime) / 1000;
            const minutes = Math.floor(timeDiff / 60);
            const seconds = Math.floor(timeDiff % 60);
            timeTaken.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            scoreCircle.style.setProperty('--p', `${score}%`);
            resultsContainer.classList.add('show');
            resultsContainer.scrollIntoView({ behavior: 'smooth' });
            if (currentMode === 'exam') {
                quizData.forEach((questionData, index) => {
                    const options = document.querySelectorAll(`.option[data-question="${index}"]`);
                    const explanationToggle = document.querySelector(`#question-${index} .explanation-toggle`);
                    options.forEach((option, optionIndex) => {
                        if (optionIndex === questionData.answer) {
                            option.classList.add('correct');
                        } else if (optionIndex === userAnswers[index] && userAnswers[index] !== questionData.answer) {
                            option.classList.add('incorrect');
                        }
                        option.style.pointerEvents = 'none';
                    });
                    explanationToggle.disabled = false;
                });
            }
        }

        function restartQuiz() {
            currentQuestion = 0;
            userAnswers = new Array(quizData.length).fill(null);
            quizSubmitted = false;
            resultsContainer.classList.remove('show');
            learnModeContainer.classList.remove('show');
            flashcardModeContainer.classList.remove('show');
            progressContainer.style.display = 'block';
            learnProgress.classList.remove('show');
            flashcardProgress.classList.remove('show');
            renderQuestions();
            renderQuestionIndicators();
            renderCategoryList();
            updateProgress();
            updateQuizInfo();
            [jumpContent, categoryJumpContent].forEach(content => {
                content.classList.remove('collapsed');
                content.classList.add('expanded');
            });
            [jumpToggle, categoryJumpToggle].forEach(toggle => {
                toggle.querySelector('i').classList.remove('fa-chevron-up');
                toggle.querySelector('i').classList.add('fa-chevron-down');
            });
            startTime = new Date();
            startTimer();
            questionsContainer.style.display = 'block';
        }

        function startTimer() {
            clearInterval(timerInterval);
            if (currentMode === 'quiz' || currentMode === 'learn' || currentMode === 'flashcard') {
                timerInterval = setInterval(() => {
                    const currentTime = new Date();
                    const timeElapsed = Math.floor((currentTime - startTime) / 1000);
                    const minutes = Math.floor(timeElapsed / 60);
                    const seconds = timeElapsed % 60;
                    timeDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }, 1000);
            } else {
                const timeLimit = quizData.length * 2 * 60;
                timerInterval = setInterval(() => {
                    const currentTime = new Date();
                    const timeElapsed = Math.floor((currentTime - startTime) / 1000);
                    const timeRemaining = timeLimit - timeElapsed;
                    if (timeRemaining <= 0) {
                        clearInterval(timerInterval);
                        submitQuiz();
                        return;
                    }
                    const minutes = Math.floor(timeRemaining / 60);
                    const seconds = timeRemaining % 60;
                    timeDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }, 1000);
            }
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
            themeToggleBtn.innerHTML = document.body.classList.contains('dark-theme') ?
                '<i class="fas fa-sun"></i>' :
                '<i class="fas fa-moon"></i>';
        }

        function handleKeyNavigation(e) {
            if (currentMode === 'learn') {
                if (e.key === 'ArrowLeft') {
                    goToPrevLearnQuestion();
                } else if (e.key === 'ArrowRight' && !learnNextBtn.disabled) {
                    goToNextLearnQuestion();
                }
            } else if (currentMode === 'flashcard') {
                if (e.key === 'ArrowLeft') {
                    goToPrevFlashcard();
                } else if (e.key === 'ArrowRight') {
                    goToNextFlashcard();
                } else if (e.key === ' ') {
                    flipFlashcard();
                } else if (e.key === 'k') {
                    markFlashcardKnown();
                } else if (e.key === 'u') {
                    markFlashcardUnknown();
                } else if (e.key === 's') {
                    shuffleFlashcardDeck();
                }
            } else {
                if (e.key === 'ArrowLeft') {
                    goToPreviousQuestion();
                } else if (e.key === 'ArrowRight') {
                    goToNextQuestion();
                } else if (e.key >= '1' && e.key <= '9' && parseInt(e.key) <= quizData.length) {
                    jumpToQuestion(parseInt(e.key) - 1);
                }
            }
        }

        function startLearnMode() {
            learnQuestions = [...quizData];
            currentLearnQuestion = 0;
            learnAnsweredQuestions = [];
            learnCorrectAnswers = 0;
            learnTotalAttempts = 0;
            learnQualityScore = 0;
            questionsContainer.style.display = 'none';
            flashcardModeContainer.classList.remove('show');
            learnModeContainer.classList.add('show');
            progressContainer.style.display = 'none';
            learnProgress.classList.add('show');
            flashcardProgress.classList.remove('show');
            learnCompletion.classList.remove('show');
            updateLearnProgress();
            displayLearnQuestion();
        }

        function displayLearnQuestion() {
            if (learnQuestions.length === 0) {
                showLearnCompletion();
                return;
            }
            const question = learnQuestions[currentLearnQuestion];
            learnQuestionText.textContent = question.question;
            learnOptionsContainer.innerHTML = '';
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'learn-option';
                optionElement.dataset.option = index;
                optionElement.innerHTML = `
                    <div class="learn-option-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="learn-option-text">${option}</div>
                `;
                optionElement.addEventListener('click', () => selectLearnOption(optionElement, question, index));
                learnOptionsContainer.appendChild(optionElement);
            });
            learnNextBtn.disabled = true;
        }

        function selectLearnOption(optionElement, question, optionIndex) {
            if (learnNextBtn.disabled === false) return;
           
            const options = learnOptionsContainer.querySelectorAll('.learn-option');
            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
           
            learnTotalAttempts++;
           
            if (optionIndex === question.answer) {
                optionElement.classList.add('correct');
                learnCorrectAnswers++;
                learnAnsweredQuestions.push(question.id);
               
                // Remove the question from the pool if answered correctly
                learnQuestions.splice(currentLearnQuestion, 1);
            } else {
                optionElement.classList.add('incorrect');
               
                // Highlight the correct answer
                options[question.answer].classList.add('correct');
               
                // Add the question back to the pool if answered incorrectly
                // This ensures it will appear again later
                if (learnQuestions.length > 1) {
                    const incorrectQuestion = learnQuestions.splice(currentLearnQuestion, 1)[0];
                    learnQuestions.push(incorrectQuestion);
                }
            }
           
            learnNextBtn.disabled = false;
            updateLearnProgress();
        }

        function goToNextLearnQuestion() {
            if (learnQuestions.length === 0) {
                showLearnCompletion();
                return;
            }
           
            // Move to the next question (or wrap around)
            currentLearnQuestion = (currentLearnQuestion + 1) % learnQuestions.length;
            displayLearnQuestion();
        }

        function goToPrevLearnQuestion() {
            if (learnQuestions.length === 0) return;
           
            // Move to the previous question (or wrap around)
            currentLearnQuestion = (currentLearnQuestion - 1 + learnQuestions.length) % learnQuestions.length;
            displayLearnQuestion();
        }

        function updateLearnProgress() {
            const progress = ((quizData.length - learnQuestions.length) / quizData.length) * 100;
            learnProgressFill.style.width = `${progress}%`;
            learnProgressPercent.textContent = `${Math.round(progress)}%`;
           
            // Calculate quality score (correct answers / total attempts)
            if (learnTotalAttempts > 0) {
                learnQualityScore = (learnCorrectAnswers / learnTotalAttempts) * 100;
            }
           
            // Update stars based on quality score
            const stars = qualityStars.querySelectorAll('i');
            const filledStars = Math.round((learnQualityScore / 100) * 5);
           
            stars.forEach((star, index) => {
                if (index < filledStars) {
                    star.classList.remove('far');
                    star.classList.add('fas');
                } else {
                    star.classList.remove('fas');
                    star.classList.add('far');
                }
            });
        }

        function showLearnCompletion() {
            learnModeContainer.style.display = 'none';
            learnCompletion.classList.add('show');
        }

        function restartLearnMode() {
            learnCompletion.classList.remove('show');
            startLearnMode();
            learnModeContainer.style.display = 'block';
        }

        // Flashcard Mode Functions
        function startFlashcardMode() {
            originalFlashcardDeck = [...quizData];
            flashcardDeck = [...originalFlashcardDeck];
            currentFlashcardIndex = 0;
            knownCards = 0;
            spacedRepetitionQueue = [];
            isFlipped = false;
            currentCategory = 'All';
            questionsContainer.style.display = 'none';
            learnModeContainer.classList.remove('show');
            flashcardModeContainer.classList.add('show');
            progressContainer.style.display = 'none';
            learnProgress.classList.remove('show');
            flashcardProgress.classList.add('show');
            flashcardCompletion.classList.remove('show');
            renderFlashcardCategories();
            updateFlashcardDeckByCategory();
            updateFlashcardProgress();
            displayFlashcard();
            flashcard.addEventListener('click', flipFlashcard);
            flashcardPrevBtn.addEventListener('click', goToPrevFlashcard);
            flashcardNextBtn.addEventListener('click', goToNextFlashcard);
            flashcardShuffleBtn.addEventListener('click', shuffleFlashcardDeck);
            flashcardKnownBtn.addEventListener('click', markFlashcardKnown);
            flashcardUnknownBtn.addEventListener('click', markFlashcardUnknown);
            flashcardRestartBtn.addEventListener('click', restartFlashcardMode);
        }

        function renderFlashcardCategories() {
            const categories = ['All', ...new Set(originalFlashcardDeck.map(q => q.category))];
            flashcardCategories.innerHTML = '';
            categories.forEach(cat => {
                const catElement = document.createElement('div');
                catElement.className = 'flashcard-category';
                catElement.textContent = cat;
                if (cat === currentCategory) catElement.classList.add('active');
                catElement.addEventListener('click', () => {
                    document.querySelectorAll('.flashcard-category').forEach(el => el.classList.remove('active'));
                    catElement.classList.add('active');
                    currentCategory = cat;
                    updateFlashcardDeckByCategory();
                    updateFlashcardProgress();
                    displayFlashcard();
                });
                flashcardCategories.appendChild(catElement);
            });
        }

        function updateFlashcardDeckByCategory() {
            if (currentCategory === 'All') {
                flashcardDeck = [...originalFlashcardDeck];
            } else {
                flashcardDeck = originalFlashcardDeck.filter(q => q.category === currentCategory);
            }
            currentFlashcardIndex = 0;
            knownCards = 0;
        }

        function displayFlashcard() {
            if (flashcardDeck.length === 0) {
                showFlashcardCompletion();
                return;
            }
            const card = flashcardDeck[currentFlashcardIndex];
            flashcardQuestion.textContent = card.question;
            flashcardAnswer.textContent = card.correctAnswer;
            flashcardExplanation.innerHTML = `
                <p>${card.explanation}</p>
            `;
            flashcard.classList.remove('flipped');
            isFlipped = false;
        }

        function flipFlashcard() {
            flashcard.classList.toggle('flipped');
            isFlipped = !isFlipped;
        }

        function goToNextFlashcard() {
            currentFlashcardIndex = (currentFlashcardIndex + 1) % flashcardDeck.length;
            displayFlashcard();
        }

        function goToPrevFlashcard() {
            currentFlashcardIndex = (currentFlashcardIndex - 1 + flashcardDeck.length) % flashcardDeck.length;
            displayFlashcard();
        }

        function shuffleFlashcardDeck() {
            flashcardDeck.sort(() => Math.random() - 0.5);
            currentFlashcardIndex = 0;
            displayFlashcard();
        }

        function markFlashcardKnown() {
            knownCards++;
            flashcardDeck.splice(currentFlashcardIndex, 1);
            if (currentFlashcardIndex >= flashcardDeck.length) {
                currentFlashcardIndex = 0;
            }
            updateFlashcardProgress();
            displayFlashcard();
        }

        function markFlashcardUnknown() {
            const unknownCard = flashcardDeck.splice(currentFlashcardIndex, 1)[0];
            // Add to spaced repetition queue (reappear after 3 cards or at end)
            const reinsertIndex = Math.min(currentFlashcardIndex + 3, flashcardDeck.length);
            flashcardDeck.splice(reinsertIndex, 0, unknownCard);
            if (currentFlashcardIndex >= flashcardDeck.length) {
                currentFlashcardIndex = 0;
            }
            displayFlashcard();
        }

        function updateFlashcardProgress() {
            const total = currentCategory === 'All' ? quizData.length : originalFlashcardDeck.filter(q => q.category === currentCategory).length;
            const progress = (knownCards / total) * 100;
            flashcardProgressFill.style.width = `${progress}%`;
            flashcardProgressPercent.textContent = `${Math.round(progress)}%`;
            flashcardRemaining.textContent = `Remaining: ${flashcardDeck.length}`;
            flashcardKnown.textContent = `Known: ${knownCards}`;
            flashcardTotal.textContent = `Total: ${total}`;
        }

        function showFlashcardCompletion() {
            flashcardModeContainer.style.display = 'none';
            flashcardCompletion.classList.add('show');
        }

        function restartFlashcardMode() {
            flashcardCompletion.classList.remove('show');
            startFlashcardMode();
            flashcardModeContainer.style.display = 'flex';
        }

        // Initialize the app when DOM is loaded
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>