<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Embryology Quiz Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #4895ef;
            --primary-dark: #3a0ca3;
            --secondary: #f72585;
            --success: #4cc9f0;
            --warning: #f9c74f;
            --danger: #f94144;
            --info: #577590;
            --gray-50: #f8f9fa;
            --gray-100: #f1f3f5;
            --gray-200: #e9ecef;
            --gray-300: #dee2e6;
            --gray-400: #ced4da;
            --gray-500: #adb5bd;
            --gray-600: #868e96;
            --gray-700: #495057;
            --gray-800: #343a40;
            --gray-900: #212529;
            --bg-primary: var(--gray-900);
            --bg-secondary: #1a1d21;
            --bg-tertiary: #2c303a;
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --text-tertiary: rgba(255, 255, 255, 0.5);
            --card-bg: rgba(35, 39, 47, 0.95);
            --card-border: rgba(255, 255, 255, 0.1);
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.15), 0 5px 10px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.2);
            --transition-base: all 0.2s ease-in-out;
            --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-bounce: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --radius-2xl: 24px;
            --header-height: 70px;
            --max-width: 900px;
            --side-padding: 1.5rem;
        }

        [data-theme="light"] {
            --bg-primary: #f5f7fa;
            --bg-secondary: #ffffff;
            --bg-tertiary: #eef2f6;
            --text-primary: #1a1d21;
            --text-secondary: rgba(26, 29, 33, 0.7);
            --text-tertiary: rgba(26, 29, 33, 0.5);
            --card-bg: rgba(255, 255, 255, 0.95);
            --card-border: rgba(0, 0, 0, 0.1);
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.05), 0 1px 2px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.08), 0 5px 10px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.08);
        }

        [data-theme="minimal"] {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f1f5f9;
            --text-primary: #0f172a;
            --text-secondary: #334155;
            --text-tertiary: #64748b;
            --card-bg: #ffffff;
            --card-border: #e2e8f0;
            --primary: #0ea5e9;
            --primary-light: #38bdf8;
            --primary-dark: #0284c7;
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 4px 6px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            transition: var(--transition-base);
            line-height: 1.6;
            font-weight: 400;
        }

        header {
            height: var(--header-height);
            background: var(--bg-secondary);
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 var(--side-padding);
            transition: var(--transition-base);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 700;
            font-size: 1.25rem;
            color: var(--primary);
        }

        .logo-icon {
            font-size: 1.5rem;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .control-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition-base);
            position: relative;
        }

        .control-btn:hover {
            background: var(--bg-tertiary);
            transform: translateY(-2px);
        }

        .control-btn i {
            font-size: 1.1rem;
        }

        .badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--secondary);
            color: white;
            font-size: 0.7rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        main {
            flex: 1;
            padding: 2rem var(--side-padding);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .quiz-container {
            width: 100%;
            max-width: var(--max-width);
            background: var(--card-bg);
            border-radius: var(--radius-xl);
            padding: 2rem;
            box-shadow: var(--shadow-lg);
            transition: var(--transition-smooth);
            border: 1px solid var(--card-border);
            backdrop-filter: blur(10px);
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .quiz-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .quiz-subtitle {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .stats-container {
            display: flex;
            gap: 1rem;
        }

        .stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.5rem 0.75rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            min-width: 70px;
        }

        .stat-value {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .progress-container {
            width: 100%;
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            overflow: hidden;
            margin: 1.5rem 0;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-light), var(--primary));
            border-radius: var(--radius-lg);
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            100% { left: 100%; }
        }

        .question-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .question-tags {
            display: flex;
            gap: 0.5rem;
        }

        .tag {
            padding: 0.25rem 0.75rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .question-number {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            line-height: 1.4;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 1rem 1.25rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: var(--transition-smooth);
            border: 1px solid transparent;
        }

        .option:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-light);
        }

        .option.selected {
            background: rgba(67, 97, 238, 0.1);
            border-color: var(--primary);
            animation: pulse 0.3s ease;
        }

        .option.correct {
            background: rgba(76, 201, 240, 0.1);
            border-color: var(--success);
        }

        .option.incorrect {
            background: rgba(249, 65, 68, 0.1);
            border-color: var(--danger);
        }

        .option-letter {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-md);
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-right: 1rem;
            flex-shrink: 0;
            transition: var(--transition-base);
            box-shadow: var(--shadow-sm);
        }

        .option.selected .option-letter {
            background: var(--primary);
            color: white;
        }

        .option.correct .option-letter {
            background: var(--success);
            color: white;
        }

        .option.incorrect .option-letter {
            background: var(--danger);
            color: white;
        }

        .option-text {
            flex: 1;
        }

        .bookmark-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1rem;
            transition: var(--transition-base);
        }

        .bookmark-btn:hover {
            color: var(--primary);
        }

        .bookmark-btn.bookmarked {
            color: var(--warning);
        }

        .feedback {
            padding: 1rem;
            border-radius: var(--radius-lg);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            animation: fadeIn 0.3s ease;
        }

        .feedback.correct {
            background: rgba(76, 201, 240, 0.1);
            color: var(--success);
        }

        .feedback.incorrect {
            background: rgba(249, 65, 68, 0.1);
            color: var(--danger);
        }

        .feedback-icon {
            font-size: 1.5rem;
        }

        .explanation-container {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }

        .explanation-container.expanded {
            max-height: 500px;
        }

        .explanation {
            padding: 1.25rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            margin-top: 1rem;
            border-left: 4px solid var(--primary);
        }

        .explanation-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 1.5rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius-lg);
            border: none;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition-base);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-secondary:hover:not(:disabled) {
            background: var(--bg-secondary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .results-container {
            text-align: center;
            animation: fadeIn 0.5s ease;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto 1.5rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: conic-gradient(var(--primary) 0% var(--p, 0%), var(--bg-tertiary) var(--p, 0%) 100%);
            position: relative;
        }

        .score-circle::before {
            content: '';
            position: absolute;
            width: 130px;
            height: 130px;
            border-radius: 50%;
            background: var(--card-bg);
        }

        .score-text {
            position: relative;
            z-index: 1;
        }

        .score-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
        }

        .score-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .results-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin: 2rem 0;
        }

        .result-stat {
            padding: 1rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
        }

        .result-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.25rem;
        }

        .result-stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .review-section {
            margin-top: 2rem;
            text-align: left;
        }

        .review-title {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        .review-item {
            padding: 1.25rem;
            border-radius: var(--radius-lg);
            margin-bottom: 1rem;
            background: var(--bg-tertiary);
        }

        .review-item.correct {
            border-left: 4px solid var(--success);
        }

        .review-item.incorrect {
            border-left: 4px solid var(--danger);
        }

        .review-question {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .review-answer {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .review-explanation {
            font-size: 0.85rem;
            color: var(--text-secondary);
            padding-top: 0.5rem;
            border-top: 1px solid var(--card-border);
        }

        footer {
            padding: 1.5rem var(--side-padding);
            background: var(--bg-secondary);
            text-align: center;
            font-size: 0.85rem;
            color: var(--text-secondary);
            box-shadow: 0 -1px 3px rgba(0, 0, 0, 0.1);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes bounceIn {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        .pulse {
            animation: pulse 0.5s ease;
        }

        .bounce-in {
            animation: bounceIn 0.5s ease;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .text-center {
            text-align: center;
        }

        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 2rem; }

        @media (max-width: 768px) {
            :root {
                --side-padding: 1rem;
                --header-height: 60px;
            }

            .quiz-container {
                padding: 1.5rem;
            }

            .quiz-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .stats-container {
                width: 100%;
                justify-content: space-between;
            }

            .results-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .score-circle {
                width: 120px;
                height: 120px;
            }

            .score-circle::before {
                width: 100px;
                height: 100px;
            }

            .score-value {
                font-size: 2rem;
            }
        }

        @media (max-width: 480px) {
            .navigation {
                flex-direction: column;
                gap: 0.75rem;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            .option {
                padding: 0.75rem;
            }

            .option-letter {
                width: 28px;
                height: 28px;
                margin-right: 0.75rem;
            }
        }
    </style>
</head>
<body data-theme="dark">
    <header>
        <div class="logo">
            <i class="fas fa-brain logo-icon"></i>
            <span>EmbryoQuiz</span>
        </div>
        <div class="header-controls">
            <button class="control-btn" id="theme-toggle" aria-label="Toggle theme">
                <i class="fas fa-moon"></i>
            </button>
            <button class="control-btn" id="sound-toggle" aria-label="Toggle sound">
                <i class="fas fa-volume-up"></i>
            </button>
            <button class="control-btn" id="stats-btn" aria-label="View statistics">
                <i class="fas fa-chart-line"></i>
                <span class="badge" id="bookmarks-count">0</span>
            </button>
        </div>
    </header>

    <main>
        <div class="quiz-container">
            <div class="quiz-header">
                <div>
                    <h1 class="quiz-title">Advanced Embryology Quiz</h1>
                    <p class="quiz-subtitle">Test your knowledge with professional questions and detailed explanations</p>
                </div>
                <div class="stats-container">
                    <div class="stat">
                        <span class="stat-value" id="score">0</span>
                        <span class="stat-label">Score</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="timer">00:00</span>
                        <span class="stat-label">Time</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="streak">0</span>
                        <span class="stat-label">Streak</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="category">All</span>
                        <span class="stat-label">Category</span>
                    </div>
                </div>
            </div>

            <div class="progress-container">
                <div class="progress-bar" id="progress-bar" style="width: 10%"></div>
            </div>

            <div class="question-meta">
                <div class="question-tags">
                    <span class="tag" id="category-tag">Neuro</span>
                    <span class="tag" id="difficulty-tag">Medium</span>
                </div>
                <button class="bookmark-btn" id="bookmark-btn" aria-label="Bookmark question">
                    <i class="fas fa-bookmark"></i>
                </button>
            </div>
            <div class="question-number">Question <span id="current-question">1</span> of <span id="total-questions">10</span></div>
            <div class="question-text" id="question">Which part of the brain is responsible for coordinating skeletal muscle contractions?</div>

            <div class="options-grid" id="options-container">
                <div class="option">
                    <div class="option-letter">A</div>
                    <div class="option-text">Cerebrum</div>
                </div>
                <div class="option">
                    <div class="option-letter">B</div>
                    <div class="option-text">Cerebellum</div>
                </div>
                <div class="option">
                    <div class="option-letter">C</div>
                    <div class="option-text">Pons</div>
                </div>
                <div class="option">
                    <div class="option-letter">D</div>
                    <div class="option-text">Midbrain</div>
                </div>
            </div>

            <div class="feedback correct" id="feedback" style="display: none;">
                <i class="fas fa-check-circle feedback-icon"></i>
                <div class="feedback-text">Correct! Well done.</div>
            </div>

            <button class="btn btn-secondary" id="show-explanation-btn" style="display: none;">
                <i class="fas fa-info-circle"></i> Show Explanation
            </button>

            <div class="explanation-container" id="explanation-container">
                <div class="explanation">
                    <div class="explanation-title">Explanation:</div>
                    <div id="explanation-text">The cerebellum, located posterior to the brainstem, is the 'little brain.' It compares intended movements with actual movements to ensure smooth, coordinated skeletal muscle activity and maintain posture and balance.</div>
                </div>
            </div>

            <div class="navigation">
                <button class="btn btn-secondary" id="prev-btn" disabled>
                    <i class="fas fa-arrow-left"></i> Previous
                </button>
                <button class="btn btn-primary" id="next-btn">
                    Next Question <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
    </main>

    <footer>
        &copy; 2025 EmbryoQuiz | Advanced Embryology Learning Platform | All Rights Reserved
    </footer>

    <script>
        const questions =  
        
       [
    {
        "question": "What property allows nerve tissue to generate action potentials?",
        "options": ["Contractility", "Excitability", "Elasticity", "Secretion", "Adhesion"],
        "answer": 1,
        "correctAnswer": "Excitability",
        "explanation": "Excitability enables nerve tissue to respond to stimuli by generating action potentials through rapid membrane potential changes."
    },
    {
        "question": "Which type of stimulus does NOT typically trigger excitability in nerves?",
        "options": ["Electrical", "Mechanical", "Thermal", "Chemical", "All can trigger excitability"],
        "answer": 3,
        "correctAnswer": "Chemical",
        "explanation": "Mechanical, electrical, and thermal stimuli trigger excitability in nerves, but chemical stimuli are not typically mentioned in this context."
    },
    {
        "question": "What is the role of glial cells in the nervous system?",
        "options": ["Generate and conduct action potentials", "Provide structural and functional support to neurons", "Produce neurotransmitters exclusively", "Form synapses with muscles", "Conduct signals to the periphery"],
        "answer": 1,
        "correctAnswer": "Provide structural and functional support to neurons",
        "explanation": "Glial cells provide structural and functional support to neurons, including nutrient transfer and forming the blood-brain barrier, but do not generate action potentials."
    },
    {
        "question": "Which glial cell type forms the blood-brain barrier?",
        "options": ["Microglia", "Ependymal cells", "Astrocytes", "Schwann cells", "Satellite cells"],
        "answer": 2,
        "correctAnswer": "Astrocytes",
        "explanation": "Astrocytes contribute to the blood-brain barrier, regulating substance exchange to protect the brain."
    },
    {
        "question": "Which glial cell is responsible for myelin sheath formation in the CNS?",
        "options": ["Oligodendrocytes", "Schwann cells", "Microglia", "Ependymal cells", "Satellite cells"],
        "answer": 0,
        "correctAnswer": "Oligodendrocytes",
        "explanation": "Oligodendrocytes form myelin sheaths in the CNS, while Schwann cells do so in the PNS."
    },
    {
        "question": "What is the function of ependymal cells?",
        "options": ["Form myelin sheaths", "Act as macrophages", "Facilitate cerebrospinal fluid conduction", "Form the blood-brain barrier", "Conduct action potentials"],
        "answer": 2,
        "correctAnswer": "Facilitate cerebrospinal fluid conduction",
        "explanation": "Ependymal cells line brain ventricles and facilitate cerebrospinal fluid (CSF) conduction."
    },
    {
        "question": "Which glial cell type’s function is least understood?",
        "options": ["Astrocytes", "Microglia", "Satellite cells", "Oligodendrocytes", "Schwann cells"],
        "answer": 2,
        "correctAnswer": "Satellite cells",
        "explanation": "The function of satellite cells in the PNS is not fully understood, though they support neuronal cell bodies."
    },
    {
        "question": "Which neuron region is specialized for transmitting signals to other cells?",
        "options": ["Dendrites", "Cell body", "Axon", "Myelin sheath", "Nucleus"],
        "answer": 2,
        "correctAnswer": "Axon",
        "explanation": "The axon conducts action potentials away from the cell body to other neurons or effectors."
    },
    {
        "question": "Which type of neuron is characterized by multiple dendrites and one axon?",
        "options": ["Unipolar", "Bipolar", "Multipolar", "Pseudounipolar", "Anaxonic"],
        "answer": 2,
        "correctAnswer": "Multipolar",
        "explanation": "Multipolar neurons, common in the CNS, have multiple dendrites and a single axon."
    },
    {
        "question": "Where are bipolar neurons typically found?",
        "options": ["Dorsal root ganglia", "Cerebellum", "Retina and inner ear", "Motor cortex", "Peripheral ganglia"],
        "answer": 2,
        "correctAnswer": "Retina and inner ear",
        "explanation": "Bipolar neurons are found in the retina, inner ear, and nasal mucous membrane."
    },
    {
        "question": "Which neurons transmit sensory information to the CNS?",
        "options": ["Motor neurons", "Association neurons", "Sensory neurons", "Interneurons", "Efferent neurons"],
        "answer": 2,
        "correctAnswer": "Sensory neurons",
        "explanation": "Sensory (afferent) neurons conduct signals from peripheral receptors to the CNS."
    },
    {
        "question": "What is the resting membrane potential of a typical neuron?",
        "options": ["-30 mV", "-65 mV", "-90 mV", "0 mV", "+30 mV"],
        "answer": 2,
        "correctAnswer": "-90 mV",
        "explanation": "The resting membrane potential is approximately -90 mV, with the inside more negative due to ion distribution."
    },
    {
        "question": "What is the primary factor maintaining the resting membrane potential?",
        "options": ["Na+/K+ pump activity", "Differential permeability to K+ and Na+", "Ca2+ influx", "Cl- efflux", "Equal ion distribution"],
        "answer": 1,
        "correctAnswer": "Differential permeability to K+ and Na+",
        "explanation": "Higher permeability to K+ than Na+ through leak channels primarily maintains the RMP."
    },
    {
        "question": "What is the contribution of the Na+/K+ pump to the RMP?",
        "options": ["-86 mV", "-4 mV", "+8 mV", "-65 mV", "0 mV"],
        "answer": 1,
        "correctAnswer": "-4 mV",
        "explanation": "The Na+/K+ pump, moving 3 Na+ out and 2 K+ in, contributes approximately -4 mV to the RMP."
    },
    {
        "question": "What role do intracellular non-diffusible anions play in the RMP?",
        "options": ["They trigger action potentials", "They contribute to the negative charge inside the cell", "They open Na+ channels", "They pump K+ out of the cell", "They neutralize the membrane potential"],
        "answer": 1,
        "correctAnswer": "They contribute to the negative charge inside the cell",
        "explanation": "Non-diffusible anions, like proteins, contribute to the negative charge inside the cell, aiding the RMP."
    },
    {
        "question": "What triggers the opening of voltage-gated Na+ channels during an action potential?",
        "options": ["Membrane potential reaching -90 mV", "Membrane potential reaching -65 mV", "K+ efflux", "Ca2+ influx", "Cl- influx"],
        "answer": 1,
        "correctAnswer": "Membrane potential reaching -65 mV",
        "explanation": "The threshold potential of -65 mV triggers the opening of voltage-gated Na+ channels, initiating depolarization."
    },
    {
        "question": "What occurs during the depolarization phase of an action potential?",
        "options": ["K+ efflux increases", "Na+ influx causes a positive shift in membrane potential", "Ca2+ channels open", "Cl- ions enter the cell", "Na+/K+ pump stops"],
        "answer": 1,
        "correctAnswer": "Na+ influx causes a positive shift in membrane potential",
        "explanation": "Depolarization is driven by Na+ influx, shifting the membrane potential toward positive values."
    },
    {
        "question": "What causes the repolarization phase of an action potential?",
        "options": ["Na+ channel opening", "K+ channel opening and efflux", "Ca2+ channel opening", "Cl- channel opening", "Na+/K+ pump activation"],
        "answer": 1,
        "correctAnswer": "K+ channel opening and efflux",
        "explanation": "Repolarization occurs when voltage-gated K+ channels open, allowing K+ efflux to restore the negative RMP."
    },
    {
        "question": "What is the undershoot in an action potential?",
        "options": ["A brief depolarization above 0 mV", "A brief hyperpolarization below the RMP", "The threshold potential", "The peak of depolarization", "The resting phase"],
        "answer": 1,
        "correctAnswer": "A brief hyperpolarization below the RMP",
        "explanation": "The undershoot is a brief hyperpolarization below the RMP due to slow-closing K+ channels."
    },
    {
        "question": "During which period can no action potential be generated, regardless of stimulus strength?",
        "options": ["Relative refractory period", "Absolute refractory period", "Depolarization phase", "Repolarization phase", "Resting phase"],
        "answer": 1,
        "correctAnswer": "Absolute refractory period",
        "explanation": "The absolute refractory period prevents new action potentials due to inactivated Na+ channels."
    },
    {
        "question": "What is required to generate an action potential during the relative refractory period?",
        "options": ["A subthreshold stimulus", "A suprathreshold stimulus", "No stimulus", "Closure of K+ channels", "Opening of Ca2+ channels"],
        "answer": 1,
        "correctAnswer": "A suprathreshold stimulus",
        "explanation": "A suprathreshold stimulus is needed during the RRP due to partial Na+ channel inactivation and open K+ channels."
    },
    {
        "question": "What drives the positive-feedback mechanism in action potential generation?",
        "options": ["K+ channel opening", "Na+ channel opening", "Ca2+ channel opening", "Cl- channel opening", "Na+/K+ pump activity"],
        "answer": 1,
        "correctAnswer": "Na+ channel opening",
        "explanation": "The positive-feedback loop is driven by voltage-gated Na+ channel opening, amplifying depolarization."
    },
    {
        "question": "Why are action potentials considered all-or-none?",
        "options": ["They vary in amplitude with stimulus strength", "They have a consistent amplitude once threshold is reached", "They can be summated", "They decrease with distance", "They depend on K+ influx"],
        "answer": 1,
        "correctAnswer": "They have a consistent amplitude once threshold is reached",
        "explanation": "Action potentials are all-or-none, with consistent amplitude once the threshold is reached."
    },
    {
        "question": "How does an action potential propagate in unmyelinated axons?",
        "options": ["Saltatory conduction", "Continuous conduction", "Chemical conduction", "Graded conduction", "Bidirectional conduction only"],
        "answer": 1,
        "correctAnswer": "Continuous conduction",
        "explanation": "Unmyelinated axons use continuous conduction, with action potentials spreading sequentially along the entire membrane."
    },
    {
        "question": "What is the role of nodes of Ranvier in myelinated axons?",
        "options": ["They produce neurotransmitters", "They enable saltatory conduction", "They form the myelin sheath", "They block ion channels", "They store Ca2+"],
        "answer": 1,
        "correctAnswer": "They enable saltatory conduction",
        "explanation": "Nodes of Ranvier are gaps where action potentials regenerate, enabling faster saltatory conduction."
    },
    {
        "question": "Which factor increases action potential conduction speed?",
        "options": ["Smaller nerve fiber diameter", "Lack of myelination", "Increased myelination", "Longer neuron length", "Older age"],
        "answer": 2,
        "correctAnswer": "Increased myelination",
        "explanation": "Increased myelination enhances conduction speed by enabling saltatory conduction."
    },
    {
        "question": "Which nerve fiber type has the fastest conduction velocity?",
        "options": ["Type Aα fibers", "Type Aβ fibers", "Type Aσ fibers", "Type B fibers", "Type C fibers"],
        "answer": 0,
        "correctAnswer": "Type Aα fibers",
        "explanation": "Type Aα fibers, myelinated with a 10-20 µm diameter, have the fastest conduction velocity (60-120 m/s)."
    },
    {
        "question": "What is the primary function of Type C fibers?",
        "options": ["Motor to skeletal muscle", "Postganglionic autonomic functions", "Somatic sensory functions", "Preganglionic autonomic functions", "Proprioception"],
        "answer": 1,
        "correctAnswer": "Postganglionic autonomic functions",
        "explanation": "Type C fibers, unmyelinated, primarily serve postganglionic autonomic functions with a slow conduction velocity (0.5-2 m/s)."
    },
    {
        "question": "What initiates synaptic transmission at the axon terminal?",
        "options": ["Na+ influx", "K+ efflux", "Ca2+ influx", "Cl- influx", "Na+/K+ pump activation"],
        "answer": 2,
        "correctAnswer": "Ca2+ influx",
        "explanation": "Ca2+ influx through voltage-gated channels triggers neurotransmitter release at the axon terminal."
    },
    {
        "question": "What is the site of chemical interplay in synaptic transmission?",
        "options": ["Axon hillock", "Synaptic cleft", "Dendrites", "Myelin sheath", "Cell body"],
        "answer": 1,
        "correctAnswer": "Synaptic cleft",
        "explanation": "The synaptic cleft is where neurotransmitters diffuse and bind to postsynaptic receptors, facilitating chemical transmission."
    },
    {
        "question": "What is an excitatory postsynaptic potential (EPSP)?",
        "options": ["A hyperpolarization inhibiting action potentials", "A depolarization bringing the membrane closer to threshold", "A constant membrane potential", "A repolarization phase", "A refractory period response"],
        "answer": 1,
        "correctAnswer": "A depolarization bringing the membrane closer to threshold",
        "explanation": "EPSPs are graded depolarizations from cation influx, moving the membrane potential closer to threshold."
    },
    {
        "question": "What causes an inhibitory postsynaptic potential (IPSP)?",
        "options": ["Cation influx", "Anion influx", "Na+ channel inactivation", "K+ channel closure", "Ca2+ channel opening"],
        "answer": 1,
        "correctAnswer": "Anion influx",
        "explanation": "IPSPs result from anion (e.g., Cl-) influx, causing hyperpolarization and inhibiting action potentials."
    },
    {
        "question": "What is temporal summation in synaptic transmission?",
        "options": ["Multiple neurons stimulating a postsynaptic neuron", "A single neuron stimulating a postsynaptic neuron repeatedly", "Neurotransmitter degradation", "Continuous conduction", "Synaptic delay"],
        "answer": 1,
        "correctAnswer": "A single neuron stimulating a postsynaptic neuron repeatedly",
        "explanation": "Temporal summation occurs when a single presynaptic neuron fires repeatedly, summing EPSPs to reach threshold."
    },
    {
        "question": "What defines spatial summation?",
        "options": ["A single neuron firing repeatedly", "Multiple neurons stimulating a postsynaptic neuron", "Neurotransmitter reuptake", "Saltatory conduction", "Hyperpolarization"],
        "answer": 1,
        "correctAnswer": "Multiple neurons stimulating a postsynaptic neuron",
        "explanation": "Spatial summation involves multiple presynaptic neurons stimulating a postsynaptic neuron, combining EPSPs to reach threshold."
    },
    {
        "question": "What is synaptic fatigue?",
        "options": ["Increased postsynaptic response", "Decreased postsynaptic response after repetitive stimulation", "Faster conduction speed", "Persistence of signals after stimulation stops", "Opening of additional ion channels"],
        "answer": 1,
        "correctAnswer": "Decreased postsynaptic response after repetitive stimulation",
        "explanation": "Synaptic fatigue occurs when postsynaptic responses decrease due to neurotransmitter depletion after repetitive stimulation."
    },
    {
        "question": "What is synaptic after-discharge?",
        "options": ["Immediate cessation of postsynaptic signals", "Persistence of postsynaptic signals after presynaptic input stops", "Increased presynaptic neurotransmitter release", "Closure of postsynaptic ion channels", "Faster action potential conduction"],
        "answer": 1,
        "correctAnswer": "Persistence of postsynaptic signals after presynaptic input stops",
        "explanation": "Synaptic after-discharge refers to continued postsynaptic signaling after presynaptic stimulation ceases."
    },
    {
        "question": "What is synaptic potentiation?",
        "options": ["Decreased postsynaptic response", "Increased postsynaptic response due to prior stimulation", "Blocked neurotransmitter release", "Reduced synaptic delay", "Inhibitory hyperpolarization"],
        "answer": 1,
        "correctAnswer": "Increased postsynaptic response due to prior stimulation",
        "explanation": "Synaptic potentiation (facilitation) enhances postsynaptic response due to prior stimulation."
    },
    {
        "question": "How are neurotransmitters removed from the synaptic cleft?",
        "options": ["Conversion to action potentials", "Enzymatic degradation, diffusion, or reuptake", "Binding to K+ channels", "Storage in the myelin sheath", "Active transport into the postsynaptic cell"],
        "answer": 1,
        "correctAnswer": "Enzymatic degradation, diffusion, or reuptake",
        "explanation": "Neurotransmitters are cleared via enzymatic degradation, diffusion, or reuptake into the presynaptic neuron."
    },
    {
        "question": "What type of junction involves a neuron and a muscle?",
        "options": ["Neuroneuronal junction", "Neuromuscular junction", "Neuroglandular junction", "Neurosensory junction", "Neuroeffector junction"],
        "answer": 1,
        "correctAnswer": "Neuromuscular junction",
        "explanation": "A neuromuscular junction is the synapse between a neuron and a muscle cell, facilitating muscle contraction."
    },
    {
        "question": "Which glial cell type acts as CNS macrophages?",
        "options": ["Astrocytes", "Microglia", "Ependymal cells", "Oligodendrocytes", "Satellite cells"],
        "answer": 1,
        "correctAnswer": "Microglia",
        "explanation": "Microglia act as macrophages in the CNS, removing debris and pathogens."
    },
    {
        "question": "What is the primary source of the -86 mV component in the RMP?",
        "options": ["Na+/K+ pump", "K+ leak channels", "Na+ leak channels", "Ca2+ channels", "Cl- channels"],
        "answer": 1,
        "correctAnswer": "K+ leak channels",
        "explanation": "K+ leak channels contribute approximately -86 mV to the RMP due to higher K+ permeability, per the Nernst equation."
    },
    {
        "question": "What is the role of the Na+/K+ pump in maintaining the RMP?",
        "options": ["It pumps equal Na+ and K+ ions", "It pumps 3 Na+ out and 2 K+ in", "It opens voltage-gated channels", "It allows Cl- influx", "It neutralizes the membrane potential"],
        "answer": 1,
        "correctAnswer": "It pumps 3 Na+ out and 2 K+ in",
        "explanation": "The electrogenic Na+/K+ pump moves 3 Na+ out and 2 K+ in, contributing a small negative potential to the RMP."
    },
    {
        "question": "What happens during the overshoot phase of an action potential?",
        "options": ["Membrane potential becomes negative", "Membrane potential exceeds 0 mV", "K+ channels close rapidly", "Na+ channels remain closed", "Ca2+ influx dominates"],
        "answer": 1,
        "correctAnswer": "Membrane potential exceeds 0 mV",
        "explanation": "The overshoot occurs when Na+ influx causes the membrane potential to exceed 0 mV during depolarization."
    },
    {
        "question": "What causes the undershoot during an action potential?",
        "options": ["Rapid Na+ channel opening", "Slow K+ channel closure", "Ca2+ channel inactivation", "Increased Na+/K+ pump activity", "Cl- influx"],
        "answer": 1,
        "correctAnswer": "Slow K+ channel closure",
        "explanation": "The undershoot (hyperpolarization) results from slow-closing K+ channels, allowing excess K+ efflux."
    },
    {
        "question": "What prevents action potential generation during the absolute refractory period?",
        "options": ["Open K+ channels", "Inactivated Na+ channels", "Closed Ca2+ channels", "Active Na+/K+ pump", "Hyperpolarized membrane"],
        "answer": 1,
        "correctAnswer": "Inactivated Na+ channels",
        "explanation": "Inactivated Na+ channels during the absolute refractory period prevent new action potentials."
    },
    {
        "question": "What is the significance of the all-or-none property of action potentials?",
        "options": ["Variable amplitude based on stimulus strength", "Consistent amplitude once threshold is reached", "Ability to summate with other potentials", "Dependence on K+ influx", "Decreasing amplitude with distance"],
        "answer": 1,
        "correctAnswer": "Consistent amplitude once threshold is reached",
        "explanation": "The all-or-none property ensures action potentials have consistent amplitude once the threshold is reached."
    },
    {
        "question": "How does saltatory conduction differ from continuous conduction?",
        "options": ["It occurs in unmyelinated axons", "It involves action potentials jumping between nodes of Ranvier", "It is slower than continuous conduction", "It requires more energy", "It involves chemical transmission"],
        "answer": 1,
        "correctAnswer": "It involves action potentials jumping between nodes of Ranvier",
        "explanation": "Saltatory conduction in myelinated axons involves action potentials regenerating at nodes of Ranvier, unlike continuous conduction in unmyelinated axons."
    },
    {
        "question": "Which factor slows action potential conduction?",
        "options": ["Increased myelination", "Larger nerve fiber diameter", "Younger age (5-15 years)", "Longer neuron length", "Higher Na+ channel density"],
        "answer": 3,
        "correctAnswer": "Longer neuron length",
        "explanation": "Longer neuron length slows conduction speed due to the greater distance the action potential must travel."
    },
    {
        "question": "Which nerve fiber type has a diameter of 1-6 µm?",
        "options": ["Type Aα fibers", "Type Aβ fibers", "Type Aσ and Aγ fibers", "Type B fibers", "Type C fibers"],
        "answer": 2,
        "correctAnswer": "Type Aσ and Aγ fibers",
        "explanation": "Type Aσ and Aγ fibers, myelinated, have a diameter of 1-6 µm and a conduction velocity of 6-30 m/s."
    },
    {
        "question": "What is the role of Type Aβ fibers?",
        "options": ["Postganglionic autonomic functions", "Motor functions to skeletal muscle", "Preganglionic autonomic functions", "Motor functions with 5-10 µm diameter", "Somatic sensory functions only"],
        "answer": 3,
        "correctAnswer": "Motor functions with 5-10 µm diameter",
        "explanation": "Type Aβ fibers, myelinated with a 5-10 µm diameter, serve motor functions and have a conduction velocity of 30-60 m/s."
    },
    {
        "question": "What triggers neurotransmitter release at the synaptic knob?",
        "options": ["Na+ influx", "K+ efflux", "Ca2+ influx", "Cl- influx", "Na+/K+ pump activation"],
        "answer": 2,
        "correctAnswer": "Ca2+ influx",
        "explanation": "Ca2+ influx through voltage-gated channels triggers neurotransmitter exocytosis at the synaptic knob."
    },
    {
        "question": "What converts an electrical signal to a chemical signal in a synapse?",
        "options": ["Axon hillock", "Synaptic knob", "Dendrites", "Myelin sheath", "Cell body"],
        "answer": 1,
        "correctAnswer": "Synaptic knob",
        "explanation": "The synaptic knob releases neurotransmitters, converting an electrical action potential into a chemical signal."
    },
    {
        "question": "What is the effect of an EPSP on the postsynaptic membrane?",
        "options": ["It hyperpolarizes the membrane", "It brings the membrane closer to threshold", "It triggers an action potential directly", "It closes cation channels", "It activates the Na+/K+ pump"],
        "answer": 1,
        "correctAnswer": "It brings the membrane closer to threshold",
        "explanation": "EPSPs depolarize the postsynaptic membrane, bringing it closer to the action potential threshold."
    },
    {
        "question": "What results from anion channel opening in the postsynaptic membrane?",
        "options": ["Excitatory postsynaptic potential", "Inhibitory postsynaptic potential", "Action potential generation", "Neurotransmitter release", "Membrane depolarization"],
        "answer": 1,
        "correctAnswer": "Inhibitory postsynaptic potential",
        "explanation": "Anion (e.g., Cl-) influx causes hyperpolarization, resulting in an inhibitory postsynaptic potential (IPSP)."
    },
    {
        "question": "What is required for spatial summation to trigger an action potential?",
        "options": ["A single neuron firing repeatedly", "Multiple neurons stimulating a postsynaptic neuron", "Neurotransmitter degradation", "Continuous conduction", "Synaptic delay"],
        "answer": 1,
        "correctAnswer": "Multiple neurons stimulating a postsynaptic neuron",
        "explanation": "Spatial summation involves multiple presynaptic neurons stimulating a postsynaptic neuron, combining EPSPs to reach threshold."
    },
    {
        "question": "What is a characteristic of synaptic transmission?",
        "options": ["Bidirectional conduction", "Synaptic delay of 0.5-1.0 ms", "No synaptic delay", "Constant postsynaptic response", "Electrical transmission only"],
        "answer": 1,
        "correctAnswer": "Synaptic delay of 0.5-1.0 ms",
        "explanation": "Chemical synaptic transmission involves a delay of 0.5-1.0 ms due to neurotransmitter release and diffusion."
    },
    {
        "question": "Which method is NOT used to remove neurotransmitters from the synaptic cleft?",
        "options": ["Enzymatic degradation", "Diffusion", "Reuptake", "Conversion to action potentials", "Active transport into glial cells"],
        "answer": 3,
        "correctAnswer": "Conversion to action potentials",
        "explanation": "Neurotransmitters are removed via enzymatic degradation, diffusion, or reuptake, not by conversion to action potentials."
    },
    {
        "question": "What type of junction involves a neuron and a gland?",
        "options": ["Neuroneuronal junction", "Neuromuscular junction", "Neuroglandular junction", "Neurosensory junction", "Neuroeffector junction"],
        "answer": 2,
        "correctAnswer": "Neuroglandular junction",
        "explanation": "A neuroglandular junction is the synapse between a neuron and a gland cell."
    },
    {
        "question": "Which neurons integrate sensory information and provide feedback via motor neurons?",
        "options": ["Sensory neurons", "Motor neurons", "Association neurons", "Afferent neurons", "Efferent neurons"],
        "answer": 2,
        "correctAnswer": "Association neurons",
        "explanation": "Association neurons (interneurons) integrate sensory information and coordinate responses via motor neurons."
    },
    {
        "question": "What distinguishes graded potentials from action potentials?",
        "options": ["Graded potentials are all-or-none", "Action potentials can be summated", "Graded potentials vary in amplitude and can summate", "Action potentials decrease with distance", "Graded potentials have a refractory period"],
        "answer": 2,
        "correctAnswer": "Graded potentials vary in amplitude and can summate",
        "explanation": "Graded potentials vary in amplitude and can summate, unlike the all-or-none action potentials."
    }
]

;

        // DOM Elements
        let body = document.body;
        let questionElement = document.getElementById('question');
        let optionsContainer = document.getElementById('options-container');
        let currentQuestionElement = document.getElementById('current-question');
        let totalQuestionsElement = document.getElementById('total-questions');
        let progressBar = document.getElementById('progress-bar');
        let prevButton = document.getElementById('prev-btn');
        let nextButton = document.getElementById('next-btn');
        let feedbackElement = document.getElementById('feedback');
        let timerElement = document.getElementById('timer');
        let scoreElement = document.getElementById('score');
        let streakElement = document.getElementById('streak');
        let categoryElement = document.getElementById('category');
        let explanationContainer = document.getElementById('explanation-container');
        let explanationTextElement = document.getElementById('explanation-text');
        let themeToggle = document.getElementById('theme-toggle');
        let soundToggle = document.getElementById('sound-toggle');
        let bookmarkBtn = document.getElementById('bookmark-btn');
        let bookmarksCount = document.getElementById('bookmarks-count');
        let categoryTag = document.getElementById('category-tag');
        let difficultyTag = document.getElementById('difficulty-tag');
        let showExplanationBtn = document.getElementById('show-explanation-btn');

        // Quiz state
        let currentQuestionIndex = 0;
        let score = 0;
        let streak = 0;
        let selectedOption = null;
        let timeStarted = null;
        let timerInterval = null;
        let timeElapsed = 0;
        let answers = [];
        let soundsEnabled = true;
        let bookmarkedQuestions = [];
        let quizHistory = [];
        let performanceMetrics = {
            categories: {},
            difficulties: { Easy: 0, Medium: 0, Hard: 0 },
            totalCorrect: 0,
            totalQuestions: 0
        };

        function initQuiz() {
            // Reset DOM elements
            scoreElement.textContent = score;
            streakElement.textContent = streak;
            timerElement.textContent = '00:00';
            totalQuestionsElement.textContent = questions.length;
            
            loadQuestion();
            startTimer();
            
            // Remove existing event listeners to prevent duplicates
            const prevBtnClone = prevButton.cloneNode(true);
            prevButton.parentNode.replaceChild(prevBtnClone, prevButton);
            const nextBtnClone = nextButton.cloneNode(true);
            nextButton.parentNode.replaceChild(nextBtnClone, nextButton);
            const themeToggleClone = themeToggle.cloneNode(true);
            themeToggle.parentNode.replaceChild(themeToggleClone, themeToggle);
            const soundToggleClone = soundToggle.cloneNode(true);
            soundToggle.parentNode.replaceChild(soundToggleClone, soundToggle);
            const bookmarkBtnClone = bookmarkBtn.cloneNode(true);
            bookmarkBtn.parentNode.replaceChild(bookmarkBtnClone, bookmarkBtn);
            const showExplanationBtnClone = showExplanationBtn.cloneNode(true);
            showExplanationBtn.parentNode.replaceChild(showExplanationBtnClone, showExplanationBtn);

            // Reassign DOM elements after cloning
            prevButton = document.getElementById('prev-btn');
            nextButton = document.getElementById('next-btn');
            themeToggle = document.getElementById('theme-toggle');
            soundToggle = document.getElementById('sound-toggle');
            bookmarkBtn = document.getElementById('bookmark-btn');
            showExplanationBtn = document.getElementById('show-explanation-btn');

            // Add event listeners
            prevButton.addEventListener('click', goToPreviousQuestion);
            nextButton.addEventListener('click', goToNextQuestion);
            themeToggle.addEventListener('click', toggleTheme);
            soundToggle.addEventListener('click', toggleSound);
            bookmarkBtn.addEventListener('click', toggleBookmark);
            showExplanationBtn.addEventListener('click', toggleExplanation);
            
            // Keyboard navigation
            document.removeEventListener('keydown', handleKeydown);
            document.addEventListener('keydown', handleKeydown);
            
            loadPreferences();
            loadQuizHistory();
            updateBookmarksCount();
        }

        function handleKeydown(e) {
            if (e.key === 'ArrowRight') {
                goToNextQuestion();
            } else if (e.key === 'ArrowLeft') {
                goToPreviousQuestion();
            } else if (e.key.toLowerCase() === 'a' || e.key === '1') {
                selectOption(0);
            } else if (e.key.toLowerCase() === 'b' || e.key === '2') {
                selectOption(1);
            } else if (e.key.toLowerCase() === 'c' || e.key === '3') {
                selectOption(2);
            } else if (e.key.toLowerCase() === 'd' || e.key === '4') {
                selectOption(3);
            } else if (e.key === 'Enter') {
                if (showExplanationBtn.style.display !== 'none') {
                    toggleExplanation();
                }
            }
        }

        function loadQuestion() {
            const question = questions[currentQuestionIndex];
            questionElement.textContent = question.question;
            currentQuestionElement.textContent = currentQuestionIndex + 1;
            categoryTag.textContent = question.category || 'Unknown';
            difficultyTag.textContent = question.difficulty || 'Medium';
            categoryElement.textContent = question.category || 'All';
            
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;
            
            optionsContainer.innerHTML = '';
            
            const optionLetters = ['A', 'B', 'C', 'D', 'E'];
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.classList.add('option', 'bounce-in');
                optionElement.setAttribute('role', 'button');
                optionElement.setAttribute('tabindex', '0');
                optionElement.setAttribute('aria-label', `Option ${optionLetters[index]}: ${option}`);
                
                const optionLetter = document.createElement('div');
                optionLetter.classList.add('option-letter');
                optionLetter.textContent = optionLetters[index];
                
                const optionText = document.createElement('div');
                optionText.classList.add('option-text');
                optionText.textContent = option;
                
                optionElement.appendChild(optionLetter);
                optionElement.appendChild(optionText);
                
                optionElement.addEventListener('click', () => selectOption(index));
                optionElement.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        selectOption(index);
                    }
                });
                
                optionsContainer.appendChild(optionElement);
            });
            
            prevButton.disabled = currentQuestionIndex === 0;
            nextButton.textContent = currentQuestionIndex === questions.length - 1 ? 'Finish Quiz' : 'Next Question';
            
            feedbackElement.style.display = 'none';
            showExplanationBtn.style.display = 'none';
            explanationContainer.classList.remove('expanded');
            
            selectedOption = null;
            
            // If the question was previously answered or skipped, display the feedback
            if (answers[currentQuestionIndex]) {
                const ans = answers[currentQuestionIndex];
                const options = document.querySelectorAll('.option');
                feedbackElement.style.display = 'flex';
                showExplanationBtn.style.display = 'block';
                explanationTextElement.textContent = question.explanation;
                options.forEach(option => option.style.pointerEvents = 'none');
                
                if (ans.selected === 'Skipped') {
                    selectedOption = null;
                    feedbackElement.classList.add('incorrect');
                    feedbackElement.innerHTML = '<i class="fas fa-times-circle feedback-icon"></i><div class="feedback-text">Skipped. The right answer is highlighted.</div>';
                    options[question.answer].classList.add('correct');
                } else {
                    const optIndex = question.options.findIndex(opt => opt === ans.selected);
                    if (optIndex !== -1) {
                        selectedOption = optIndex;
                        options[optIndex].classList.add('selected');
                        if (ans.isCorrect) {
                            feedbackElement.classList.add('correct');
                            feedbackElement.innerHTML = '<i class="fas fa-check-circle feedback-icon"></i><div class="feedback-text">Correct! Well done.</div>';
                        } else {
                            feedbackElement.classList.add('incorrect');
                            feedbackElement.innerHTML = '<i class="fas fa-times-circle feedback-icon"></i><div class="feedback-text">Incorrect. The right answer is highlighted.</div>';
                            options[question.answer].classList.add('correct');
                        }
                    }
                }
            }
            
            updateBookmarkStatus();
        }

        function selectOption(index) {
            if (selectedOption !== null || answers[currentQuestionIndex]) return;
            
            const options = document.querySelectorAll('.option');
            options.forEach(option => option.classList.remove('selected'));
            options[index].classList.add('selected');
            selectedOption = index;
            
            const question = questions[currentQuestionIndex];
            const isCorrect = index === question.answer;
            
            feedbackElement.style.display = 'flex';
            if (isCorrect) {
                feedbackElement.classList.remove('incorrect');
                feedbackElement.classList.add('correct');
                feedbackElement.innerHTML = '<i class="fas fa-check-circle feedback-icon"></i><div class="feedback-text">Correct! Well done.</div>';
                score += getScoreForDifficulty(question.difficulty);
                streak++;
                playSound('correct');
            } else {
                feedbackElement.classList.remove('correct');
                feedbackElement.classList.add('incorrect');
                feedbackElement.innerHTML = '<i class="fas fa-times-circle feedback-icon"></i><div class="feedback-text">Incorrect. The right answer is highlighted.</div>';
                options[question.answer].classList.add('correct');
                streak = 0;
                playSound('incorrect');
            }
            
            scoreElement.textContent = score;
            streakElement.textContent = streak;
            
            explanationTextElement.textContent = question.explanation;
            showExplanationBtn.style.display = 'block';
            
            answers[currentQuestionIndex] = {
                question: question.question,
                selected: question.options[index],
                correct: question.options[question.answer],
                isCorrect: isCorrect,
                explanation: question.explanation,
                category: question.category,
                difficulty: question.difficulty
            };
            
            updatePerformanceMetrics(isCorrect, question);
            
            options.forEach(option => option.style.pointerEvents = 'none');
        }

        function maybeHandleSkip() {
            if (!answers[currentQuestionIndex] && selectedOption === null) {
                const question = questions[currentQuestionIndex];
                answers[currentQuestionIndex] = {
                    question: question.question,
                    selected: 'Skipped',
                    correct: question.options[question.answer],
                    isCorrect: false,
                    explanation: question.explanation,
                    category: question.category,
                    difficulty: question.difficulty
                };
                updatePerformanceMetrics(false, question);
                streak = 0;
                streakElement.textContent = streak;
            }
        }

        function toggleExplanation() {
            explanationContainer.classList.toggle('expanded');
            showExplanationBtn.innerHTML = explanationContainer.classList.contains('expanded') ?
                '<i class="fas fa-info-circle"></i> Hide Explanation' :
                '<i class="fas fa-info-circle"></i> Show Explanation';
        }

        function getScoreForDifficulty(difficulty) {
            switch (difficulty) {
                case 'Easy': return 5;
                case 'Medium': return 10;
                case 'Hard': return 15;
                default: return 10;
            }
        }

        function updatePerformanceMetrics(isCorrect, question) {
            performanceMetrics.totalQuestions++;
            if (isCorrect) performanceMetrics.totalCorrect++;
            
            performanceMetrics.categories[question.category] = performanceMetrics.categories[question.category] || { correct: 0, total: 0 };
            performanceMetrics.categories[question.category].total++;
            if (isCorrect) performanceMetrics.categories[question.category].correct++;
            
            performanceMetrics.difficulties[question.difficulty] = performanceMetrics.difficulties[question.difficulty] || 0;
            if (isCorrect) performanceMetrics.difficulties[question.difficulty]++;
        }

        function toggleBookmark() {
            const questionId = questions[currentQuestionIndex].id;
            const index = bookmarkedQuestions.indexOf(questionId);
            if (index === -1) {
                bookmarkedQuestions.push(questionId);
                bookmarkBtn.classList.add('bookmarked');
            } else {
                bookmarkedQuestions.splice(index, 1);
                bookmarkBtn.classList.remove('bookmarked');
            }
            updateBookmarksCount();
            saveBookmarks();
        }

        function updateBookmarkStatus() {
            const questionId = questions[currentQuestionIndex].id;
            bookmarkBtn.classList.toggle('bookmarked', bookmarkedQuestions.includes(questionId));
        }

        function updateBookmarksCount() {
            bookmarksCount.textContent = bookmarkedQuestions.length;
        }

        function goToNextQuestion() {
            maybeHandleSkip();
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            } else {
                showResults();
                saveQuizHistory();
            }
        }

        function goToPreviousQuestion() {
            maybeHandleSkip();
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion();
            }
        }

        function startTimer() {
            timeStarted = new Date();
            timerInterval = setInterval(updateTimer, 1000);
        }

        function updateTimer() {
            timeElapsed++;
            
            const minutes = Math.floor(timeElapsed / 60).toString().padStart(2, '0');
            const seconds = (timeElapsed % 60).toString().padStart(2, '0');
            timerElement.textContent = `${minutes}:${seconds}`;
            
            // Optional: Add warning color for long durations (e.g., after 5 minutes)
            if (timeElapsed >= 300) {
                timerElement.style.color = 'var(--danger)';
                timerElement.classList.add('pulse');
            } else {
                timerElement.style.color = 'var(--primary)';
                timerElement.classList.remove('pulse');
            }
        }

        function showResults() {
            clearInterval(timerInterval);
            
            const quizContainer = document.querySelector('.quiz-container');
            const maxScore = questions.reduce((sum, q) => sum + getScoreForDifficulty(q.difficulty), 0);
            const percentage = ((score / maxScore) * 100).toFixed(1);
            const categoryStats = Object.entries(performanceMetrics.categories)
                .map(([category, stats]) => `${category}: ${((stats.correct / stats.total) * 100).toFixed(1)}%`)
                .join(', ');
            
            quizContainer.innerHTML = `
                <div class="results-container">
                    <h2 class="quiz-title">Quiz Completed!</h2>
                    <p class="quiz-subtitle">You've finished the embryology quiz</p>
                    
                    <div class="score-circle" style="--p: ${percentage}%">
                        <div class="score-text">
                            <div class="score-value">${score}</div>
                            <div class="score-label">Points</div>
                        </div>
                    </div>
                    
                    <div class="results-stats">
                        <div class="result-stat">
                            <div class="result-stat-value">${percentage}%</div>
                            <div class="result-stat-label">Accuracy</div>
                        </div>
                        <div class="result-stat">
                            <div class="result-stat-value">${timeElapsed}s</div>
                            <div class="result-stat-label">Time Taken</div>
                        </div>
                        <div class="result-stat">
                            <div class="result-stat-value">${streak}</div>
                            <div class="result-stat-label">Best Streak</div>
                        </div>
                        <div class="result-stat">
                            <div class="result-stat-value">${bookmarkedQuestions.length}</div>
                            <div class="result-stat-label">Bookmarked</div>
                        </div>
                    </div>
                    
                    <div class="review-section">
                        <h3 class="review-title">Performance Analytics</h3>
                        <div class="review-item">
                            <div class="review-answer">Category Performance: ${categoryStats}</div>
                            <div class="review-answer">Difficulty Performance: Easy: ${performanceMetrics.difficulties.Easy || 0}, Medium: ${performanceMetrics.difficulties.Medium || 0}, Hard: ${performanceMetrics.difficulties.Hard || 0}</div>
                        </div>
                        
                        <h3 class="review-title">Review Your Answers</h3>
                        ${answers.map((answer, index) => `
                            <div class="review-item ${answer.isCorrect ? 'correct' : 'incorrect'}">
                                <div class="review-question">Q${index + 1}: ${answer.question} (${answer.category} - ${answer.difficulty})</div>
                                <div class="review-answer">Your Answer: ${answer.selected}</div>
                                <div class="review-answer">Correct Answer: ${answer.correct}</div>
                                <div class="review-explanation">${answer.explanation}</div>
                            </div>
                        `).join('')}
                        
                        <h3 class="review-title">Bookmarked Questions</h3>
                        ${bookmarkedQuestions.map(qid => {
                            const question = questions.find(q => q.id === qid);
                            return `
                                <div class="review-item">
                                    <div class="review-question">${question.question} (${question.category} - ${question.difficulty})</div>
                                    <div class="review-answer">Correct Answer: ${question.correctAnswer}</div>
                                    <div class="review-explanation">${question.explanation}</div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    
                    <button class="btn btn-primary mt-4" id="restart-btn">
                        <i class="fas fa-redo"></i> Try Again
                    </button>
                </div>
            `;
            
            document.getElementById('restart-btn').addEventListener('click', restartQuiz);
        }

        function restartQuiz() {
            // Reset quiz state
            currentQuestionIndex = 0;
            score = 0;
            streak = 0;
            timeElapsed = 0;
            answers = [];
            selectedOption = null;
            performanceMetrics = {
                categories: {},
                difficulties: { Easy: 0, Medium: 0, Hard: 0 },
                totalCorrect: 0,
                totalQuestions: 0
            };
            
            // Clear any existing timer
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            // Reset DOM
            const quizContainer = document.querySelector('.quiz-container');
            quizContainer.innerHTML = `
                <div class="quiz-header">
                    <div>
                        <h1 class="quiz-title">Advanced Embryology Quiz</h1>
                        <p class="quiz-subtitle">Test your knowledge with professional questions and detailed explanations</p>
                    </div>
                    <div class="stats-container">
                        <div class="stat">
                            <span class="stat-value" id="score">0</span>
                            <span class="stat-label">Score</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value" id="timer">00:00</span>
                            <span class="stat-label">Time</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value" id="streak">0</span>
                            <span class="stat-label">Streak</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value" id="category">All</span>
                            <span class="stat-label">Category</span>
                        </div>
                    </div>
                </div>

                <div class="progress-container">
                    <div class="progress-bar" id="progress-bar" style="width: 10%"></div>
                </div>

                <div class="question-meta">
                    <div class="question-tags">
                        <span class="tag" id="category-tag">Neuro</span>
                        <span class="tag" id="difficulty-tag">Medium</span>
                    </div>
                    <button class="bookmark-btn" id="bookmark-btn" aria-label="Bookmark question">
                        <i class="fas fa-bookmark"></i>
                    </button>
                </div>
                <div class="question-number">Question <span id="current-question">1</span> of <span id="total-questions">10</span></div>
                <div class="question-text" id="question"></div>

                <div class="options-grid" id="options-container"></div>

                <div class="feedback correct" id="feedback" style="display: none;">
                    <i class="fas fa-check-circle feedback-icon"></i>
                    <div class="feedback-text">Correct! Well done.</div>
                </div>

                <button class="btn btn-secondary" id="show-explanation-btn" style="display: none;">
                    <i class="fas fa-info-circle"></i> Show Explanation
                </button>

                <div class="explanation-container" id="explanation-container">
                    <div class="explanation">
                        <div class="explanation-title">Explanation:</div>
                        <div id="explanation-text"></div>
                    </div>
                </div>

                <div class="navigation">
                    <button class="btn btn-secondary" id="prev-btn" disabled>
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button class="btn btn-primary" id="next-btn">
                        Next Question <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            `;
            
            // Reinitialize DOM elements
            questionElement = document.getElementById('question');
            optionsContainer = document.getElementById('options-container');
            currentQuestionElement = document.getElementById('current-question');
            totalQuestionsElement = document.getElementById('total-questions');
            progressBar = document.getElementById('progress-bar');
            prevButton = document.getElementById('prev-btn');
            nextButton = document.getElementById('next-btn');
            feedbackElement = document.getElementById('feedback');
            timerElement = document.getElementById('timer');
            scoreElement = document.getElementById('score');
            streakElement = document.getElementById('streak');
            categoryElement = document.getElementById('category');
            explanationContainer = document.getElementById('explanation-container');
            explanationTextElement = document.getElementById('explanation-text');
            bookmarkBtn = document.getElementById('bookmark-btn');
            bookmarksCount = document.getElementById('bookmarks-count');
            categoryTag = document.getElementById('category-tag');
            difficultyTag = document.getElementById('difficulty-tag');
            showExplanationBtn = document.getElementById('show-explanation-btn');
            
            // Reinitialize the quiz
            initQuiz();
        }

        function toggleTheme() {
            const currentTheme = body.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 
                            currentTheme === 'light' ? 'minimal' : 'dark';
            
            body.setAttribute('data-theme', newTheme);
            themeToggle.innerHTML = newTheme === 'dark' ? '<i class="fas fa-moon"></i>' : 
                                  newTheme === 'light' ? '<i class="fas fa-sun"></i>' : 
                                  '<i class="fas fa-paint-brush"></i>';
            
            localStorage.setItem('theme', newTheme);
        }

        function toggleSound() {
            soundsEnabled = !soundsEnabled;
            soundToggle.innerHTML = soundsEnabled ? '<i class="fas fa-volume-up"></i>' : '<i class="fas fa-volume-mute"></i>';
            
            localStorage.setItem('soundsEnabled', soundsEnabled);
        }

        function playSound(type) {
            if (!soundsEnabled) return;
            console.log(`Playing ${type} sound`);
        }

        function loadPreferences() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                body.setAttribute('data-theme', savedTheme);
                themeToggle.innerHTML = savedTheme === 'dark' ? '<i class="fas fa-moon"></i>' : 
                                      savedTheme === 'light' ? '<i class="fas fa-sun"></i>' : 
                                      '<i class="fas fa-paint-brush"></i>';
            }
            
            const savedSounds = localStorage.getItem('soundsEnabled');
            if (savedSounds !== null) {
                soundsEnabled = savedSounds === 'true';
                soundToggle.innerHTML = soundsEnabled ? '<i class="fas fa-volume-up"></i>' : '<i class="fas fa-volume-mute"></i>';
            }
        }

        function saveBookmarks() {
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarkedQuestions));
        }

        function loadQuizHistory() {
            const saved = localStorage.getItem('quizHistory');
            if (saved) {
                quizHistory = JSON.parse(saved);
            }
            loadBookmarks();
        }

        function saveQuizHistory() {
            quizHistory.push({
                timestamp: new Date().toISOString(),
                score: score,
                percentage: ((score / (questions.length * 15)) * 100).toFixed(1),
                timeSpent: timeElapsed,
                streak: streak,
                answers: answers,
                performanceMetrics: performanceMetrics
            });
            localStorage.setItem('quizHistory', JSON.stringify(quizHistory));
        }

        function loadBookmarks() {
            const saved = localStorage.getItem('bookmarkedQuestions');
            if (saved) {
                bookmarkedQuestions = JSON.parse(saved);
            }
        }

        window.addEventListener('DOMContentLoaded', initQuiz);
    </script>
</body>
</html>