<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MED QUIZ Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #4895ef;
            --primary-dark: #3a0ca3;
            --secondary: #f72585;
            --success: #4cc9f0;
            --success-dark: #2bb8e0;
            --warning: #f9c74f;
            --danger: #f94144;
            --danger-dark: #e02a2d;
            --info: #577590;
            --gray-50: #f8f9fa;
            --gray-100: #f1f3f5;
            --gray-200: #e9ecef;
            --gray-300: #dee2e6;
            --gray-400: #ced4da;
            --gray-500: #adb5bd;
            --gray-600: #868e96;
            --gray-700: #495057;
            --gray-800: #343a40;
            --gray-900: #212529;
            --bg-primary: var(--gray-900);
            --bg-secondary: #1a1d21;
            --bg-tertiary: #2c303a;
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --text-tertiary: rgba(255, 255, 255, 0.5);
            --card-bg: rgba(35, 39, 47, 0.95);
            --card-border: #4cc9f0; /* Default: Soft blue for easy */
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.15), 0 5px 10px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.2);
            --transition-base: all 0.2s ease-in-out;
            --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-bounce: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --radius-2xl: 24px;
            --header-height: 70px;
            --max-width: 900px;
            --side-padding: 1.5rem;
        }

        [data-theme="light"] {
            --bg-primary: #f5f7fa;
            --bg-secondary: #ffffff;
            --bg-tertiary: #eef2f6;
            --text-primary: #1a1d21;
            --text-secondary: rgba(26, 29, 33, 0.7);
            --text-tertiary: rgba(26, 29, 33, 0.5);
            --card-bg: rgba(255, 255, 255, 0.95);
            --card-border: #4cc9f0;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.05), 0 1px 2px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.08), 0 5px 10px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.08);
        }

        [data-theme="minimal"] {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f1f5f9;
            --text-primary: #0f172a;
            --text-secondary: #334155;
            --text-tertiary: #64748b;
            --card-bg: #ffffff;
            --card-border: #4cc9f0;
            --primary: #0ea5e9;
            --primary-light: #38bdf8;
            --primary-dark: #0284c7;
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 4px 6px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        [data-theme="medical"] {
            --bg-primary: #e8f4f8;
            --bg-secondary: #ffffff;
            --bg-tertiary: #d1e7f1;
            --text-primary: #1a3c4f;
            --text-secondary: #2c5c75;
            --text-tertiary: #4a7a92;
            --card-bg: #ffffff;
            --card-border: #4cc9f0;
            --primary: #2a9d8f;
            --primary-light: #4cc9f0;
            --primary-dark: #1d7874;
            --success: #2a9d8f;
            --warning: #f9c74f;
            --danger: #e63946;
            --shadow-sm: 0 1px 3px rgba(42, 157, 143, 0.1), 0 1px 2px rgba(42, 157, 143, 0.06);
            --shadow-md: 0 4px 6px rgba(42, 157, 143, 0.1), 0 1px 3px rgba(42, 157, 143, 0.08);
            --shadow-lg: 0 10px 25px rgba(42, 157, 143, 0.1), 0 5px 10px rgba(42, 157, 143, 0.04);
            --shadow-xl: 0 20px 40px rgba(42, 157, 143, 0.15);
        }

        /* Border color progression based on quiz progress */
        [data-progress="25"] {
            --card-border: #2a9d8f; /* Deep teal for medium difficulty */
        }

        [data-progress="50"] {
            --card-border: #7209b7; /* Rich purple for hard difficulty */
        }

        [data-progress="75"] {
            --card-border: #f72585; /* Vibrant magenta for expert difficulty */
        }

        [data-progress="100"] {
            --card-border: #f72585; /* Maintain magenta for completion */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            transition: var(--transition-base);
            line-height: 1.6;
            font-weight: 400;
        }

        header {
            height: var(--header-height);
            background: var(--bg-secondary);
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 var(--side-padding);
            transition: var(--transition-base);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 700;
            font-size: 1.25rem;
            color: var(--primary);
        }

        .logo-icon {
            font-size: 1.5rem;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .control-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition-base);
            position: relative;
        }

        .control-btn:hover {
            background: var(--bg-tertiary);
            transform: translateY(-2px);
        }

        .control-btn i {
            font-size: 1.1rem;
        }

        .badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--secondary);
            color: white;
            font-size: 0.7rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        main {
            flex: 1;
            padding: 2rem var(--side-padding);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .quiz-container {
            width: 100%;
            max-width: var(--max-width);
            background: var(--card-bg);
            border-radius: var(--radius-xl);
            padding: 2rem;
            box-shadow: var(--shadow-lg);
            transition: var(--transition-smooth);
            border: 1px solid var(--card-border);
            backdrop-filter: blur(10px);
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .quiz-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .quiz-subtitle {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .stats-container {
            display: flex;
            gap: 1rem;
        }

        .stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.5rem 0.75rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            min-width: 70px;
        }

        .stat-value {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .progress-container {
            width: 100%;
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            overflow: hidden;
            margin: 1.5rem 0;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-light), var(--primary));
            border-radius: var(--radius-lg);
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            100% { left: 100%; }
        }

        .question-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .question-tags {
            display: flex;
            gap: 0.5rem;
        }

        .tag {
            padding: 0.25rem 0.75rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .question-number {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            line-height: 1.4;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 1rem 1.25rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: var(--transition-smooth);
            border: 1px solid transparent;
        }

        .option:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-light);
        }

        .option.selected {
            background: rgba(67, 97, 238, 0.1);
            border-color: var(--primary);
            animation: pulse 0.3s ease;
        }

        .option.correct {
            background: rgba(76, 201, 240, 0.1);
            border-color: var(--success);
        }

        .option.incorrect {
            background: rgba(249, 65, 68, 0.1);
            border-color: var(--danger);
        }

        .option.skipped {
            background: rgba(67, 97, 238, 0.05);
            border-color: var(--primary-light);
        }

        .option-letter {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-md);
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-right: 1rem;
            flex-shrink: 0;
            transition: var(--transition-base);
            box-shadow: var(--shadow-sm);
        }

        .option.selected .option-letter {
            background: var(--primary);
            color: white;
        }

        .option.correct .option-letter {
            background: var(--success);
            color: white;
        }

        .option.incorrect .option-letter {
            background: var(--danger);
            color: white;
        }

        .option.skipped .option-letter {
            background: var(--primary-light);
            color: white;
        }

        .option-text {
            flex: 1;
        }

        .bookmark-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1rem;
            transition: var(--transition-base);
        }

        .bookmark-btn:hover {
            color: var(--primary);
        }

        .bookmark-btn.bookmarked {
            color: var(--warning);
        }

        .feedback {
            padding: 1rem;
            border-radius: var(--radius-lg);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            animation: fadeIn 0.3s ease;
        }

        .feedback.correct {
            background: rgba(76, 201, 240, 0.1);
            color: var(--success);
            border-left: 4px solid var(--success);
        }

        .feedback.incorrect {
            background: rgba(249, 65, 68, 0.1);
            color: var(--danger);
            border-left: 4px solid var(--danger);
        }

        .feedback.skipped {
            background: rgba(67, 97, 238, 0.1);
            color: var(--primary);
            border-left: 4px solid var(--primary);
        }

        .feedback-icon {
            font-size: 1.5rem;
        }

        .explanation-container {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }

        .explanation-container.expanded {
            max-height: 500px;
        }

        .explanation {
            padding: 1.25rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            margin-top: 1rem;
            border-left: 4px solid var(--primary);
        }

        .explanation-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 1.5rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius-lg);
            border: none;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition-base);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-secondary:hover:not(:disabled) {
            background: var(--bg-secondary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover:not(:disabled) {
            background: var(--success-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover:not(:disabled) {
            background: var(--danger-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .results-container {
            text-align: center;
            animation: fadeIn 0.5s ease;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto 1.5rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: conic-gradient(var(--primary) 0% var(--p, 0%), var(--bg-tertiary) var(--p, 0%) 100%);
            position: relative;
        }

        .score-circle::before {
            content: '';
            position: absolute;
            width: 130px;
            height: 130px;
            border-radius: 50%;
            background: var(--card-bg);
        }

        .score-text {
            position: relative;
            z-index: 1;
        }

        .score-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
        }

        .score-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .results-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin: 2rem 0;
        }

        .result-stat {
            padding: 1rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
        }

        .result-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.25rem;
        }

        .result-stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .review-section {
            margin-top: 2rem;
            text-align: left;
        }

        .review-title {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        .review-item {
            padding: 1.25rem;
            border-radius: var(--radius-lg);
            margin-bottom: 1rem;
            background: var(--bg-tertiary);
        }

        .review-item.correct {
            border-left: 4px solid var(--success);
        }

        .review-item.incorrect {
            border-left: 4px solid var(--danger);
        }

        .review-item.skipped {
            border-left: 4px solid var(--primary);
        }

        .review-question {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .review-answer {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .review-explanation {
            font-size: 0.85rem;
            color: var(--text-secondary);
            padding-top: 0.5rem;
            border-top: 1px solid var(--card-border);
        }

        footer {
            padding: 1.5rem var(--side-padding);
            background: var(--bg-secondary);
            text-align: center;
            font-size: 0.85rem;
            color: var(--text-secondary);
            box-shadow: 0 -1px 3px rgba(0, 0, 0, 0.1);
        }

        /* Modal styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--card-bg);
            border-radius: var(--radius-xl);
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            transform: translateY(-20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-secondary);
            cursor: pointer;
        }

        .modal-body {
            margin-bottom: 1.5rem;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* Difficulty indicators */
        .difficulty-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .difficulty-easy {
            background-color: var(--success);
        }

        .difficulty-medium {
            background-color: var(--warning);
        }

        .difficulty-hard {
            background-color: var(--danger);
        }

        /* Stats grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            padding: 1rem;
            text-align: center;
        }

        .stat-card-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.25rem;
        }

        .stat-card-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* Confetti animation */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--primary);
            opacity: 0;
        }

        @keyframes confettiFall {
            0% {
                opacity: 1;
                transform: translateY(-100px) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translateY(100vh) rotate(720deg);
            }
        }

        /* Floating action button */
        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: var(--shadow-lg);
            cursor: pointer;
            z-index: 100;
            transition: var(--transition-base);
        }

        .fab:hover {
            transform: translateY(-5px) scale(1.05);
        }

        /* Study mode toggle */
        .study-mode-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-tertiary);
            transition: .4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--primary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        /* Theme selector */
        .theme-selector {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            z-index: 100;
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            padding: 1rem;
            box-shadow: var(--shadow-lg);
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .theme-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: var(--transition-base);
        }

        .theme-option:hover {
            transform: scale(1.1);
        }

        .theme-option.active {
            border-color: var(--text-primary);
        }

        .theme-dark {
            background: linear-gradient(135deg, #212529 0%, #343a40 100%);
        }

        .theme-light {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }

        .theme-minimal {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }

        .theme-medical {
            background: linear-gradient(135deg, #e8f4f8 0%, #b8e0f4 100%);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes bounceIn {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        .shake {
            animation: shake 0.5s ease;
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        .pulse {
            animation: pulse 0.5s ease;
        }

        .bounce-in {
            animation: bounceIn 0.5s ease;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .text-center {
            text-align: center;
        }

        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 2rem; }

        @media (max-width: 768px) {
            :root {
                --side-padding: 1rem;
                --header-height: 60px;
            }

            .quiz-container {
                padding: 1.5rem;
            }

            .quiz-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .stats-container {
                width: 100%;
                justify-content: space-between;
            }

            .results-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .score-circle {
                width: 120px;
                height: 120px;
            }

            .score-circle::before {
                width: 100px;
                height: 100px;
            }

            .score-value {
                font-size: 2rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .fab {
                bottom: 1rem;
                right: 1rem;
                width: 50px;
                height: 50px;
                font-size: 1.25rem;
            }

            .theme-selector {
                bottom: 1rem;
                left: 1rem;
                flex-direction: row;
                padding: 0.75rem;
            }
        }

        @media (max-width: 480px) {
            .navigation {
                flex-direction: column;
                gap: 0.75rem;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            .option {
                padding: 0.75rem;
            }

            .option-letter {
                width: 28px;
                height: 28px;
                margin-right: 0.75rem;
            }
        }
    </style>
</head>
<body data-theme="medical" data-progress="0">
    <header>
        <div class="logo">
            <i class="fas fa-brain logo-icon"></i>
            <span>MedQuiz</span>
        </div>
        <div class="header-controls">
            <button class="control-btn" id="theme-toggle" aria-label="Toggle theme">
                <i class="fas fa-palette"></i>
            </button>
            <button class="control-btn" id="sound-toggle" aria-label="Toggle sound">
                <i class="fas fa-volume-up"></i>
            </button>
            <button class="control-btn" id="stats-btn" aria-label="View statistics">
                <i class="fas fa-chart-line"></i>
                <span class="badge" id="bookmarks-count">0</span>
            </button>
        </div>
    </header>

    <main>
        <div class="quiz-container">
            <div class="quiz-header">
                <div>
                    <h1 class="quiz-title">MED QUIZ</h1>
                    <p class="quiz-subtitle">Test your medical knowledge</p>
                </div>
                <div class="stats-container">
                    <div class="stat">
                        <span class="stat-value" id="score">0</span>
                        <span class="stat-label">Score</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="timer">00:00</span>
                        <span class="stat-label">Time</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="streak">0</span>
                        <span class="stat-label">Streak</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="category">All</span>
                        <span class="stat-label">Category</span>
                    </div>
                </div>
            </div>

            <div class="study-mode-toggle">
                <span>Study Mode:</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="study-mode-toggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>

            <div class="progress-container">
                <div class="progress-bar" id="progress-bar" style="width: 10%"></div>
            </div>

            <div class="question-meta">
                <div class="question-tags">
                    <span class="tag" id="category-tag">Biochemistry</span>
                    <span class="tag" id="difficulty-tag">
                        <span class="difficulty-indicator difficulty-medium"></span>
                        Medium
                    </span>
                </div>
                <button class="bookmark-btn" id="bookmark-btn" aria-label="Bookmark question">
                    <i class="fas fa-bookmark"></i>
                </button>
            </div>
            <div class="question-number">Question <span id="current-question">1</span> of <span id="total-questions">15</span></div>
            <div class="question-text" id="question">Conjugated proteins contain a permanently associated chemical group called:</div>

            <div class="options-grid" id="options-container">
                <div class="option">
                    <div class="option-letter">A</div>
                    <div class="option-text">Cofactor</div>
                </div>
                <div class="option">
                    <div class="option-letter">B</div>
                    <div class="option-text">Prosthetic group</div>
                </div>
                <div class="option">
                    <div class="option-letter">C</div>
                    <div class="option-text">Ligand</div>
                </div>
                <div class="option">
                    <div class="option-letter">D</div>
                    <div class="option-text">Coenzyme</div>
                </div>
            </div>

            <div class="feedback correct" id="feedback" style="display: none;">
                <i class="fas fa-check-circle feedback-icon"></i>
                <div class="feedback-text">Correct! Well done.</div>
            </div>

            <button class="btn btn-secondary" id="show-explanation-btn" style="display: none;">
                <i class="fas fa-info-circle"></i> Show Explanation
            </button>

            <div class="explanation-container" id="explanation-container">
                <div class="explanation">
                    <div class="explanation-title">Explanation:</div>
                    <div id="explanation-text">A prosthetic group is a non-protein molecule permanently bound to a conjugated protein, essential for its function (e.g., heme in hemoglobin). Coenzymes and cofactors are loosely bound; ligands bind reversibly. Errors can affect understanding protein function, impacting diagnosis of disorders like porphyrias.</div>
                </div>
            </div>

            <div class="navigation">
                <button class="btn btn-secondary" id="prev-btn" disabled>
                    <i class="fas fa-arrow-left"></i> Previous
                </button>
                <button class="btn btn-primary" id="next-btn">
                    Next Question <i class="fas fa-arrow-right"></i>
                </button>
                <button class="btn btn-danger" id="skip-btn">
                    <i class="fas fa-forward"></i> Skip
                </button>
            </div>
        </div>
    </main>

    <div class="theme-selector">
        <div class="theme-option theme-dark active" data-theme="dark" title="Dark Theme"></div>
        <div class="theme-option theme-light" data-theme="light" title="Light Theme"></div>
        <div class="theme-option theme-minimal" data-theme="minimal" title="Minimal Theme"></div>
        <div class="theme-option theme-medical" data-theme="medical" title="Medical Theme"></div>
    </div>

    <div class="fab" id="quick-actions-btn">
        <i class="fas fa-bolt"></i>
    </div>

    <div class="confetti-container" id="confetti-container"></div>

    <div class="modal-overlay" id="stats-modal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Your Statistics</h2>
                <button class="modal-close" id="close-stats-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-card-value" id="modal-total-questions">0</div>
                        <div class="stat-card-label">Total Questions</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-value" id="modal-correct-answers">0</div>
                        <div class="stat-card-label">Correct Answers</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-value" id="modal-accuracy">0%</div>
                        <div class="stat-card-label">Accuracy</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-value" id="modal-avg-time">0s</div>
                        <div class="stat-card-label">Avg. Time</div>
                    </div>
                </div>
                <h3 class="review-title">Performance by Category</h3>
                <div id="category-stats"></div>
                <h3 class="review-title mt-2">Performance by Difficulty</h3>
                <div id="difficulty-stats"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="close-stats-btn">Close</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="quick-actions-modal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Quick Actions</h2>
                <button class="modal-close" id="close-actions-modal">&times;</button>
            </div>
            <div class="modal-body">
                <button class="btn btn-primary full-width mt-1" id="mark-for-review-btn">
                    <i class="fas fa-flag"></i> Mark for Review
                </button>
                <button class="btn btn-secondary full-width mt-1" id="view-explanation-btn">
                    <i class="fas fa-info-circle"></i> View Explanation
                </button>
                <button class="btn btn-success full-width mt-1" id="hint-btn">
                    <i class="fas fa-lightbulb"></i> Get a Hint
                </button>
                <button class="btn btn-danger full-width mt-1" id="report-question-btn">
                    <i class="fas fa-exclamation-triangle"></i> Report Question
                </button>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="close-actions-btn">Close</button>
            </div>
        </div>
    </div>

    <footer>
        &copy; 2025 MedQuiz | MED Practice Platform | All Rights Reserved
    </footer>

    <script>
        const questions = [
    {
        "id": 131,
        "question": "Which of the following techniques is used to diagnose genetic diseases?",
        "options": ["MRI", "Electrophoresis and blotting", "ELISA", "CT scan"],
        "answer": 1,
        "correctAnswer": "Electrophoresis and blotting",
        "explanation": "Electrophoresis and blotting (e.g., Southern blotting) detect DNA mutations for genetic disease diagnosis (embryology Q41–Q50). ELISA tests proteins; MRI and CT scans are imaging techniques. Errors can lead to misdiagnosis of congenital disorders like cystic fibrosis.",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 132,
        "question": "Which of the following is an application of gene therapy?",
        "options": ["DNA fingerprinting", "Diagnosing genetic disease", "Treating genetic disease", "Protein synthesis"],
        "answer": 2,
        "correctAnswer": "Treating genetic disease",
        "explanation": "Gene therapy corrects genetic defects to treat diseases (embryology Q41–Q50). Fingerprinting and diagnosis are not therapeutic; protein synthesis is a cellular process. Errors can affect understanding therapeutic approaches for congenital disorders.",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 133,
        "question": "Which of the following drugs is designed using nucleic acid knowledge?",
        "options": ["Paracetamol", "Aspirin", "Allopurinol", "Ibuprofen"],
        "answer": 2,
        "correctAnswer": "Allopurinol",
        "explanation": "Allopurinol, a purine analogue, inhibits xanthine oxidase in nucleic acid metabolism, treating gout (conjugated proteins Q12; carbohydrate chemistry Q35). Other drugs target pain or inflammation. Errors can lead to misdiagnosis of hyperuricemia in metabolic disorders.",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 134,
        "question": "DNA fingerprinting is mainly used in:",
        "options": ["Diagnosis of malaria", "Drug designing", "Paternity testing and crime investigation", "Protein production"],
        "answer": 2,
        "correctAnswer": "Paternity testing and crime investigation",
        "explanation": "DNA fingerprinting identifies individuals via unique DNA patterns, used in paternity testing and forensics (Q5–Q6). Other applications are incorrect. Errors can affect understanding forensic science or genetic identity in clinical contexts.",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 135,
        "question": "Who invented DNA fingerprinting?",
        "options": ["Watson & Crick", "Hershey & Chase", "Alec Jeffreys", "Friedrich Miescher"],
        "answer": 2,
        "correctAnswer": "Alec Jeffreys",
        "explanation": "Alec Jeffreys developed DNA fingerprinting in 1984 (Q6). Watson & Crick described DNA structure; Miescher discovered nuclein; Hershey & Chase confirmed DNA as genetic material. Errors can affect historical context in medical genetics.",
        "category": "Biochemistry",
        "difficulty": "Easy"
    },
    {
        "id": 136,
        "question": "Colin Pitchfork was the first criminal caught using DNA fingerprinting in which year?",
        "options": ["1953", "1994", "1985", "2002"],
        "answer": 2,
        "correctAnswer": "1985",
        "explanation": "Colin Pitchfork was convicted in 1985 using DNA fingerprinting, a landmark in forensics (Q5). Other years are incorrect. Errors can affect understanding the timeline of genetic technologies in clinical forensics.",
        "category": "Biochemistry",
        "difficulty": "Easy"
    },
    {
        "id": 137,
        "question": "Which protein normally prevents 'double muscle' phenotype?",
        "options": ["Collagen", "Actin", "Myostatin", "Troponin"],
        "answer": 2,
        "correctAnswer": "Myostatin",
        "explanation": "Myostatin inhibits muscle growth, preventing the 'double muscle' phenotype (embryology Q81–Q90). Mutations cause excessive muscle growth. Other proteins are unrelated. Errors can affect diagnosis of muscular hypertrophy in developmental disorders.",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 138,
        "question": "The central dogma of molecular biology includes:",
        "options": ["Protein degradation", "Replication only", "Replication, transcription, translation", "Transcription only"],
        "answer": 2,
        "correctAnswer": "Replication, transcription, translation",
        "explanation": "The central dogma involves DNA replication, transcription to RNA, and translation to proteins (embryology Q51–Q70 for gene regulation). Other options are incomplete or incorrect. Errors can affect understanding gene expression in embryogenesis.",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 139,
        "question": "In HIV infection, which step of central dogma is reversed?",
        "options": ["DNA → RNA", "Protein → RNA", "RNA → DNA", "RNA → Protein"],
        "answer": 2,
        "correctAnswer": "RNA → DNA",
        "explanation": "HIV uses reverse transcription (RNA → DNA) via reverse transcriptase, reversing the central dogma’s transcription step (Q8; embryology Q51–Q70). Other steps are not reversed. Errors can affect understanding HIV therapy and viral replication.",
        "category": "Biochemistry",
        "difficulty": "Hard"
    },
    {
        "id": 140,
        "question": "Nucleic acids are polymers of:",
        "options": ["Amino acids", "Nucleotides", "Monosaccharides", "Fatty acids"],
        "answer": 1,
        "correctAnswer": "Nucleotides",
        "explanation": "Nucleic acids (DNA/RNA) are nucleotide polymers (Q11–Q13). Amino acids form proteins; monosaccharides form carbohydrates; fatty acids form lipids. Errors can affect understanding nucleic acid structure in gene regulation (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Easy"
    },
    {
        "id": 141,
        "question": "The bond linking nucleotides in DNA/RNA is:",
        "options": ["Peptide bond", "Glycosidic bond", "Phosphodiester bond", "Hydrogen bond"],
        "answer": 2,
        "correctAnswer": "Phosphodiester bond",
        "explanation": "Phosphodiester bonds link nucleotides in DNA/RNA backbones (Q10). Glycosidic bonds link bases to sugars; peptide bonds link amino acids; hydrogen bonds pair bases. Errors can affect understanding nucleic acid stability in replication (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Easy"
    },
    {
        "id": 142,
        "question": "DNA has which bases?",
        "options": ["A, G, C, U", "A, U, G only", "A, G, C, T", "A, U, G, T"],
        "answer": 2,
        "correctAnswer": "A, G, C, T",
        "explanation": "DNA contains adenine (A), guanine (G), cytosine (C), and thymine (T) (Q13, Q18–Q20). Uracil (U) is RNA-specific. Errors can affect understanding DNA replication in embryogenesis (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Easy"
    },
    {
        "id": 143,
        "question": "RNA has which bases?",
        "options": ["A, G, C, T", "A, C, G, T, U", "A, G, C, U", "A, U, G only"],
        "answer": 2,
        "correctAnswer": "A, G, C, U",
        "explanation": "RNA contains adenine (A), guanine (G), cytosine (C), and uracil (U) (Q12, Q19, Q21). Thymine (T) is DNA-specific. Errors can affect understanding RNA synthesis in gene expression (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Easy"
    },
    {
        "id": 144,
        "question": "The scientist who discovered 'nuclein' in pus cells was:",
        "options": ["Avery", "Griffith", "Miescher", "Jeffreys"],
        "answer": 2,
        "correctAnswer": "Miescher",
        "explanation": "Friedrich Miescher discovered 'nuclein' (DNA) in 1869 (Q15–Q17). Griffith, Avery, and Jeffreys contributed later discoveries. Errors can affect historical context in medical genetics.",
        "category": "Biochemistry",
        "difficulty": "Easy"
    },
    {
        "id": 145,
        "question": "Griffith’s experiment (1928) discovered:",
        "options": ["Genetic code", "Transforming principle", "DNA structure", "Central dogma"],
        "answer": 1,
        "correctAnswer": "Transforming principle",
        "explanation": "Griffith’s 1928 experiment identified the transforming principle, later confirmed as DNA (Q16–Q17). Other discoveries came later. Errors can affect understanding genetic material in embryonic development (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 146,
        "question": "Avery, McLeod & McCarty proved that the transforming principle is:",
        "options": ["Protein", "Lipid", "DNA", "RNA"],
        "answer": 2,
        "correctAnswer": "DNA",
        "explanation": "Avery, McLeod, and McCarty (1944) proved DNA is the transforming principle (Q15, Q17). Protein, RNA, and lipids were ruled out. Errors can affect understanding DNA’s role in heredity (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 147,
        "question": "Hershey & Chase experiment (1953) confirmed that genetic material is:",
        "options": ["Protein", "RNA", "DNA", "Lipid"],
        "answer": 2,
        "correctAnswer": "DNA",
        "explanation": "Hershey and Chase (1953) confirmed DNA as the genetic material using bacteriophages (Q15–Q16). Protein, RNA, and lipids were excluded. Errors can affect understanding genetic inheritance in embryogenesis (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 148,
        "question": "Purine bases include:",
        "options": ["Cytosine, Thymine", "Adenine, Guanine", "Cytosine, Uracil", "Uracil, Thymine"],
        "answer": 1,
        "correctAnswer": "Adenine, Guanine",
        "explanation": "Purines are adenine (A) and guanine (G) (Q12–Q13, Q19). Cytosine, thymine, and uracil are pyrimidines. Errors can affect understanding base pairing in DNA replication (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 149,
        "question": "Pyrimidine bases include:",
        "options": ["Adenine, Cytosine", "Cytosine, Thymine, Uracil", "Adenine, Guanine", "Guanine, Uracil"],
        "answer": 1,
        "correctAnswer": "Cytosine, Thymine, Uracil",
        "explanation": "Pyrimidines are cytosine (C), thymine (T), and uracil (U) (Q12–Q13, Q18). Adenine and guanine are purines. Errors can affect understanding RNA synthesis and base pairing (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 150,
        "question": "Thymine is normally found in:",
        "options": ["RNA only", "Both DNA and RNA", "DNA only", "Neither"],
        "answer": 2,
        "correctAnswer": "DNA only",
        "explanation": "Thymine is specific to DNA (Q12, Q19). Uracil replaces thymine in RNA (Q21). Errors can affect understanding DNA replication in embryogenesis (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Easy"
    },
    {
        "id": 151,
        "question": "Uracil is normally found in:",
        "options": ["DNA only", "Both DNA and RNA", "RNA only", "Neither"],
        "answer": 2,
        "correctAnswer": "RNA only",
        "explanation": "Uracil is specific to RNA (Q13, Q19). Thymine is found in DNA (Q20). Errors can affect understanding RNA transcription in gene expression (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Easy"
    },
    {
        "id": 152,
        "question": "Which unusual base is found in tRNA?",
        "options": ["Xanthine", "Pseudouridine", "Adenosine", "Cytosine"],
        "answer": 1,
        "correctAnswer": "Pseudouridine",
        "explanation": "Pseudouridine, an unusual base, is found in tRNA, enhancing stability (Q23–Q24). Other bases are standard or unrelated. Errors can affect understanding tRNA function in translation (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 153,
        "question": "Pseudouridine differs from uridine because:",
        "options": ["Sugar is deoxyribose", "Base is replaced by adenine", "Sugar is attached via C-C bond", "Base is thymine"],
        "answer": 2,
        "correctAnswer": "Sugar is attached via C-C bond",
        "explanation": "Pseudouridine has a C-C glycosidic bond between the base and sugar, unlike uridine’s C-N bond (Q22; carbohydrate chemistry Q35). Other differences are incorrect. Errors can affect understanding tRNA structure in translation (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Hard"
    },
    {
        "id": 154,
        "question": "Thymine may unusually appear in which RNA?",
        "options": ["mRNA", "rRNA", "tRNA", "snRNA"],
        "answer": 2,
        "correctAnswer": "tRNA",
        "explanation": "Thymine can appear in tRNA as a modified base, unlike other RNAs (Q22). Errors can affect understanding tRNA’s role in translation during embryonic development (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 155,
        "question": "Cytarabine (Ara-C) contains which sugar?",
        "options": ["Ribose", "Deoxyribose", "Arabinose", "Glucose"],
        "answer": 2,
        "correctAnswer": "Arabinose",
        "explanation": "Cytarabine (Ara-C), a chemotherapeutic drug, contains arabinose, a sugar analogue (carbohydrate chemistry Q35). Other sugars are incorrect. Errors can affect understanding nucleoside analogue drugs in cancer therapy.",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 156,
        "question": "Vidarabine (Ara-A) is used mainly for:",
        "options": ["Hypertension", "Cholesterol control", "Viral infections", "Diabetes"],
        "answer": 2,
        "correctAnswer": "Viral infections",
        "explanation": "Vidarabine (Ara-A), a nucleoside analogue, treats viral infections (e.g., herpes). Other uses are incorrect. Errors can affect understanding antiviral therapies in clinical practice.",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 157,
        "question": "Allopurinol is a nucleic acid analogue used in:",
        "options": ["Tuberculosis", "Cancer", "Gout", "HIV/AIDS"],
        "answer": 2,
        "correctAnswer": "Gout",
        "explanation": "Allopurinol, a purine analogue, treats gout by inhibiting xanthine oxidase (Q3; conjugated proteins Q12). Other conditions are unrelated. Errors can lead to misdiagnosis of hyperuricemia-related disorders.",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 158,
        "question": "The glycosidic bond in nucleosides links:",
        "options": ["Base to phosphate", "Phosphate to phosphate", "Base to sugar", "Sugar to sugar"],
        "answer": 2,
        "correctAnswer": "Base to sugar",
        "explanation": "The glycosidic bond in nucleosides links the base to the sugar (Q29–Q30; carbohydrate chemistry Q35). Phosphodiester bonds link nucleotides; other options are incorrect. Errors can affect understanding nucleoside structure in DNA/RNA synthesis.",
        "category": "Biochemistry",
        "difficulty": "Medium"
    },
    {
        "id": 159,
        "question": "In purines, the base links to sugar at which nitrogen?",
        "options": ["N1", "N3", "N7", "N9"],
        "answer": 3,
        "correctAnswer": "N9",
        "explanation": "In purines (adenine, guanine), the base links to sugar at N9 via a glycosidic bond (Q28; carbohydrate chemistry Q35). Other nitrogens are incorrect. Errors can affect understanding nucleoside structure in replication (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Hard"
    },
    {
        "id": 160,
        "question": "In pyrimidines, the base links to sugar at which nitrogen?",
        "options": ["N3", "N1", "N7", "N9"],
        "answer": 1,
        "correctAnswer": "N1",
        "explanation": "In pyrimidines (cytosine, thymine, uracil), the base links to sugar at N1 via a glycosidic bond (Q28; carbohydrate chemistry Q35). Other nitrogens are incorrect. Errors can affect understanding nucleoside structure in RNA synthesis (embryology Q51–Q70).",
        "category": "Biochemistry",
        "difficulty": "Hard"
    }
];

        // DOM Elements
        let body = document.body;
        let questionElement = document.getElementById('question');
        let optionsContainer = document.getElementById('options-container');
        let currentQuestionElement = document.getElementById('current-question');
        let totalQuestionsElement = document.getElementById('total-questions');
        let progressBar = document.getElementById('progress-bar');
        let prevButton = document.getElementById('prev-btn');
        let nextButton = document.getElementById('next-btn');
        let skipButton = document.getElementById('skip-btn');
        let feedbackElement = document.getElementById('feedback');
        let timerElement = document.getElementById('timer');
        let scoreElement = document.getElementById('score');
        let streakElement = document.getElementById('streak');
        let categoryElement = document.getElementById('category');
        let explanationContainer = document.getElementById('explanation-container');
        let explanationTextElement = document.getElementById('explanation-text');
        let themeToggle = document.getElementById('theme-toggle');
        let soundToggle = document.getElementById('sound-toggle');
        let bookmarkBtn = document.getElementById('bookmark-btn');
        let bookmarksCount = document.getElementById('bookmarks-count');
        let categoryTag = document.getElementById('category-tag');
        let difficultyTag = document.getElementById('difficulty-tag');
        let showExplanationBtn = document.getElementById('show-explanation-btn');
        let statsBtn = document.getElementById('stats-btn');
        let statsModal = document.getElementById('stats-modal');
        let closeStatsModal = document.getElementById('close-stats-modal');
        let closeStatsBtn = document.getElementById('close-stats-btn');
        let quickActionsBtn = document.getElementById('quick-actions-btn');
        let quickActionsModal = document.getElementById('quick-actions-modal');
        let closeActionsModal = document.getElementById('close-actions-modal');
        let closeActionsBtn = document.getElementById('close-actions-btn');
        let studyModeToggle = document.getElementById('study-mode-toggle');
        let confettiContainer = document.getElementById('confetti-container');
        let themeOptions = document.querySelectorAll('.theme-option');

        // Quiz state
        let currentQuestionIndex = 0;
        let score = 0;
        let streak = 0;
        let selectedOption = null;
        let timeStarted = null;
        let timerInterval = null;
        let timeElapsed = 0;
        let answers = [];
        let soundsEnabled = true;
        let bookmarkedQuestions = [];
        let quizHistory = [];
        let studyMode = false;
        let performanceMetrics = {
            categories: {},
            difficulties: { Easy: 0, Medium: 0, Hard: 0, "Very Hard": 0 },
            totalCorrect: 0,
            totalQuestions: 0,
            totalTime: 0
        };

        // Audio elements for sound feedback
        const correctSound = new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA');
        const incorrectSound = new Audio('data:audio/wav;base64,UklGRh4AAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA');
        const bookmarkSound = new Audio('data:audio/wav;base64,UklGRhAAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA');

        function initQuiz() {
            // Reset DOM elements
            scoreElement.textContent = score;
            streakElement.textContent = streak;
            timerElement.textContent = '00:00';
            totalQuestionsElement.textContent = questions.length;
            
            loadQuestion();
            startTimer();
            
            // Add event listeners
            prevButton.addEventListener('click', goToPreviousQuestion);
            nextButton.addEventListener('click', goToNextQuestion);
            skipButton.addEventListener('click', skipQuestion);
            themeToggle.addEventListener('click', toggleThemeSelector);
            soundToggle.addEventListener('click', toggleSound);
            bookmarkBtn.addEventListener('click', toggleBookmark);
            showExplanationBtn.addEventListener('click', toggleExplanation);
            statsBtn.addEventListener('click', showStatsModal);
            closeStatsModal.addEventListener('click', hideStatsModal);
            closeStatsBtn.addEventListener('click', hideStatsModal);
            quickActionsBtn.addEventListener('click', showQuickActionsModal);
            closeActionsModal.addEventListener('click', hideQuickActionsModal);
            closeActionsBtn.addEventListener('click', hideQuickActionsModal);
            studyModeToggle.addEventListener('change', toggleStudyMode);
            
            // Theme selector event listeners
            themeOptions.forEach(option => {
                option.addEventListener('click', () => {
                    const theme = option.getAttribute('data-theme');
                    changeTheme(theme);
                });
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', handleKeydown);
            
            loadPreferences();
            loadQuizHistory();
            updateBookmarksCount();
        }

        function handleKeydown(e) {
            if (e.key === 'ArrowRight') {
                goToNextQuestion();
            } else if (e.key === 'ArrowLeft') {
                goToPreviousQuestion();
            } else if (e.key.toLowerCase() === 'a' || e.key === '1') {
                selectOption(0);
            } else if (e.key.toLowerCase() === 'b' || e.key === '2') {
                selectOption(1);
            } else if (e.key.toLowerCase() === 'c' || e.key === '3') {
                selectOption(2);
            } else if (e.key.toLowerCase() === 'd' || e.key === '4') {
                selectOption(3);
            } else if (e.key === 'Enter') {
                if (showExplanationBtn.style.display !== 'none') {
                    toggleExplanation();
                }
            } else if (e.key === 's' || e.key === '5') {
                skipQuestion();
            }
        }

        function loadQuestion() {
            const question = questions[currentQuestionIndex];
            questionElement.textContent = question.question;
            currentQuestionElement.textContent = currentQuestionIndex + 1;
            categoryTag.textContent = question.category || 'Unknown';
            
            // Update difficulty tag with indicator
            difficultyTag.innerHTML = `
                <span class="difficulty-indicator difficulty-${question.difficulty.toLowerCase().replace(' ', '-')}"></span>
                ${question.difficulty}
            `;
            
            categoryElement.textContent = question.category || 'All';
            
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;
            
            // Update progress level for appearance change
            let progressLevel = 0;
            if (progress > 75) progressLevel = 75;
            else if (progress > 50) progressLevel = 50;
            else if (progress > 25) progressLevel = 25;
            body.setAttribute('data-progress', progressLevel);
            
            optionsContainer.innerHTML = '';
            
            const optionLetters = ['A', 'B', 'C', 'D'];
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.classList.add('option', 'bounce-in');
                optionElement.setAttribute('role', 'button');
                optionElement.setAttribute('tabindex', '0');
                optionElement.setAttribute('aria-label', `Option ${optionLetters[index]}: ${option}`);
                
                const optionLetter = document.createElement('div');
                optionLetter.classList.add('option-letter');
                optionLetter.textContent = optionLetters[index];
                
                const optionText = document.createElement('div');
                optionText.classList.add('option-text');
                optionText.textContent = option;
                
                optionElement.appendChild(optionLetter);
                optionElement.appendChild(optionText);
                
                optionElement.addEventListener('click', () => selectOption(index));
                optionElement.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        selectOption(index);
                    }
                });
                
                optionsContainer.appendChild(optionElement);
            });
            
            prevButton.disabled = currentQuestionIndex === 0;
            nextButton.textContent = currentQuestionIndex === questions.length - 1 ? 'Finish Quiz' : 'Next Question';
            
            feedbackElement.style.display = 'none';
            showExplanationBtn.style.display = 'none';
            explanationContainer.classList.remove('expanded');
            
            selectedOption = null;
            
            // If the question was previously answered or skipped, display the feedback
            if (answers[currentQuestionIndex]) {
                const ans = answers[currentQuestionIndex];
                const options = document.querySelectorAll('.option');
                feedbackElement.style.display = 'flex';
                showExplanationBtn.style.display = 'block';
                explanationTextElement.textContent = question.explanation;
                options.forEach(option => option.style.pointerEvents = 'none');
                
                if (ans.selected === 'Skipped') {
                    selectedOption = null;
                    feedbackElement.classList.add('skipped');
                    feedbackElement.innerHTML = '<i class="fas fa-forward feedback-icon"></i><div class="feedback-text">Skipped. The right answer is highlighted.</div>';
                    options[question.answer].classList.add('correct');
                } else {
                    const optIndex = question.options.findIndex(opt => opt === ans.selected);
                    if (optIndex !== -1) {
                        selectedOption = optIndex;
                        options[optIndex].classList.add('selected');
                        if (ans.isCorrect) {
                            feedbackElement.classList.add('correct');
                            feedbackElement.innerHTML = '<i class="fas fa-check-circle feedback-icon"></i><div class="feedback-text">Correct! Well done.</div>';
                        } else {
                            feedbackElement.classList.add('incorrect');
                            feedbackElement.innerHTML = '<i class="fas fa-times-circle feedback-icon"></i><div class="feedback-text">Incorrect. The right answer is highlighted.</div>';
                            options[question.answer].classList.add('correct');
                        }
                    }
                }
            }
            
            updateBookmarkStatus();
        }

        function selectOption(index) {
            if (selectedOption !== null || answers[currentQuestionIndex]) return;
            
            const options = document.querySelectorAll('.option');
            options.forEach(option => option.classList.remove('selected'));
            options[index].classList.add('selected');
            selectedOption = index;
            
            const question = questions[currentQuestionIndex];
            const isCorrect = index === question.answer;
            
            feedbackElement.style.display = 'flex';
            if (isCorrect) {
                feedbackElement.classList.remove('incorrect');
                feedbackElement.classList.add('correct');
                feedbackElement.innerHTML = '<i class="fas fa-check-circle feedback-icon"></i><div class="feedback-text">Correct! Well done.</div>';
                score += getScoreForDifficulty(question.difficulty);
                streak++;
                playSound('correct');
                
                // Show confetti for correct answers on hard questions
                if (question.difficulty === 'Hard' || question.difficulty === 'Very Hard') {
                    createConfetti();
                }
            } else {
                feedbackElement.classList.remove('correct');
                feedbackElement.classList.add('incorrect');
                feedbackElement.innerHTML = '<i class="fas fa-times-circle feedback-icon"></i><div class="feedback-text">Incorrect. The right answer is highlighted.</div>';
                options[question.answer].classList.add('correct');
                options[index].classList.add('incorrect');
                streak = 0;
                playSound('incorrect');
                
                // Add shake animation to incorrect answer
                options[index].classList.add('shake');
                setTimeout(() => {
                    options[index].classList.remove('shake');
                }, 500);
            }
            
            scoreElement.textContent = score;
            streakElement.textContent = streak;
            
            explanationTextElement.textContent = question.explanation;
            showExplanationBtn.style.display = 'block';
            
            answers[currentQuestionIndex] = {
                question: question.question,
                selected: question.options[index],
                correct: question.options[question.answer],
                isCorrect: isCorrect,
                explanation: question.explanation,
                category: question.category,
                difficulty: question.difficulty
            };
            
            updatePerformanceMetrics(isCorrect, question);
            
            options.forEach(option => option.style.pointerEvents = 'none');
        }

        function skipQuestion() {
            if (answers[currentQuestionIndex]) return;
            
            const question = questions[currentQuestionIndex];
            const options = document.querySelectorAll('.option');
            
            feedbackElement.style.display = 'flex';
            feedbackElement.classList.add('skipped');
            feedbackElement.innerHTML = '<i class="fas fa-forward feedback-icon"></i><div class="feedback-text">Skipped. The right answer is highlighted.</div>';
            
            options[question.answer].classList.add('correct');
            showExplanationBtn.style.display = 'block';
            explanationTextElement.textContent = question.explanation;
            
            answers[currentQuestionIndex] = {
                question: question.question,
                selected: 'Skipped',
                correct: question.options[question.answer],
                isCorrect: false,
                explanation: question.explanation,
                category: question.category,
                difficulty: question.difficulty
            };
            
            updatePerformanceMetrics(false, question);
            streak = 0;
            streakElement.textContent = streak;
            
            options.forEach(option => option.style.pointerEvents = 'none');
        }

        function toggleExplanation() {
            explanationContainer.classList.toggle('expanded');
            showExplanationBtn.innerHTML = explanationContainer.classList.contains('expanded') ?
                '<i class="fas fa-info-circle"></i> Hide Explanation' :
                '<i class="fas fa-info-circle"></i> Show Explanation';
        }

        function getScoreForDifficulty(difficulty) {
            switch (difficulty) {
                case 'Easy': return 5;
                case 'Medium': return 10;
                case 'Hard': return 15;
                case 'Very Hard': return 20;
                default: return 10;
            }
        }

        function updatePerformanceMetrics(isCorrect, question) {
            performanceMetrics.totalQuestions++;
            performanceMetrics.totalTime += timeElapsed;
            if (isCorrect) performanceMetrics.totalCorrect++;
            
            performanceMetrics.categories[question.category] = performanceMetrics.categories[question.category] || { correct: 0, total: 0 };
            performanceMetrics.categories[question.category].total++;
            if (isCorrect) performanceMetrics.categories[question.category].correct++;
            
            performanceMetrics.difficulties[question.difficulty] = performanceMetrics.difficulties[question.difficulty] || 0;
            if (isCorrect) performanceMetrics.difficulties[question.difficulty]++;
        }

        function toggleBookmark() {
            const questionId = questions[currentQuestionIndex].id;
            const index = bookmarkedQuestions.indexOf(questionId);
            if (index === -1) {
                bookmarkedQuestions.push(questionId);
                bookmarkBtn.classList.add('bookmarked');
                playSound('bookmark');
            } else {
                bookmarkedQuestions.splice(index, 1);
                bookmarkBtn.classList.remove('bookmarked');
            }
            updateBookmarksCount();
            saveBookmarks();
        }

        function updateBookmarkStatus() {
            const questionId = questions[currentQuestionIndex].id;
            bookmarkBtn.classList.toggle('bookmarked', bookmarkedQuestions.includes(questionId));
        }

        function updateBookmarksCount() {
            bookmarksCount.textContent = bookmarkedQuestions.length;
        }

        function goToNextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            } else {
                body.setAttribute('data-progress', '100');
                showResults();
                saveQuizHistory();
            }
        }

        function goToPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion();
            }
        }

        function startTimer() {
            timeStarted = new Date();
            timerInterval = setInterval(updateTimer, 1000);
        }

        function updateTimer() {
            timeElapsed++;
            
            const minutes = Math.floor(timeElapsed / 60).toString().padStart(2, '0');
            const seconds = (timeElapsed % 60).toString().padStart(2, '0');
            timerElement.textContent = `${minutes}:${seconds}`;
            
            // Optional: Add warning color for long durations (e.g., after 5 minutes)
            if (timeElapsed >= 300) {
                timerElement.style.color = 'var(--danger)';
                timerElement.classList.add('pulse');
            } else {
                timerElement.style.color = 'var(--primary)';
                timerElement.classList.remove('pulse');
            }
        }

        function showResults() {
            clearInterval(timerInterval);
            
            const quizContainer = document.querySelector('.quiz-container');
            const maxScore = questions.reduce((sum, q) => sum + getScoreForDifficulty(q.difficulty), 0);
            const percentage = ((score / maxScore) * 100).toFixed(1);
            const accuracy = ((performanceMetrics.totalCorrect / performanceMetrics.totalQuestions) * 100).toFixed(1);
            const avgTime = Math.round(performanceMetrics.totalTime / performanceMetrics.totalQuestions);
            
            quizContainer.innerHTML = `
                <div class="results-container">
                    <h2 class="quiz-title">Quiz Completed!</h2>
                    <p class="quiz-subtitle">You've finished the MED QUIZ</p>
                    
                    <div class="score-circle" style="--p: ${percentage}%">
                        <div class="score-text">
                            <div class="score-value">${score}</div>
                            <div class="score-label">Points</div>
                        </div>
                    </div>
                    
                    <div class="results-stats">
                        <div class="result-stat">
                            <div class="result-stat-value">${accuracy}%</div>
                            <div class="result-stat-label">Accuracy</div>
                        </div>
                        <div class="result-stat">
                            <div class="result-stat-value">${timeElapsed}s</div>
                            <div class="result-stat-label">Time Taken</div>
                        </div>
                        <div class="result-stat">
                            <div class="result-stat-value">${streak}</div>
                            <div class="result-stat-label">Best Streak</div>
                        </div>
                        <div class="result-stat">
                            <div class="result-stat-value">${bookmarkedQuestions.length}</div>
                            <div class="stat-label">Bookmarked</div>
                        </div>
                    </div>
                    
                    <div class="review-section">
                        <h3 class="review-title">Performance Analytics</h3>
                        <div class="review-item">
                            <div class="review-answer">Average Time Per Question: ${avgTime}s</div>
                            <div class="review-answer">Difficulty Performance: 
                                Easy: ${performanceMetrics.difficulties.Easy || 0}, 
                                Medium: ${performanceMetrics.difficulties.Medium || 0}, 
                                Hard: ${performanceMetrics.difficulties.Hard || 0},
                                Very Hard: ${performanceMetrics.difficulties['Very Hard'] || 0}
                            </div>
                        </div>
                        
                        <h3 class="review-title">Review Your Answers</h3>
                        ${answers.map((answer, index) => `
                            <div class="review-item ${answer.isCorrect ? 'correct' : answer.selected === 'Skipped' ? 'skipped' : 'incorrect'}">
                                <div class="review-question">Q${index + 1}: ${answer.question} (${answer.category} - ${answer.difficulty})</div>
                                <div class="review-answer">Your Answer: ${answer.selected}</div>
                                <div class="review-answer">Correct Answer: ${answer.correct}</div>
                                <div class="review-explanation">${answer.explanation}</div>
                            </div>
                        `).join('')}
                        
                        ${bookmarkedQuestions.length > 0 ? `
                            <h3 class="review-title">Bookmarked Questions</h3>
                            ${bookmarkedQuestions.map(qid => {
                                const question = questions.find(q => q.id === qid);
                                return `
                                    <div class="review-item">
                                        <div class="review-question">${question.question} (${question.category} - ${question.difficulty})</div>
                                        <div class="review-answer">Correct Answer: ${question.correctAnswer}</div>
                                        <div class="review-explanation">${question.explanation}</div>
                                    </div>
                                `;
                            }).join('')}
                        ` : ''}
                    </div>
                    
                    <button class="btn btn-primary mt-4" id="restart-btn">
                        <i class="fas fa-redo"></i> Try Again
                    </button>
                    <button class="btn btn-secondary mt-2" id="review-wrong-btn">
                        <i class="fas fa-search"></i> Review Incorrect Answers
                    </button>
                </div>
            `;
            
            document.getElementById('restart-btn').addEventListener('click', restartQuiz);
            document.getElementById('review-wrong-btn').addEventListener('click', reviewWrongAnswers);
        }

        function restartQuiz() {
            // Reset quiz state
            currentQuestionIndex = 0;
            score = 0;
            streak = 0;
            timeElapsed = 0;
            answers = [];
            selectedOption = null;
            performanceMetrics = {
                categories: {},
                difficulties: { Easy: 0, Medium: 0, Hard: 0, "Very Hard": 0 },
                totalCorrect: 0,
                totalQuestions: 0,
                totalTime: 0
            };
            
            // Clear any existing timer
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            body.setAttribute('data-progress', '0');
            
            // Reset DOM
            const quizContainer = document.querySelector('.quiz-container');
            quizContainer.innerHTML = `
                <div class="quiz-header">
                    <div>
                        <h1 class="quiz-title">MED QUIZ</h1>
                        <p class="quiz-subtitle">Test your medical knowledge</p>
                    </div>
                    <div class="stats-container">
                        <div class="stat">
                            <span class="stat-value" id="score">0</span>
                            <span class="stat-label">Score</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value" id="timer">00:00</span>
                            <span class="stat-label">Time</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value" id="streak">0</span>
                            <span class="stat-label">Streak</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value" id="category">All</span>
                            <span class="stat-label">Category</span>
                        </div>
                    </div>
                </div>

                <div class="study-mode-toggle">
                    <span>Study Mode:</span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="study-mode-toggle">
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <div class="progress-container">
                    <div class="progress-bar" id="progress-bar" style="width: 10%"></div>
                </div>

                <div class="question-meta">
                    <div class="question-tags">
                        <span class="tag" id="category-tag">Biochemistry</span>
                        <span class="tag" id="difficulty-tag">
                            <span class="difficulty-indicator difficulty-medium"></span>
                            Medium
                        </span>
                    </div>
                    <button class="bookmark-btn" id="bookmark-btn" aria-label="Bookmark question">
                        <i class="fas fa-bookmark"></i>
                    </button>
                </div>
                <div class="question-number">Question <span id="current-question">1</span> of <span id="total-questions">15</span></div>
                <div class="question-text" id="question"></div>

                <div class="options-grid" id="options-container"></div>

                <div class="feedback correct" id="feedback" style="display: none;">
                    <i class="fas fa-check-circle feedback-icon"></i>
                    <div class="feedback-text">Correct! Well done.</div>
                </div>

                <button class="btn btn-secondary" id="show-explanation-btn" style="display: none;">
                    <i class="fas fa-info-circle"></i> Show Explanation
                </button>

                <div class="explanation-container" id="explanation-container">
                    <div class="explanation">
                        <div class="explanation-title">Explanation:</div>
                        <div id="explanation-text"></div>
                    </div>
                </div>

                <div class="navigation">
                    <button class="btn btn-secondary" id="prev-btn" disabled>
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button class="btn btn-primary" id="next-btn">
                        Next Question <i class="fas fa-arrow-right"></i>
                    </button>
                    <button class="btn btn-danger" id="skip-btn">
                        <i class="fas fa-forward"></i> Skip
                    </button>
                </div>
            `;
            
            // Reinitialize the quiz
            initQuiz();
        }

        function changeTheme(theme) {
            body.setAttribute('data-theme', theme);
            
            // Update active theme indicator
            themeOptions.forEach(option => {
                if (option.getAttribute('data-theme') === theme) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
            
            localStorage.setItem('theme', theme);
        }

        function toggleThemeSelector() {
            const themeSelector = document.querySelector('.theme-selector');
            themeSelector.style.display = themeSelector.style.display === 'none' ? 'flex' : 'none';
        }

        function toggleSound() {
            soundsEnabled = !soundsEnabled;
            soundToggle.innerHTML = soundsEnabled ? '<i class="fas fa-volume-up"></i>' : '<i class="fas fa-volume-mute"></i>';
            
            localStorage.setItem('soundsEnabled', soundsEnabled);
        }

        function toggleStudyMode() {
            studyMode = !studyMode;
            localStorage.setItem('studyMode', studyMode);
        }

        function playSound(type) {
            if (!soundsEnabled) return;
            
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                switch(type) {
                    case 'correct':
                        oscillator.type = 'sine';
                        oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
                        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                        break;
                    case 'incorrect':
                        oscillator.type = 'sawtooth';
                        oscillator.frequency.setValueAtTime(349.23, audioContext.currentTime); // F4
                        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                        break;
                    case 'bookmark':
                        oscillator.type = 'sine';
                        oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime); // G5
                        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                        break;
                }
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log('Web Audio API not supported');
            }
        }

        function createConfetti() {
            const colors = ['#4361ee', '#4cc9f0', '#f72585', '#f9c74f', '#7209b7'];
            
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.width = (5 + Math.random() * 10) + 'px';
                confetti.style.height = (5 + Math.random() * 10) + 'px';
                confetti.style.animation = `confettiFall ${1 + Math.random() * 2}s linear forwards`;
                confettiContainer.appendChild(confetti);
                
                // Remove confetti after animation completes
                setTimeout(() => {
                    confetti.remove();
                }, 3000);
            }
        }

        function showStatsModal() {
            statsModal.classList.add('active');
        }

        function hideStatsModal() {
            statsModal.classList.remove('active');
        }

        function showQuickActionsModal() {
            quickActionsModal.classList.add('active');
        }

        function hideQuickActionsModal() {
            quickActionsModal.classList.remove('active');
        }

        function loadPreferences() {
            const savedTheme = localStorage.getItem('theme') || 'medical';
            changeTheme(savedTheme);
            
            const savedSounds = localStorage.getItem('soundsEnabled');
            if (savedSounds !== null) {
                soundsEnabled = savedSounds === 'true';
                soundToggle.innerHTML = soundsEnabled ? '<i class="fas fa-volume-up"></i>' : '<i class="fas fa-volume-mute"></i>';
            }
            
            const savedStudyMode = localStorage.getItem('studyMode');
            if (savedStudyMode !== null) {
                studyMode = savedStudyMode === 'true';
                studyModeToggle.checked = studyMode;
            }
        }

        function saveBookmarks() {
            localStorage.setItem('bookmarkedQuestions', JSON.stringify(bookmarkedQuestions));
        }

        function loadQuizHistory() {
            const saved = localStorage.getItem('quizHistory');
            if (saved) {
                quizHistory = JSON.parse(saved);
            }
            loadBookmarks();
        }

        function saveQuizHistory() {
            quizHistory.push({
                timestamp: new Date().toISOString(),
                score: score,
                percentage: ((score / (questions.length * 15)) * 100).toFixed(1),
                timeSpent: timeElapsed,
                streak: streak,
                answers: answers,
                performanceMetrics: performanceMetrics
            });
            localStorage.setItem('quizHistory', JSON.stringify(quizHistory));
        }

        function loadBookmarks() {
            const saved = localStorage.getItem('bookmarkedQuestions');
            if (saved) {
                bookmarkedQuestions = JSON.parse(saved);
            }
        }

        window.addEventListener('DOMContentLoaded', initQuiz);
    </script>
</body>
</html>